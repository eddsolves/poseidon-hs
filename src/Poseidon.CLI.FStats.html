<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Poseidon.CLI.FStats</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2"></span><span>      </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier">FStatSpec</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-3"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">P.ParseError</span></span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier">PopSpec</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FstatsOptions"><span class="hs-identifier">FstatsOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#JackknifeMode"><span class="hs-identifier">JackknifeMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#fStatSpecParser"><span class="hs-identifier">fStatSpecParser</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">P.runParser</span></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#runFstats"><span class="hs-identifier">runFstats</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#readStatSpecsFromFile"><span class="hs-identifier">readStatSpecsFromFile</span></a></span><span>
</span><span id="line-11"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Poseidon.Package.html"><span class="hs-identifier">Poseidon.Package</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Package.html#PoseidonPackage"><span class="hs-identifier">PoseidonPackage</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>                                             </span><span class="annot"><a href="Poseidon.Package.html#readPoseidonPackageCollection"><span class="hs-identifier">readPoseidonPackageCollection</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>                                             </span><span class="annot"><a href="Poseidon.Package.html#getIndividuals"><span class="hs-identifier">getIndividuals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>                                             </span><span class="annot"><a href="Poseidon.Package.html#getJointGenotypeData"><span class="hs-identifier">getJointGenotypeData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>                                             </span><span class="annot"><a href="Poseidon.Package.html#PackageReadOptions"><span class="hs-identifier">PackageReadOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Package.html#defaultPackageReadOptions"><span class="hs-identifier">defaultPackageReadOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Poseidon.Utils.html"><span class="hs-identifier">Poseidon.Utils</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier">PoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Foldl</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Fold</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">list</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">purely</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwM</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isSpace</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intersect</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                                             </span><span class="annot"><span class="hs-identifier">transpose</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Lens.Family2</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Pipes</span></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&gt;-&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Pipes.Group</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">chunksOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">folds</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">groupsBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Pipes.Prelude</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Pipes.Safe</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runSafeT</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">SequenceFormats.Eigenstrat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EigenstratIndEntry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>                                             </span><span class="annot"><span class="hs-identifier">EigenstratSnpEntry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>                                             </span><span class="annot"><span class="hs-identifier">GenoEntry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">GenoLine</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">SequenceFormats.Utils</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Chrom</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hPutStrLn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stderr</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Layout.Table</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">asciiRoundS</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">column</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">expand</span></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>                                             </span><span class="annot"><span class="hs-identifier">rowsG</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tableString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">titlesH</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec.String</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | A datatype representing the command line options for the F-Statistics command</span><span>
</span><span id="line-46"></span><span class="hs-keyword">data</span><span> </span><span id="FstatsOptions"><span class="annot"><a href="Poseidon.CLI.FStats.html#FstatsOptions"><span class="hs-identifier hs-var">FstatsOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FstatsOptions"><span class="annot"><a href="Poseidon.CLI.FStats.html#FstatsOptions"><span class="hs-identifier hs-var">FstatsOptions</span></a></span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="_foBaseDirs"><span class="annot"><span class="annottext">FstatsOptions -&gt; [FilePath]
</span><a href="Poseidon.CLI.FStats.html#_foBaseDirs"><span class="hs-identifier hs-var hs-var">_foBaseDirs</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ the list of base directories to search for packages</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_foJackknifeMode"><span class="annot"><span class="annottext">FstatsOptions -&gt; JackknifeMode
</span><a href="Poseidon.CLI.FStats.html#_foJackknifeMode"><span class="hs-identifier hs-var hs-var">_foJackknifeMode</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#JackknifeMode"><span class="hs-identifier hs-type">JackknifeMode</span></a></span><span> </span><span class="hs-comment">-- ^ The way the Jackknife is performed</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_foExcludeChroms"><span class="annot"><span class="annottext">FstatsOptions -&gt; [Chrom]
</span><a href="Poseidon.CLI.FStats.html#_foExcludeChroms"><span class="hs-identifier hs-var hs-var">_foExcludeChroms</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Chrom</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ a list of chromosome names to exclude from the computation</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_foStatSpecsDirect"><span class="annot"><span class="annottext">FstatsOptions -&gt; [FStatSpec]
</span><a href="Poseidon.CLI.FStats.html#_foStatSpecsDirect"><span class="hs-identifier hs-var hs-var">_foStatSpecsDirect</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A list of F-statistics to compute</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_foStatSpecsFile"><span class="annot"><span class="annottext">FstatsOptions -&gt; Maybe FilePath
</span><a href="Poseidon.CLI.FStats.html#_foStatSpecsFile"><span class="hs-identifier hs-var hs-var">_foStatSpecsFile</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-comment">-- ^ a file listing F-statistics to compute</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_foRawOutput"><span class="annot"><span class="annottext">FstatsOptions -&gt; Bool
</span><a href="Poseidon.CLI.FStats.html#_foRawOutput"><span class="hs-identifier hs-var hs-var">_foRawOutput</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ whether to output the result table in raw TSV instead of nicely formatted ASCII table/</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | A datatype representing the two options for how to run the Block-Jackknife</span><span>
</span><span id="line-56"></span><span class="hs-keyword">data</span><span> </span><span id="JackknifeMode"><span class="annot"><a href="Poseidon.CLI.FStats.html#JackknifeMode"><span class="hs-identifier hs-var">JackknifeMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JackknifePerN"><span class="annot"><a href="Poseidon.CLI.FStats.html#JackknifePerN"><span class="hs-identifier hs-var">JackknifePerN</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Run the Jackknife in blocks of N consecutive SNPs</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="JackknifePerChromosome"><span class="annot"><a href="Poseidon.CLI.FStats.html#JackknifePerChromosome"><span class="hs-identifier hs-var">JackknifePerChromosome</span></a></span></span><span> </span><span class="hs-comment">-- ^ Run the Jackknife in blocks defined as entire chromosomes.</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | A datatype to represent Summary Statistics to be computed from genotype data.</span><span>
</span><span id="line-60"></span><span class="hs-keyword">data</span><span> </span><span id="FStatSpec"><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-var">FStatSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="F4Spec"><span class="annot"><a href="Poseidon.CLI.FStats.html#F4Spec"><span class="hs-identifier hs-var">F4Spec</span></a></span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="hs-comment">-- ^ F4 Statistics</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="F3Spec"><span class="annot"><a href="Poseidon.CLI.FStats.html#F3Spec"><span class="hs-identifier hs-var">F3Spec</span></a></span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="hs-comment">-- ^ F3 Statistics</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="F2Spec"><span class="annot"><a href="Poseidon.CLI.FStats.html#F2Spec"><span class="hs-identifier hs-var">F2Spec</span></a></span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="hs-comment">-- ^ F2 Statistics</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PWMspec"><span class="annot"><a href="Poseidon.CLI.FStats.html#PWMspec"><span class="hs-identifier hs-var">PWMspec</span></a></span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="hs-comment">-- ^ Pairwise Mismatch Rates between two groups</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149200"><span id="local-6989586621679149202"><span class="annot"><span class="annottext">FStatSpec -&gt; FStatSpec -&gt; Bool
(FStatSpec -&gt; FStatSpec -&gt; Bool)
-&gt; (FStatSpec -&gt; FStatSpec -&gt; Bool) -&gt; Eq FStatSpec
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FStatSpec -&gt; FStatSpec -&gt; Bool
$c/= :: FStatSpec -&gt; FStatSpec -&gt; Bool
== :: FStatSpec -&gt; FStatSpec -&gt; Bool
$c== :: FStatSpec -&gt; FStatSpec -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679149194"><span id="local-6989586621679149197"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679149192"><span class="annot"><span class="annottext">show :: FStatSpec -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#F4Spec"><span class="hs-identifier hs-type">F4Spec</span></a></span><span>  </span><span id="local-6989586621679149190"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149190"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149189"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149189"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679149188"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149188"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679149187"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149187"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;F4(&quot;</span></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149190"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149189"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149188"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149187"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#F3Spec"><span class="hs-identifier hs-type">F3Spec</span></a></span><span>  </span><span id="local-6989586621679149186"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149186"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149185"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149185"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679149184"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149184"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;F3(&quot;</span></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149186"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149185"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149184"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#F2Spec"><span class="hs-identifier hs-type">F2Spec</span></a></span><span>  </span><span id="local-6989586621679149183"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149183"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149182"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149182"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;F2(&quot;</span></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149183"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149182"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#PWMspec"><span class="hs-identifier hs-type">PWMspec</span></a></span><span> </span><span id="local-6989586621679149181"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149181"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149180"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149180"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PWM(&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149181"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149180"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | An internal datatype to represent Summary statistics with indices of individuals given as integers</span><span>
</span><span id="line-73"></span><span class="hs-keyword">data</span><span> </span><span id="FStat"><span class="annot"><a href="Poseidon.CLI.FStats.html#FStat"><span class="hs-identifier hs-var">FStat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="F4"><span class="annot"><a href="Poseidon.CLI.FStats.html#F4"><span class="hs-identifier hs-var">F4</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="F3"><span class="annot"><a href="Poseidon.CLI.FStats.html#F3"><span class="hs-identifier hs-var">F3</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="F2"><span class="annot"><a href="Poseidon.CLI.FStats.html#F2"><span class="hs-identifier hs-var">F2</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PWM"><span class="annot"><a href="Poseidon.CLI.FStats.html#PWM"><span class="hs-identifier hs-var">PWM</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | A datatype to represent a group or an individual</span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span> </span><span id="PopSpec"><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-var">PopSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PopSpecGroup"><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecGroup"><span class="hs-identifier hs-var">PopSpecGroup</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ Define a group name</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PopSpecInd"><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecInd"><span class="hs-identifier hs-var">PopSpecInd</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ Define an individual name</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149169"><span id="local-6989586621679149171"><span class="annot"><span class="annottext">PopSpec -&gt; PopSpec -&gt; Bool
(PopSpec -&gt; PopSpec -&gt; Bool)
-&gt; (PopSpec -&gt; PopSpec -&gt; Bool) -&gt; Eq PopSpec
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PopSpec -&gt; PopSpec -&gt; Bool
$c/= :: PopSpec -&gt; PopSpec -&gt; Bool
== :: PopSpec -&gt; PopSpec -&gt; Bool
$c== :: PopSpec -&gt; PopSpec -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679149164"><span id="local-6989586621679149167"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679149163"><span class="annot"><span class="annottext">show :: PopSpec -&gt; FilePath
</span><a href="#local-6989586621679149163"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecGroup"><span class="hs-identifier hs-type">PopSpecGroup</span></a></span><span> </span><span id="local-6989586621679149162"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149162"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149162"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecInd"><span class="hs-identifier hs-type">PopSpecInd</span></a></span><span>   </span><span id="local-6989586621679149161"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149161"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149161"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | A helper type to represent a genomic position.</span><span>
</span><span id="line-88"></span><span class="hs-keyword">type</span><span> </span><span id="GenomPos"><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-var">GenomPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Chrom</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">data</span><span> </span><span id="BlockData"><span class="annot"><a href="Poseidon.CLI.FStats.html#BlockData"><span class="hs-identifier hs-var">BlockData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BlockData"><span class="annot"><a href="Poseidon.CLI.FStats.html#BlockData"><span class="hs-identifier hs-var">BlockData</span></a></span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="blockStartPos"><span class="annot"><span class="annottext">BlockData -&gt; GenomPos
</span><a href="Poseidon.CLI.FStats.html#blockStartPos"><span class="hs-identifier hs-var hs-var">blockStartPos</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span> </span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="blockEndPos"><span class="annot"><span class="annottext">BlockData -&gt; GenomPos
</span><a href="Poseidon.CLI.FStats.html#blockEndPos"><span class="hs-identifier hs-var hs-var">blockEndPos</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="blockSiteCount"><span class="annot"><span class="annottext">BlockData -&gt; Int
</span><a href="Poseidon.CLI.FStats.html#blockSiteCount"><span class="hs-identifier hs-var hs-var">blockSiteCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="blockVal"><span class="annot"><span class="annottext">BlockData -&gt; Double
</span><a href="Poseidon.CLI.FStats.html#blockVal"><span class="hs-identifier hs-var hs-var">blockVal</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149150"><span id="local-6989586621679149152"><span id="local-6989586621679149154"><span class="annot"><span class="annottext">Int -&gt; BlockData -&gt; ShowS
[BlockData] -&gt; ShowS
BlockData -&gt; FilePath
(Int -&gt; BlockData -&gt; ShowS)
-&gt; (BlockData -&gt; FilePath)
-&gt; ([BlockData] -&gt; ShowS)
-&gt; Show BlockData
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BlockData] -&gt; ShowS
$cshowList :: [BlockData] -&gt; ShowS
show :: BlockData -&gt; FilePath
$cshow :: BlockData -&gt; FilePath
showsPrec :: Int -&gt; BlockData -&gt; ShowS
$cshowsPrec :: Int -&gt; BlockData -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | A parser to parse Summary Statistic specifications.</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#fStatSpecParser"><span class="hs-identifier hs-type">fStatSpecParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span>
</span><span id="line-100"></span><span id="fStatSpecParser"><span class="annot"><span class="annottext">fStatSpecParser :: Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#fStatSpecParser"><span class="hs-identifier hs-var hs-var">fStatSpecParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec -&gt; Parser FStatSpec
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">P.try</span></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#f4SpecParser"><span class="hs-identifier hs-var">f4SpecParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec -&gt; Parser FStatSpec -&gt; Parser FStatSpec
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec -&gt; Parser FStatSpec
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">P.try</span></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#f3SpecParser"><span class="hs-identifier hs-var">f3SpecParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec -&gt; Parser FStatSpec -&gt; Parser FStatSpec
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec -&gt; Parser FStatSpec
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">P.try</span></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#f2SpecParser"><span class="hs-identifier hs-var">f2SpecParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec -&gt; Parser FStatSpec -&gt; Parser FStatSpec
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#pwmSpecParser"><span class="hs-identifier hs-var">pwmSpecParser</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | A parser to parse F4Stats</span><span>
</span><span id="line-103"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#f4SpecParser"><span class="hs-identifier hs-type">f4SpecParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span>
</span><span id="line-104"></span><span id="f4SpecParser"><span class="annot"><span class="annottext">f4SpecParser :: Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#f4SpecParser"><span class="hs-identifier hs-var hs-var">f4SpecParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParsecT FilePath () Identity FilePath
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
FilePath -&gt; ParsecT s u m FilePath
</span><span class="hs-identifier hs-var">P.string</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;F4&quot;</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679149143"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149143"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149142"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149142"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149141"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149141"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149140"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149140"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity [PopSpec]
-&gt; ParsecT FilePath () Identity [PopSpec]
forall s (m :: * -&gt; *) t u open close a.
Stream s m t =&gt;
ParsecT s u m open
-&gt; ParsecT s u m close -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">P.between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ParsecT FilePath () Identity [PopSpec]
</span><a href="Poseidon.CLI.FStats.html#parsePopSpecsN"><span class="hs-identifier hs-var">parsePopSpecsN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">FStatSpec -&gt; Parser FStatSpec
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FStatSpec -&gt; Parser FStatSpec) -&gt; FStatSpec -&gt; Parser FStatSpec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; PopSpec -&gt; PopSpec -&gt; PopSpec -&gt; FStatSpec
</span><a href="Poseidon.CLI.FStats.html#F4Spec"><span class="hs-identifier hs-var">F4Spec</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149143"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149142"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149141"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149140"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#parsePopSpecsN"><span class="hs-identifier hs-type">parsePopSpecsN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span id="parsePopSpecsN"><span class="annot"><span class="annottext">parsePopSpecsN :: Int -&gt; ParsecT FilePath () Identity [PopSpec]
</span><a href="Poseidon.CLI.FStats.html#parsePopSpecsN"><span class="hs-identifier hs-var hs-var">parsePopSpecsN</span></a></span></span><span> </span><span id="local-6989586621679149136"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149136"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Parser PopSpec
-&gt; ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity [PopSpec]
forall a sep. Int -&gt; Parser a -&gt; Parser sep -&gt; Parser [a]
</span><a href="Poseidon.CLI.FStats.html#sepByN"><span class="hs-identifier hs-var">sepByN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149136"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Parser PopSpec
</span><a href="Poseidon.CLI.FStats.html#parsePopSpec"><span class="hs-identifier hs-var">parsePopSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity ()
-&gt; ParsecT FilePath () Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity ()
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">P.spaces</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679149459"><span id="local-6989586621679149460"><span class="annot"><a href="Poseidon.CLI.FStats.html#sepByN"><span class="hs-identifier hs-type">sepByN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621679149460"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621679149459"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679149460"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-113"></span><span id="sepByN"><span class="annot"><span class="annottext">sepByN :: Int -&gt; Parser a -&gt; Parser sep -&gt; Parser [a]
</span><a href="Poseidon.CLI.FStats.html#sepByN"><span class="hs-identifier hs-var hs-var">sepByN</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Parser sep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Parser [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#sepByN"><span class="hs-identifier hs-var">sepByN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679149131"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679149131"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Parser sep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; [a]) -&gt; Parser a -&gt; Parser [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679149130"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149130"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149130"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679149131"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#sepByN"><span class="hs-identifier hs-var">sepByN</span></a></span><span> </span><span id="local-6989586621679149129"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149129"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679149128"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679149128"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679149127"><span class="annot"><span class="annottext">Parser sep
</span><a href="#local-6989586621679149127"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679149126"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149126"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679149128"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">sep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser sep
</span><a href="#local-6989586621679149127"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679149125"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679149125"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser a -&gt; Parser sep -&gt; Parser [a]
forall a sep. Int -&gt; Parser a -&gt; Parser sep -&gt; Parser [a]
</span><a href="Poseidon.CLI.FStats.html#sepByN"><span class="hs-identifier hs-var">sepByN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149129"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679149128"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parser sep
</span><a href="#local-6989586621679149127"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">[a] -&gt; Parser [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149126"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679149125"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#parsePopSpec"><span class="hs-identifier hs-type">parsePopSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span>
</span><span id="line-122"></span><span id="parsePopSpec"><span class="annot"><span class="annottext">parsePopSpec :: Parser PopSpec
</span><a href="Poseidon.CLI.FStats.html#parsePopSpec"><span class="hs-identifier hs-var hs-var">parsePopSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser PopSpec
forall u. ParsecT FilePath u Identity PopSpec
</span><a href="#local-6989586621679149124"><span class="hs-identifier hs-var">parseIndividualSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Parser PopSpec -&gt; Parser PopSpec -&gt; Parser PopSpec
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser PopSpec
forall u. ParsecT FilePath u Identity PopSpec
</span><a href="#local-6989586621679149123"><span class="hs-identifier hs-var">parseGroupSpec</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679149124"><span class="annot"><span class="annottext">parseIndividualSpec :: ParsecT FilePath u Identity PopSpec
</span><a href="#local-6989586621679149124"><span class="hs-identifier hs-var hs-var">parseIndividualSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PopSpec
</span><a href="Poseidon.CLI.FStats.html#PopSpecInd"><span class="hs-identifier hs-var">PopSpecInd</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PopSpec)
-&gt; ParsecT FilePath u Identity FilePath
-&gt; ParsecT FilePath u Identity PopSpec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath u Identity Char
-&gt; ParsecT FilePath u Identity Char
-&gt; ParsecT FilePath u Identity FilePath
-&gt; ParsecT FilePath u Identity FilePath
forall s (m :: * -&gt; *) t u open close a.
Stream s m t =&gt;
ParsecT s u m open
-&gt; ParsecT s u m close -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">P.between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath u Identity FilePath
forall u. ParsecT FilePath u Identity FilePath
</span><a href="#local-6989586621679149121"><span class="hs-identifier hs-var">parseName</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679149123"><span class="annot"><span class="annottext">parseGroupSpec :: ParsecT FilePath u Identity PopSpec
</span><a href="#local-6989586621679149123"><span class="hs-identifier hs-var hs-var">parseGroupSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PopSpec
</span><a href="Poseidon.CLI.FStats.html#PopSpecGroup"><span class="hs-identifier hs-var">PopSpecGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PopSpec)
-&gt; ParsecT FilePath u Identity FilePath
-&gt; ParsecT FilePath u Identity PopSpec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath u Identity FilePath
forall u. ParsecT FilePath u Identity FilePath
</span><a href="#local-6989586621679149121"><span class="hs-identifier hs-var">parseName</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679149121"><span class="annot"><span class="annottext">parseName :: ParsecT FilePath u Identity FilePath
</span><a href="#local-6989586621679149121"><span class="hs-identifier hs-var hs-var">parseName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath u Identity Char
-&gt; ParsecT FilePath u Identity FilePath
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">P.many1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT FilePath u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
(Char -&gt; Bool) -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679149118"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679149118"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679149118"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679149118"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;,&lt;&gt;()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#f3SpecParser"><span class="hs-identifier hs-type">f3SpecParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span>
</span><span id="line-129"></span><span id="f3SpecParser"><span class="annot"><span class="annottext">f3SpecParser :: Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#f3SpecParser"><span class="hs-identifier hs-var hs-var">f3SpecParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParsecT FilePath () Identity FilePath
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
FilePath -&gt; ParsecT s u m FilePath
</span><span class="hs-identifier hs-var">P.string</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;F3&quot;</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679149114"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149114"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149113"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149113"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149112"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149112"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity [PopSpec]
-&gt; ParsecT FilePath () Identity [PopSpec]
forall s (m :: * -&gt; *) t u open close a.
Stream s m t =&gt;
ParsecT s u m open
-&gt; ParsecT s u m close -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">P.between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ParsecT FilePath () Identity [PopSpec]
</span><a href="Poseidon.CLI.FStats.html#parsePopSpecsN"><span class="hs-identifier hs-var">parsePopSpecsN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="annottext">FStatSpec -&gt; Parser FStatSpec
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FStatSpec -&gt; Parser FStatSpec) -&gt; FStatSpec -&gt; Parser FStatSpec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; PopSpec -&gt; PopSpec -&gt; FStatSpec
</span><a href="Poseidon.CLI.FStats.html#F3Spec"><span class="hs-identifier hs-var">F3Spec</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149114"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149113"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149112"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#f2SpecParser"><span class="hs-identifier hs-type">f2SpecParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span>
</span><span id="line-135"></span><span id="f2SpecParser"><span class="annot"><span class="annottext">f2SpecParser :: Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#f2SpecParser"><span class="hs-identifier hs-var hs-var">f2SpecParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParsecT FilePath () Identity FilePath
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
FilePath -&gt; ParsecT s u m FilePath
</span><span class="hs-identifier hs-var">P.string</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;F2&quot;</span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679149111"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149111"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149110"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149110"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity [PopSpec]
-&gt; ParsecT FilePath () Identity [PopSpec]
forall s (m :: * -&gt; *) t u open close a.
Stream s m t =&gt;
ParsecT s u m open
-&gt; ParsecT s u m close -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">P.between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ParsecT FilePath () Identity [PopSpec]
</span><a href="Poseidon.CLI.FStats.html#parsePopSpecsN"><span class="hs-identifier hs-var">parsePopSpecsN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">FStatSpec -&gt; Parser FStatSpec
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FStatSpec -&gt; Parser FStatSpec) -&gt; FStatSpec -&gt; Parser FStatSpec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; PopSpec -&gt; FStatSpec
</span><a href="Poseidon.CLI.FStats.html#F2Spec"><span class="hs-identifier hs-var">F2Spec</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149111"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149110"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#pwmSpecParser"><span class="hs-identifier hs-type">pwmSpecParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Parser</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span>
</span><span id="line-141"></span><span id="pwmSpecParser"><span class="annot"><span class="annottext">pwmSpecParser :: Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#pwmSpecParser"><span class="hs-identifier hs-var hs-var">pwmSpecParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParsecT FilePath () Identity FilePath
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
FilePath -&gt; ParsecT s u m FilePath
</span><span class="hs-identifier hs-var">P.string</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PWM&quot;</span></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679149109"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149109"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149108"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149108"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity [PopSpec]
-&gt; ParsecT FilePath () Identity [PopSpec]
forall s (m :: * -&gt; *) t u open close a.
Stream s m t =&gt;
ParsecT s u m open
-&gt; ParsecT s u m close -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">P.between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ParsecT FilePath () Identity [PopSpec]
</span><a href="Poseidon.CLI.FStats.html#parsePopSpecsN"><span class="hs-identifier hs-var">parsePopSpecsN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">FStatSpec -&gt; Parser FStatSpec
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FStatSpec -&gt; Parser FStatSpec) -&gt; FStatSpec -&gt; Parser FStatSpec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PopSpec -&gt; PopSpec -&gt; FStatSpec
</span><a href="Poseidon.CLI.FStats.html#PWMspec"><span class="hs-identifier hs-var">PWMspec</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149109"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149108"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#statSpecsFold"><span class="hs-identifier hs-type">statSpecsFold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">EigenstratIndEntry</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fold</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EigenstratSnpEntry</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenoLine</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.CLI.FStats.html#BlockData"><span class="hs-identifier hs-type">BlockData</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span id="statSpecsFold"><span class="annot"><span class="annottext">statSpecsFold :: [EigenstratIndEntry]
-&gt; [FStatSpec]
-&gt; Either
     PoseidonException (Fold (EigenstratSnpEntry, GenoLine) [BlockData])
</span><a href="Poseidon.CLI.FStats.html#statSpecsFold"><span class="hs-identifier hs-var hs-var">statSpecsFold</span></a></span></span><span> </span><span id="local-6989586621679149106"><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149106"><span class="hs-identifier hs-var">indEntries</span></a></span></span><span> </span><span id="local-6989586621679149105"><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679149105"><span class="hs-identifier hs-var">fStatSpecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679149104"><span class="annot"><span class="annottext">[Fold (EigenstratSnpEntry, GenoLine) BlockData]
</span><a href="#local-6989586621679149104"><span class="hs-identifier hs-var">listOfFolds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FStatSpec
 -&gt; Either
      PoseidonException (Fold (EigenstratSnpEntry, GenoLine) BlockData))
-&gt; [FStatSpec]
-&gt; Either
     PoseidonException [Fold (EigenstratSnpEntry, GenoLine) BlockData]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[EigenstratIndEntry]
-&gt; FStatSpec
-&gt; Either
     PoseidonException (Fold (EigenstratSnpEntry, GenoLine) BlockData)
</span><a href="Poseidon.CLI.FStats.html#statSpecFold"><span class="hs-identifier hs-var">statSpecFold</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149106"><span class="hs-identifier hs-var">indEntries</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679149105"><span class="hs-identifier hs-var">fStatSpecs</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">Fold (EigenstratSnpEntry, GenoLine) [BlockData]
-&gt; Either
     PoseidonException (Fold (EigenstratSnpEntry, GenoLine) [BlockData])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Fold (EigenstratSnpEntry, GenoLine) [BlockData]
 -&gt; Either
      PoseidonException
      (Fold (EigenstratSnpEntry, GenoLine) [BlockData]))
-&gt; Fold (EigenstratSnpEntry, GenoLine) [BlockData]
-&gt; Either
     PoseidonException (Fold (EigenstratSnpEntry, GenoLine) [BlockData])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Fold (EigenstratSnpEntry, GenoLine) BlockData]
-&gt; Fold (EigenstratSnpEntry, GenoLine) [BlockData]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span> </span><span class="annot"><span class="annottext">[Fold (EigenstratSnpEntry, GenoLine) BlockData]
</span><a href="#local-6989586621679149104"><span class="hs-identifier hs-var">listOfFolds</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#statSpecFold"><span class="hs-identifier hs-type">statSpecFold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">EigenstratIndEntry</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fold</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EigenstratSnpEntry</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenoLine</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#BlockData"><span class="hs-identifier hs-type">BlockData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span id="statSpecFold"><span class="annot"><span class="annottext">statSpecFold :: [EigenstratIndEntry]
-&gt; FStatSpec
-&gt; Either
     PoseidonException (Fold (EigenstratSnpEntry, GenoLine) BlockData)
</span><a href="Poseidon.CLI.FStats.html#statSpecFold"><span class="hs-identifier hs-var hs-var">statSpecFold</span></a></span></span><span> </span><span id="local-6989586621679149100"><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span></span><span> </span><span id="local-6989586621679149099"><span class="annot"><span class="annottext">FStatSpec
</span><a href="#local-6989586621679149099"><span class="hs-identifier hs-var">fStatSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679149098"><span class="annot"><span class="annottext">FStat
</span><a href="#local-6989586621679149098"><span class="hs-identifier hs-var">fStat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FStatSpec
</span><a href="#local-6989586621679149099"><span class="hs-identifier hs-var">fStatSpec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><a href="Poseidon.CLI.FStats.html#F4Spec"><span class="hs-identifier hs-type">F4Spec</span></a></span><span>  </span><span id="local-6989586621679149097"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149097"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149096"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149096"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679149095"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149095"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679149094"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149094"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int] -&gt; [Int] -&gt; FStat
</span><a href="Poseidon.CLI.FStats.html#F4"><span class="hs-identifier hs-var">F4</span></a></span><span>  </span><span class="annot"><span class="annottext">([Int] -&gt; [Int] -&gt; [Int] -&gt; [Int] -&gt; FStat)
-&gt; Either PoseidonException [Int]
-&gt; Either PoseidonException ([Int] -&gt; [Int] -&gt; [Int] -&gt; FStat)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149097"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Either PoseidonException ([Int] -&gt; [Int] -&gt; [Int] -&gt; FStat)
-&gt; Either PoseidonException [Int]
-&gt; Either PoseidonException ([Int] -&gt; [Int] -&gt; FStat)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149096"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Either PoseidonException ([Int] -&gt; [Int] -&gt; FStat)
-&gt; Either PoseidonException [Int]
-&gt; Either PoseidonException ([Int] -&gt; FStat)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149095"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Either PoseidonException ([Int] -&gt; FStat)
-&gt; Either PoseidonException [Int] -&gt; Either PoseidonException FStat
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149094"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><a href="Poseidon.CLI.FStats.html#F3Spec"><span class="hs-identifier hs-type">F3Spec</span></a></span><span>  </span><span id="local-6989586621679149092"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149092"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149091"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149091"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679149090"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149090"><span class="hs-identifier hs-var">c</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int] -&gt; FStat
</span><a href="Poseidon.CLI.FStats.html#F3"><span class="hs-identifier hs-var">F3</span></a></span><span>  </span><span class="annot"><span class="annottext">([Int] -&gt; [Int] -&gt; [Int] -&gt; FStat)
-&gt; Either PoseidonException [Int]
-&gt; Either PoseidonException ([Int] -&gt; [Int] -&gt; FStat)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149092"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Either PoseidonException ([Int] -&gt; [Int] -&gt; FStat)
-&gt; Either PoseidonException [Int]
-&gt; Either PoseidonException ([Int] -&gt; FStat)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149091"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Either PoseidonException ([Int] -&gt; FStat)
-&gt; Either PoseidonException [Int] -&gt; Either PoseidonException FStat
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149090"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><a href="Poseidon.CLI.FStats.html#F2Spec"><span class="hs-identifier hs-type">F2Spec</span></a></span><span>  </span><span id="local-6989586621679149089"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149089"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149088"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149088"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; FStat
</span><a href="Poseidon.CLI.FStats.html#F2"><span class="hs-identifier hs-var">F2</span></a></span><span>  </span><span class="annot"><span class="annottext">([Int] -&gt; [Int] -&gt; FStat)
-&gt; Either PoseidonException [Int]
-&gt; Either PoseidonException ([Int] -&gt; FStat)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149089"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Either PoseidonException ([Int] -&gt; FStat)
-&gt; Either PoseidonException [Int] -&gt; Either PoseidonException FStat
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149088"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PWMspec"><span class="hs-identifier hs-type">PWMspec</span></a></span><span> </span><span id="local-6989586621679149087"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149087"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149086"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149086"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; FStat
</span><a href="Poseidon.CLI.FStats.html#PWM"><span class="hs-identifier hs-var">PWM</span></a></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int] -&gt; FStat)
-&gt; Either PoseidonException [Int]
-&gt; Either PoseidonException ([Int] -&gt; FStat)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149087"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Either PoseidonException ([Int] -&gt; FStat)
-&gt; Either PoseidonException [Int] -&gt; Either PoseidonException FStat
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var">getPopIndices</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149100"><span class="hs-identifier hs-var">iE</span></a></span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149086"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="annottext">Fold (EigenstratSnpEntry, GenoLine) BlockData
-&gt; Either
     PoseidonException (Fold (EigenstratSnpEntry, GenoLine) BlockData)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Fold (EigenstratSnpEntry, GenoLine) BlockData
 -&gt; Either
      PoseidonException (Fold (EigenstratSnpEntry, GenoLine) BlockData))
-&gt; Fold (EigenstratSnpEntry, GenoLine) BlockData
-&gt; Either
     PoseidonException (Fold (EigenstratSnpEntry, GenoLine) BlockData)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Maybe GenomPos, Maybe GenomPos, Int, Double)
 -&gt; (EigenstratSnpEntry, GenoLine)
 -&gt; (Maybe GenomPos, Maybe GenomPos, Int, Double))
-&gt; (Maybe GenomPos, Maybe GenomPos, Int, Double)
-&gt; ((Maybe GenomPos, Maybe GenomPos, Int, Double) -&gt; BlockData)
-&gt; Fold (EigenstratSnpEntry, GenoLine) BlockData
forall a b x. (x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Fold a b
</span><span class="hs-identifier hs-var">Fold</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FStat
-&gt; (Maybe GenomPos, Maybe GenomPos, Int, Double)
-&gt; (EigenstratSnpEntry, GenoLine)
-&gt; (Maybe GenomPos, Maybe GenomPos, Int, Double)
</span><a href="#local-6989586621679149084"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">FStat
</span><a href="#local-6989586621679149098"><span class="hs-identifier hs-var">fStat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe GenomPos, Maybe GenomPos, Int, Double)
</span><a href="#local-6989586621679149083"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe GenomPos, Maybe GenomPos, Int, Double) -&gt; BlockData
</span><a href="#local-6989586621679149082"><span class="hs-identifier hs-var">extract</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="#local-6989586621679149084"><span class="hs-identifier hs-type">step</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStat"><span class="hs-identifier hs-type">FStat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EigenstratSnpEntry</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenoLine</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679149084"><span class="annot"><span class="annottext">step :: FStat
-&gt; (Maybe GenomPos, Maybe GenomPos, Int, Double)
-&gt; (EigenstratSnpEntry, GenoLine)
-&gt; (Maybe GenomPos, Maybe GenomPos, Int, Double)
</span><a href="#local-6989586621679149084"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679149081"><span class="annot"><span class="annottext">FStat
</span><a href="#local-6989586621679149081"><span class="hs-identifier hs-var">fstat</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149080"><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149080"><span class="hs-identifier hs-var">maybeStartPos</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe GenomPos
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149079"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149079"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149078"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679149078"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EigenstratSnpEntry</span></span><span> </span><span id="local-6989586621679149076"><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679149076"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679149075"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149075"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149074"><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149074"><span class="hs-identifier hs-var">genoLine</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679149073"><span class="annot"><span class="annottext">newStartPos :: Maybe GenomPos
</span><a href="#local-6989586621679149073"><span class="hs-identifier hs-var hs-var">newStartPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149080"><span class="hs-identifier hs-var">maybeStartPos</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>                </span><span class="annot"><span class="annottext">Maybe GenomPos
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenomPos -&gt; Maybe GenomPos
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679149076"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149075"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149072"><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679149072"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149071"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149071"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenomPos -&gt; Maybe GenomPos
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679149072"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149071"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>            </span><span id="local-6989586621679149070"><span class="annot"><span class="annottext">newEndPos :: Maybe GenomPos
</span><a href="#local-6989586621679149070"><span class="hs-identifier hs-var hs-var">newEndPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenomPos -&gt; Maybe GenomPos
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679149076"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149075"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FStat -&gt; GenoLine -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFStat"><span class="hs-identifier hs-var">computeFStat</span></a></span><span> </span><span class="annot"><span class="annottext">FStat
</span><a href="#local-6989586621679149081"><span class="hs-identifier hs-var">fstat</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149074"><span class="hs-identifier hs-var">genoLine</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679149068"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679149068"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149073"><span class="hs-identifier hs-var">newStartPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149070"><span class="hs-identifier hs-var">newEndPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149079"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679149078"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679149068"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>                </span><span class="annot"><span class="annottext">Maybe Double
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149073"><span class="hs-identifier hs-var">newStartPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149070"><span class="hs-identifier hs-var">newEndPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149079"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679149078"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="#local-6989586621679149083"><span class="hs-identifier hs-type">initialize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679149083"><span class="annot"><span class="annottext">initialize :: (Maybe GenomPos, Maybe GenomPos, Int, Double)
</span><a href="#local-6989586621679149083"><span class="hs-identifier hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe GenomPos
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe GenomPos
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="#local-6989586621679149082"><span class="hs-identifier hs-type">extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#GenomPos"><span class="hs-identifier hs-type">GenomPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#BlockData"><span class="hs-identifier hs-type">BlockData</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679149082"><span class="annot"><span class="annottext">extract :: (Maybe GenomPos, Maybe GenomPos, Int, Double) -&gt; BlockData
</span><a href="#local-6989586621679149082"><span class="hs-identifier hs-var hs-var">extract</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149066"><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149066"><span class="hs-identifier hs-var">maybeStartPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149065"><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149065"><span class="hs-identifier hs-var">maybeEndPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149064"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149064"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149063"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679149063"><span class="hs-identifier hs-var">totalVal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679149062"><span class="annot"><span class="annottext">GenomPos
</span><a href="#local-6989586621679149062"><span class="hs-identifier hs-var">startPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149066"><span class="hs-identifier hs-var">maybeStartPos</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679149061"><span class="annot"><span class="annottext">GenomPos
</span><a href="#local-6989586621679149061"><span class="hs-identifier hs-var">endPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GenomPos
</span><a href="#local-6989586621679149065"><span class="hs-identifier hs-var">maybeEndPos</span></a></span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">GenomPos -&gt; GenomPos -&gt; Int -&gt; Double -&gt; BlockData
</span><a href="Poseidon.CLI.FStats.html#BlockData"><span class="hs-identifier hs-var">BlockData</span></a></span><span> </span><span class="annot"><span class="annottext">GenomPos
</span><a href="#local-6989586621679149062"><span class="hs-identifier hs-var">startPos</span></a></span><span> </span><span class="annot"><span class="annottext">GenomPos
</span><a href="#local-6989586621679149061"><span class="hs-identifier hs-var">endPos</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149064"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679149063"><span class="hs-identifier hs-var">totalVal</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149064"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#computeFStat"><span class="hs-identifier hs-type">computeFStat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStat"><span class="hs-identifier hs-type">FStat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenoLine</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-179"></span><span id="computeFStat"><span class="annot"><span class="annottext">computeFStat :: FStat -&gt; GenoLine -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFStat"><span class="hs-identifier hs-var hs-var">computeFStat</span></a></span></span><span> </span><span id="local-6989586621679149059"><span class="annot"><span class="annottext">FStat
</span><a href="#local-6989586621679149059"><span class="hs-identifier hs-var">fStat</span></a></span></span><span> </span><span id="local-6989586621679149058"><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FStat
</span><a href="#local-6989586621679149059"><span class="hs-identifier hs-var">fStat</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#F4"><span class="hs-identifier hs-type">F4</span></a></span><span>  </span><span id="local-6989586621679149057"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149057"><span class="hs-identifier hs-var">aI</span></a></span></span><span> </span><span id="local-6989586621679149056"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149056"><span class="hs-identifier hs-var">bI</span></a></span></span><span> </span><span id="local-6989586621679149055"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149055"><span class="hs-identifier hs-var">cI</span></a></span></span><span> </span><span id="local-6989586621679149054"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149054"><span class="hs-identifier hs-var">dI</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679149053"><span class="hs-identifier hs-var">computeF4</span></a></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double)
-&gt; Maybe Double -&gt; Maybe (Double -&gt; Double -&gt; Double -&gt; Double)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149057"><span class="hs-identifier hs-var">aI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Double -&gt; Double -&gt; Double -&gt; Double)
-&gt; Maybe Double -&gt; Maybe (Double -&gt; Double -&gt; Double)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149056"><span class="hs-identifier hs-var">bI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Double -&gt; Double -&gt; Double)
-&gt; Maybe Double -&gt; Maybe (Double -&gt; Double)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149055"><span class="hs-identifier hs-var">cI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Double -&gt; Double) -&gt; Maybe Double -&gt; Maybe Double
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149054"><span class="hs-identifier hs-var">dI</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#F3"><span class="hs-identifier hs-type">F3</span></a></span><span>  </span><span id="local-6989586621679149051"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149051"><span class="hs-identifier hs-var">aI</span></a></span></span><span> </span><span id="local-6989586621679149050"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149050"><span class="hs-identifier hs-var">bI</span></a></span></span><span> </span><span id="local-6989586621679149049"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149049"><span class="hs-identifier hs-var">cI</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679149048"><span class="hs-identifier hs-var">computeF3</span></a></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double -&gt; Double)
-&gt; Maybe Double -&gt; Maybe (Double -&gt; Double -&gt; Double)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149051"><span class="hs-identifier hs-var">aI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Double -&gt; Double -&gt; Double)
-&gt; Maybe Double -&gt; Maybe (Double -&gt; Double)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149050"><span class="hs-identifier hs-var">bI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Double -&gt; Double) -&gt; Maybe Double -&gt; Maybe Double
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149049"><span class="hs-identifier hs-var">cI</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#F2"><span class="hs-identifier hs-type">F2</span></a></span><span>  </span><span id="local-6989586621679149047"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149047"><span class="hs-identifier hs-var">aI</span></a></span></span><span> </span><span id="local-6989586621679149046"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149046"><span class="hs-identifier hs-var">bI</span></a></span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679149045"><span class="hs-identifier hs-var">computeF2</span></a></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double)
-&gt; Maybe Double -&gt; Maybe (Double -&gt; Double)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149047"><span class="hs-identifier hs-var">aI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Double -&gt; Double) -&gt; Maybe Double -&gt; Maybe Double
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149046"><span class="hs-identifier hs-var">bI</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#PWM"><span class="hs-identifier hs-type">PWM</span></a></span><span> </span><span id="local-6989586621679149044"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149044"><span class="hs-identifier hs-var">aI</span></a></span></span><span> </span><span id="local-6989586621679149043"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149043"><span class="hs-identifier hs-var">bI</span></a></span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679149042"><span class="hs-identifier hs-var">computePWM</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double)
-&gt; Maybe Double -&gt; Maybe (Double -&gt; Double)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149044"><span class="hs-identifier hs-var">aI</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Double -&gt; Double) -&gt; Maybe Double -&gt; Maybe Double
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var">computeFreq</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149058"><span class="hs-identifier hs-var">gL</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149043"><span class="hs-identifier hs-var">bI</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679149053"><span class="annot"><span class="annottext">computeF4 :: a -&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679149053"><span class="hs-identifier hs-var hs-var">computeF4</span></a></span></span><span>  </span><span id="local-6989586621679149041"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149041"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149040"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149040"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679149039"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149039"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679149038"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149038"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149041"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149040"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149039"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149038"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679149048"><span class="annot"><span class="annottext">computeF3 :: a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679149048"><span class="hs-identifier hs-var hs-var">computeF3</span></a></span></span><span>  </span><span id="local-6989586621679149036"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149036"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149035"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149035"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679149034"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149034"><span class="hs-identifier hs-var">c</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149034"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149036"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149034"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149035"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679149045"><span class="annot"><span class="annottext">computeF2 :: a -&gt; a -&gt; a
</span><a href="#local-6989586621679149045"><span class="hs-identifier hs-var hs-var">computeF2</span></a></span></span><span>  </span><span id="local-6989586621679149033"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149033"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149032"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149032"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149033"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149032"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149033"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149032"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679149042"><span class="annot"><span class="annottext">computePWM :: a -&gt; a -&gt; a
</span><a href="#local-6989586621679149042"><span class="hs-identifier hs-var hs-var">computePWM</span></a></span></span><span> </span><span id="local-6989586621679149031"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149031"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679149030"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149030"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149031"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149030"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149031"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149030"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-type">computeFreq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenoLine</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-191"></span><span id="computeFreq"><span class="annot"><span class="annottext">computeFreq :: GenoLine -&gt; [Int] -&gt; Maybe Double
</span><a href="Poseidon.CLI.FStats.html#computeFreq"><span class="hs-identifier hs-var hs-var">computeFreq</span></a></span></span><span> </span><span id="local-6989586621679149029"><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149029"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span id="local-6989586621679149028"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149028"><span class="hs-identifier hs-var">indices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679149027"><span class="annot"><span class="annottext">nrNonMissing :: Int
</span><a href="#local-6989586621679149027"><span class="hs-identifier hs-var hs-var">nrNonMissing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenoEntry] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([GenoEntry] -&gt; Int) -&gt; ([Int] -&gt; [GenoEntry]) -&gt; [Int] -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenoEntry -&gt; Bool) -&gt; [GenoEntry] -&gt; [GenoEntry]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenoEntry -&gt; GenoEntry -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">GenoEntry
</span><span class="hs-identifier hs-var">Missing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([GenoEntry] -&gt; [GenoEntry])
-&gt; ([Int] -&gt; [GenoEntry]) -&gt; [Int] -&gt; [GenoEntry]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; GenoEntry) -&gt; [Int] -&gt; [GenoEntry]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149029"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; Int -&gt; GenoEntry
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-glyph hs-var">!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149028"><span class="hs-identifier hs-var">indices</span></a></span><span>
</span><span id="line-193"></span><span>        </span><span id="local-6989586621679149022"><span class="annot"><span class="annottext">nrDerived :: Integer
</span><a href="#local-6989586621679149022"><span class="hs-identifier hs-var hs-var">nrDerived</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Integer] -&gt; Integer) -&gt; [Integer] -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-194"></span><span>            </span><span id="local-6989586621679149020"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149020"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149028"><span class="hs-identifier hs-var">indices</span></a></span><span>
</span><span id="line-195"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GenoLine
</span><a href="#local-6989586621679149029"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">GenoLine -&gt; Int -&gt; GenoEntry
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149020"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-196"></span><span>                </span><span class="annot"><span class="annottext">GenoEntry
</span><span class="hs-identifier hs-var">HomRef</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                </span><span class="annot"><span class="annottext">GenoEntry
</span><span class="hs-identifier hs-var">Het</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-198"></span><span>                </span><span class="annot"><span class="annottext">GenoEntry
</span><span class="hs-identifier hs-var">HomAlt</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-199"></span><span>                </span><span class="annot"><span class="annottext">GenoEntry
</span><span class="hs-identifier hs-var">Missing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Integer]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149027"><span class="hs-identifier hs-var">nrNonMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Maybe Double
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679149022"><span class="hs-identifier hs-var">nrDerived</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149027"><span class="hs-identifier hs-var">nrNonMissing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Double
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-type">getPopIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">EigenstratIndEntry</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span id="getPopIndices"><span class="annot"><span class="annottext">getPopIndices :: [EigenstratIndEntry] -&gt; PopSpec -&gt; Either PoseidonException [Int]
</span><a href="Poseidon.CLI.FStats.html#getPopIndices"><span class="hs-identifier hs-var hs-var">getPopIndices</span></a></span></span><span> </span><span id="local-6989586621679149015"><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149015"><span class="hs-identifier hs-var">indEntries</span></a></span></span><span> </span><span id="local-6989586621679149014"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149014"><span class="hs-identifier hs-var">popSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679149013"><span class="annot"><span class="annottext">ret :: [Int]
</span><a href="#local-6989586621679149013"><span class="hs-identifier hs-var hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679149012"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149012"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EigenstratIndEntry</span></span><span> </span><span id="local-6989586621679149010"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149010"><span class="hs-identifier hs-var">indName</span></a></span></span><span> </span><span class="annot"><span class="annottext">Sex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679149009"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149009"><span class="hs-identifier hs-var">popName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [EigenstratIndEntry] -&gt; [(Int, EigenstratIndEntry)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679149015"><span class="hs-identifier hs-var">indEntries</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149014"><span class="hs-identifier hs-var">popSpec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>                </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecGroup"><span class="hs-identifier hs-type">PopSpecGroup</span></a></span><span> </span><span id="local-6989586621679149008"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149008"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149008"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149009"><span class="hs-identifier hs-var">popName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecInd"><span class="hs-identifier hs-type">PopSpecInd</span></a></span><span>   </span><span id="local-6989586621679149007"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149007"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149007"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149010"><span class="hs-identifier hs-var">indName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; [Int]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679149012"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149013"><span class="hs-identifier hs-var">ret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679149014"><span class="hs-identifier hs-var">popSpec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>            </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecGroup"><span class="hs-identifier hs-type">PopSpecGroup</span></a></span><span> </span><span id="local-6989586621679149005"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149005"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; Either PoseidonException [Int]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(PoseidonException -&gt; Either PoseidonException [Int])
-&gt; PoseidonException -&gt; Either PoseidonException [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonIndSearchException"><span class="hs-identifier hs-var">PoseidonIndSearchException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Group name &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149005"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; not found&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>            </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecInd"><span class="hs-identifier hs-type">PopSpecInd</span></a></span><span>   </span><span id="local-6989586621679149003"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149003"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; Either PoseidonException [Int]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(PoseidonException -&gt; Either PoseidonException [Int])
-&gt; PoseidonException -&gt; Either PoseidonException [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonIndSearchException"><span class="hs-identifier hs-var">PoseidonIndSearchException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Individual name &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679149003"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; not found&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Either PoseidonException [Int]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679149013"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#pacReadOpts"><span class="hs-identifier hs-type">pacReadOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Package.html#PackageReadOptions"><span class="hs-identifier hs-type">PackageReadOptions</span></a></span><span>
</span><span id="line-219"></span><span id="pacReadOpts"><span class="annot"><span class="annottext">pacReadOpts :: PackageReadOptions
</span><a href="Poseidon.CLI.FStats.html#pacReadOpts"><span class="hs-identifier hs-var hs-var">pacReadOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageReadOptions
</span><a href="Poseidon.Package.html#defaultPackageReadOptions"><span class="hs-identifier hs-var">defaultPackageReadOptions</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><span class="annottext">_readOptVerbose :: Bool
</span><a href="Poseidon.Package.html#_readOptVerbose"><span class="hs-identifier hs-var">_readOptVerbose</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_readOptStopOnDuplicates :: Bool
</span><a href="Poseidon.Package.html#_readOptStopOnDuplicates"><span class="hs-identifier hs-var">_readOptStopOnDuplicates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_readOptIgnoreChecksums :: Bool
</span><a href="Poseidon.Package.html#_readOptIgnoreChecksums"><span class="hs-identifier hs-var">_readOptIgnoreChecksums</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_readOptIgnoreGeno :: Bool
</span><a href="Poseidon.Package.html#_readOptIgnoreGeno"><span class="hs-identifier hs-var">_readOptIgnoreGeno</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_readOptGenoCheck :: Bool
</span><a href="Poseidon.Package.html#_readOptGenoCheck"><span class="hs-identifier hs-var">_readOptGenoCheck</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | The main function running the FStats command.</span><span>
</span><span id="line-228"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#runFstats"><span class="hs-identifier hs-type">runFstats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#FstatsOptions"><span class="hs-identifier hs-type">FstatsOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span id="runFstats"><span class="annot"><span class="annottext">runFstats :: FstatsOptions -&gt; IO ()
</span><a href="Poseidon.CLI.FStats.html#runFstats"><span class="hs-identifier hs-var hs-var">runFstats</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.CLI.FStats.html#FstatsOptions"><span class="hs-identifier hs-type">FstatsOptions</span></a></span><span> </span><span id="local-6989586621679148996"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148996"><span class="hs-identifier hs-var">baseDirs</span></a></span></span><span> </span><span id="local-6989586621679148995"><span class="annot"><span class="annottext">JackknifeMode
</span><a href="#local-6989586621679148995"><span class="hs-identifier hs-var">jackknifeMode</span></a></span></span><span> </span><span id="local-6989586621679148994"><span class="annot"><span class="annottext">[Chrom]
</span><a href="#local-6989586621679148994"><span class="hs-identifier hs-var">exclusionList</span></a></span></span><span> </span><span id="local-6989586621679148993"><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148993"><span class="hs-identifier hs-var">statSpecsDirect</span></a></span></span><span> </span><span id="local-6989586621679148992"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679148992"><span class="hs-identifier hs-var">maybeStatSpecsFile</span></a></span></span><span> </span><span id="local-6989586621679148991"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679148991"><span class="hs-identifier hs-var">rawOutput</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- load packages --</span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679148990"><span class="annot"><span class="annottext">[PoseidonPackage]
</span><a href="#local-6989586621679148990"><span class="hs-identifier hs-var">allPackages</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PackageReadOptions -&gt; [FilePath] -&gt; IO [PoseidonPackage]
</span><a href="Poseidon.Package.html#readPoseidonPackageCollection"><span class="hs-identifier hs-var">readPoseidonPackageCollection</span></a></span><span> </span><span class="annot"><span class="annottext">PackageReadOptions
</span><a href="Poseidon.CLI.FStats.html#pacReadOpts"><span class="hs-identifier hs-var">pacReadOpts</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148996"><span class="hs-identifier hs-var">baseDirs</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679148989"><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148989"><span class="hs-identifier hs-var">statSpecsFromFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679148992"><span class="hs-identifier hs-var">maybeStatSpecsFile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FStatSpec] -&gt; IO [FStatSpec]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679148988"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148988"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [FStatSpec]
</span><a href="Poseidon.CLI.FStats.html#readStatSpecsFromFile"><span class="hs-identifier hs-var">readStatSpecsFromFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148988"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148987"><span class="annot"><span class="annottext">statSpecs :: [FStatSpec]
</span><a href="#local-6989586621679148987"><span class="hs-identifier hs-var hs-var">statSpecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148989"><span class="hs-identifier hs-var">statSpecsFromFile</span></a></span><span> </span><span class="annot"><span class="annottext">[FStatSpec] -&gt; [FStatSpec] -&gt; [FStatSpec]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148993"><span class="hs-identifier hs-var">statSpecsDirect</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[FStatSpec] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148987"><span class="hs-identifier hs-var">statSpecs</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;No statistics to be computed&quot;</span></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148986"><span class="annot"><span class="annottext">collectedStats :: [PopSpec]
</span><a href="#local-6989586621679148986"><span class="hs-identifier hs-var hs-var">collectedStats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FStatSpec] -&gt; [PopSpec]
</span><a href="Poseidon.CLI.FStats.html#collectStatSpecGroups"><span class="hs-identifier hs-var">collectStatSpecGroups</span></a></span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148987"><span class="hs-identifier hs-var">statSpecs</span></a></span><span>
</span><span id="line-240"></span><span>        </span><span id="local-6989586621679148984"><span class="annot"><span class="annottext">[PoseidonPackage]
</span><a href="#local-6989586621679148984"><span class="hs-identifier hs-var">relevantPackages</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PopSpec] -&gt; [PoseidonPackage] -&gt; IO [PoseidonPackage]
</span><a href="Poseidon.CLI.FStats.html#findRelevantPackages"><span class="hs-identifier hs-var">findRelevantPackages</span></a></span><span> </span><span class="annot"><span class="annottext">[PopSpec]
</span><a href="#local-6989586621679148986"><span class="hs-identifier hs-var">collectedStats</span></a></span><span> </span><span class="annot"><span class="annottext">[PoseidonPackage]
</span><a href="#local-6989586621679148990"><span class="hs-identifier hs-var">allPackages</span></a></span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FilePath)
-&gt; ([PoseidonPackage] -&gt; Int) -&gt; [PoseidonPackage] -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[PoseidonPackage] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([PoseidonPackage] -&gt; FilePath) -&gt; [PoseidonPackage] -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PoseidonPackage]
</span><a href="#local-6989586621679148984"><span class="hs-identifier hs-var">relevantPackages</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; relevant packages for chosen statistics identified:&quot;</span></span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">[PoseidonPackage] -&gt; (PoseidonPackage -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[PoseidonPackage]
</span><a href="#local-6989586621679148984"><span class="hs-identifier hs-var">relevantPackages</span></a></span><span> </span><span class="annot"><span class="annottext">((PoseidonPackage -&gt; IO ()) -&gt; IO ())
-&gt; (PoseidonPackage -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679148982"><span class="annot"><span class="annottext">PoseidonPackage
</span><a href="#local-6989586621679148982"><span class="hs-identifier hs-var">pac</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PoseidonPackage -&gt; FilePath
</span><a href="Poseidon.Package.html#posPacTitle"><span class="hs-identifier hs-var hs-var">posPacTitle</span></a></span><span> </span><span class="annot"><span class="annottext">PoseidonPackage
</span><a href="#local-6989586621679148982"><span class="hs-identifier hs-var">pac</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Computing stats &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[FStatSpec] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148987"><span class="hs-identifier hs-var">statSpecs</span></a></span><span>
</span><span id="line-244"></span><span>        </span><span id="local-6989586621679148980"><span class="annot"><span class="annottext">[[BlockData]]
</span><a href="#local-6989586621679148980"><span class="hs-identifier hs-var">blockData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SafeT IO [[BlockData]] -&gt; IO [[BlockData]]
forall (m :: * -&gt; *) r.
(MonadMask m, MonadIO m) =&gt;
SafeT m r -&gt; m r
</span><span class="hs-identifier hs-var">runSafeT</span></span><span> </span><span class="annot"><span class="annottext">(SafeT IO [[BlockData]] -&gt; IO [[BlockData]])
-&gt; SafeT IO [[BlockData]] -&gt; IO [[BlockData]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679148979"><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679148979"><span class="hs-identifier hs-var">eigenstratIndEntries</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679148978"><span class="annot"><span class="annottext">Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
</span><a href="#local-6989586621679148978"><span class="hs-identifier hs-var">eigenstratProd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Bool
-&gt; [PoseidonPackage]
-&gt; Maybe FilePath
-&gt; SafeT
     IO
     ([EigenstratIndEntry],
      Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ())
forall (m :: * -&gt; *).
MonadSafe m =&gt;
Bool
-&gt; Bool
-&gt; [PoseidonPackage]
-&gt; Maybe FilePath
-&gt; m ([EigenstratIndEntry],
      Producer (EigenstratSnpEntry, GenoLine) m ())
</span><a href="Poseidon.Package.html#getJointGenotypeData"><span class="hs-identifier hs-var">getJointGenotypeData</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[PoseidonPackage]
</span><a href="#local-6989586621679148984"><span class="hs-identifier hs-var">relevantPackages</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-246"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148977"><span class="annot"><span class="annottext">eigenstratProdFiltered :: Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
</span><a href="#local-6989586621679148977"><span class="hs-identifier hs-var hs-var">eigenstratProdFiltered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
</span><a href="#local-6989586621679148978"><span class="hs-identifier hs-var">eigenstratProd</span></a></span><span> </span><span class="annot"><span class="annottext">Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
-&gt; Proxy
     ()
     (EigenstratSnpEntry, GenoLine)
     ()
     (EigenstratSnpEntry, GenoLine)
     (SafeT IO)
     ()
-&gt; Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
forall (m :: * -&gt; *) a' a b r c' c.
Functor m =&gt;
Proxy a' a () b m r -&gt; Proxy () b c' c m r -&gt; Proxy a' a c' c m r
</span><span class="hs-operator hs-var">&gt;-&gt;</span></span><span> </span><span class="annot"><span class="annottext">((EigenstratSnpEntry, GenoLine) -&gt; Bool)
-&gt; Proxy
     ()
     (EigenstratSnpEntry, GenoLine)
     ()
     (EigenstratSnpEntry, GenoLine)
     (SafeT IO)
     ()
forall (m :: * -&gt; *) a r. Functor m =&gt; (a -&gt; Bool) -&gt; Pipe a a m r
</span><span class="hs-identifier hs-var">P.filter</span></span><span> </span><span class="annot"><span class="annottext">(EigenstratSnpEntry, GenoLine) -&gt; Bool
forall b. (EigenstratSnpEntry, b) -&gt; Bool
</span><a href="#local-6989586621679148975"><span class="hs-identifier hs-var">chromFilter</span></a></span><span>
</span><span id="line-247"></span><span>                </span><span id="local-6989586621679148974"><span class="annot"><span class="annottext">eigenstratProdInChunks :: FreeT
  (Producer (EigenstratSnpEntry, GenoLine) (SafeT IO)) (SafeT IO) ()
</span><a href="#local-6989586621679148974"><span class="hs-identifier hs-var hs-var">eigenstratProdInChunks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">JackknifeMode
</span><a href="#local-6989586621679148995"><span class="hs-identifier hs-var">jackknifeMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-248"></span><span>                    </span><span class="annot"><span class="annottext">JackknifeMode
</span><a href="Poseidon.CLI.FStats.html#JackknifePerChromosome"><span class="hs-identifier hs-var">JackknifePerChromosome</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
-&gt; FreeT
     (Producer (EigenstratSnpEntry, GenoLine) (SafeT IO)) (SafeT IO) ()
forall b x.
Producer (EigenstratSnpEntry, b) (SafeT IO) x
-&gt; FreeT (Producer (EigenstratSnpEntry, b) (SafeT IO)) (SafeT IO) x
</span><a href="#local-6989586621679148973"><span class="hs-identifier hs-var">chunkEigenstratByChromosome</span></a></span><span> </span><span class="annot"><span class="annottext">Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
</span><a href="#local-6989586621679148977"><span class="hs-identifier hs-var">eigenstratProdFiltered</span></a></span><span>
</span><span id="line-249"></span><span>                    </span><span class="annot"><a href="Poseidon.CLI.FStats.html#JackknifePerN"><span class="hs-identifier hs-type">JackknifePerN</span></a></span><span> </span><span id="local-6989586621679148972"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679148972"><span class="hs-identifier hs-var">chunkSize</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
-&gt; FreeT
     (Producer (EigenstratSnpEntry, GenoLine) (SafeT IO)) (SafeT IO) ()
forall (m :: * -&gt; *) a' x.
Monad m =&gt;
Int -&gt; Producer a' m x -&gt; FreeT (Producer a' m) m x
</span><a href="#local-6989586621679148971"><span class="hs-identifier hs-var">chunkEigenstratByNrSnps</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679148972"><span class="hs-identifier hs-var">chunkSize</span></a></span><span> </span><span class="annot"><span class="annottext">Producer (EigenstratSnpEntry, GenoLine) (SafeT IO) ()
</span><a href="#local-6989586621679148977"><span class="hs-identifier hs-var">eigenstratProdFiltered</span></a></span><span>
</span><span id="line-250"></span><span>            </span><span id="local-6989586621679148970"><span class="annot"><span class="annottext">Fold (EigenstratSnpEntry, GenoLine) [BlockData]
</span><a href="#local-6989586621679148970"><span class="hs-identifier hs-var">statsFold</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
-&gt; [FStatSpec]
-&gt; Either
     PoseidonException (Fold (EigenstratSnpEntry, GenoLine) [BlockData])
</span><a href="Poseidon.CLI.FStats.html#statSpecsFold"><span class="hs-identifier hs-var">statSpecsFold</span></a></span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679148979"><span class="hs-identifier hs-var">eigenstratIndEntries</span></a></span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148987"><span class="hs-identifier hs-var">statSpecs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679148969"><span class="annot"><span class="annottext">PoseidonException
</span><a href="#local-6989586621679148969"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">PoseidonException
-&gt; SafeT IO (Fold (EigenstratSnpEntry, GenoLine) [BlockData])
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException
</span><a href="#local-6989586621679148969"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-252"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679148968"><span class="annot"><span class="annottext">Fold (EigenstratSnpEntry, GenoLine) [BlockData]
</span><a href="#local-6989586621679148968"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Fold (EigenstratSnpEntry, GenoLine) [BlockData]
-&gt; SafeT IO (Fold (EigenstratSnpEntry, GenoLine) [BlockData])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Fold (EigenstratSnpEntry, GenoLine) [BlockData]
</span><a href="#local-6989586621679148968"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-253"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148967"><span class="annot"><span class="annottext">summaryStatsProd :: Proxy X () () [BlockData] (SafeT IO) ()
</span><a href="#local-6989586621679148967"><span class="hs-identifier hs-var hs-var">summaryStatsProd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x.
 (x -&gt; (EigenstratSnpEntry, GenoLine) -&gt; x)
 -&gt; x
 -&gt; (x -&gt; [BlockData])
 -&gt; FreeT
      (Producer (EigenstratSnpEntry, GenoLine) (SafeT IO)) (SafeT IO) ()
 -&gt; Proxy X () () [BlockData] (SafeT IO) ())
-&gt; Fold (EigenstratSnpEntry, GenoLine) [BlockData]
-&gt; FreeT
     (Producer (EigenstratSnpEntry, GenoLine) (SafeT IO)) (SafeT IO) ()
-&gt; Proxy X () () [BlockData] (SafeT IO) ()
forall a b r.
(forall x. (x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; r) -&gt; Fold a b -&gt; r
</span><span class="hs-identifier hs-var">purely</span></span><span> </span><span class="annot"><span class="annottext">forall x.
(x -&gt; (EigenstratSnpEntry, GenoLine) -&gt; x)
-&gt; x
-&gt; (x -&gt; [BlockData])
-&gt; FreeT
     (Producer (EigenstratSnpEntry, GenoLine) (SafeT IO)) (SafeT IO) ()
-&gt; Proxy X () () [BlockData] (SafeT IO) ()
forall (m :: * -&gt; *) x a b r.
Monad m =&gt;
(x -&gt; a -&gt; x)
-&gt; x -&gt; (x -&gt; b) -&gt; FreeT (Producer a m) m r -&gt; Producer b m r
</span><span class="hs-identifier hs-var">folds</span></span><span> </span><span class="annot"><span class="annottext">Fold (EigenstratSnpEntry, GenoLine) [BlockData]
</span><a href="#local-6989586621679148970"><span class="hs-identifier hs-var">statsFold</span></a></span><span> </span><span class="annot"><span class="annottext">FreeT
  (Producer (EigenstratSnpEntry, GenoLine) (SafeT IO)) (SafeT IO) ()
</span><a href="#local-6989586621679148974"><span class="hs-identifier hs-var">eigenstratProdInChunks</span></a></span><span>
</span><span id="line-254"></span><span>            </span><span class="annot"><span class="annottext">(forall x.
 (x -&gt; [BlockData] -&gt; x)
 -&gt; x
 -&gt; (x -&gt; [[BlockData]])
 -&gt; Proxy X () () [BlockData] (SafeT IO) ()
 -&gt; SafeT IO [[BlockData]])
-&gt; Fold [BlockData] [[BlockData]]
-&gt; Proxy X () () [BlockData] (SafeT IO) ()
-&gt; SafeT IO [[BlockData]]
forall a b r.
(forall x. (x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; r) -&gt; Fold a b -&gt; r
</span><span class="hs-identifier hs-var">purely</span></span><span> </span><span class="annot"><span class="annottext">forall x.
(x -&gt; [BlockData] -&gt; x)
-&gt; x
-&gt; (x -&gt; [[BlockData]])
-&gt; Proxy X () () [BlockData] (SafeT IO) ()
-&gt; SafeT IO [[BlockData]]
forall (m :: * -&gt; *) x a b.
Monad m =&gt;
(x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Producer a m () -&gt; m b
</span><span class="hs-identifier hs-var">P.fold</span></span><span> </span><span class="annot"><span class="annottext">Fold [BlockData] [[BlockData]]
forall a. Fold a [a]
</span><span class="hs-identifier hs-var">list</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy X () () [BlockData] (SafeT IO) ()
</span><a href="#local-6989586621679148967"><span class="hs-identifier hs-var">summaryStatsProd</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy X () () [BlockData] (SafeT IO) ()
-&gt; Proxy () [BlockData] () [BlockData] (SafeT IO) ()
-&gt; Proxy X () () [BlockData] (SafeT IO) ()
forall (m :: * -&gt; *) a' a b r c' c.
Functor m =&gt;
Proxy a' a () b m r -&gt; Proxy () b c' c m r -&gt; Proxy a' a c' c m r
</span><span class="hs-operator hs-var">&gt;-&gt;</span></span><span> </span><span class="annot"><span class="annottext">Consumer [BlockData] (SafeT IO) ()
-&gt; Proxy () [BlockData] () [BlockData] (SafeT IO) ()
forall (m :: * -&gt; *) a r. Monad m =&gt; Consumer a m r -&gt; Pipe a a m r
</span><span class="hs-identifier hs-var">P.tee</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([BlockData] -&gt; FilePath)
-&gt; Pipe [BlockData] FilePath (SafeT IO) ()
forall (m :: * -&gt; *) a b r. Functor m =&gt; (a -&gt; b) -&gt; Pipe a b m r
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="annot"><span class="annottext">[BlockData] -&gt; FilePath
</span><a href="#local-6989586621679148963"><span class="hs-identifier hs-var">showBlockLogOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Pipe [BlockData] FilePath (SafeT IO) ()
-&gt; Proxy () FilePath () X (SafeT IO) ()
-&gt; Consumer [BlockData] (SafeT IO) ()
forall (m :: * -&gt; *) a' a b r c' c.
Functor m =&gt;
Proxy a' a () b m r -&gt; Proxy () b c' c m r -&gt; Proxy a' a c' c m r
</span><span class="hs-operator hs-var">&gt;-&gt;</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Consumer' FilePath (SafeT IO) ()
forall (m :: * -&gt; *) r.
MonadIO m =&gt;
Handle -&gt; Consumer' FilePath m r
</span><span class="hs-identifier hs-var">P.toHandle</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148961"><span class="annot"><span class="annottext">jackknifeEstimates :: [(Double, Double)]
</span><a href="#local-6989586621679148961"><span class="hs-identifier hs-var hs-var">jackknifeEstimates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Int] -&gt; [Double] -&gt; (Double, Double)
</span><a href="Poseidon.CLI.FStats.html#computeJackknife"><span class="hs-identifier hs-var">computeJackknife</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockData -&gt; Int) -&gt; [BlockData] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">BlockData -&gt; Int
</span><a href="Poseidon.CLI.FStats.html#blockSiteCount"><span class="hs-identifier hs-var hs-var">blockSiteCount</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockData]
</span><a href="#local-6989586621679148959"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockData -&gt; Double) -&gt; [BlockData] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">BlockData -&gt; Double
</span><a href="Poseidon.CLI.FStats.html#blockVal"><span class="hs-identifier hs-var hs-var">blockVal</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockData]
</span><a href="#local-6989586621679148959"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679148959"><span class="annot"><span class="annottext">[BlockData]
</span><a href="#local-6989586621679148959"><span class="hs-identifier hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[BlockData]] -&gt; [[BlockData]]
forall a. [[a]] -&gt; [[a]]
</span><span class="hs-identifier hs-var">transpose</span></span><span> </span><span class="annot"><span class="annottext">[[BlockData]]
</span><a href="#local-6989586621679148980"><span class="hs-identifier hs-var">blockData</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span>            </span><span id="local-6989586621679148958"><span class="annot"><span class="annottext">colSpecs :: [ColSpec]
</span><a href="#local-6989586621679148958"><span class="hs-identifier hs-var hs-var">colSpecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ColSpec -&gt; [ColSpec]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LenSpec -&gt; Position H -&gt; AlignSpec -&gt; CutMark -&gt; ColSpec
</span><span class="hs-identifier hs-var">column</span></span><span> </span><span class="annot"><span class="annottext">LenSpec
</span><span class="hs-identifier hs-var">expand</span></span><span> </span><span class="annot"><span class="annottext">Position H
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="annottext">AlignSpec
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="annottext">CutMark
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>            </span><span id="local-6989586621679148956"><span class="annot"><span class="annottext">tableH :: [FilePath]
</span><a href="#local-6989586621679148956"><span class="hs-identifier hs-var hs-var">tableH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Statistic&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Estimate&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;StdErr&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Z score&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>            </span><span id="local-6989586621679148955"><span class="annot"><span class="annottext">tableB :: [[FilePath]]
</span><a href="#local-6989586621679148955"><span class="hs-identifier hs-var hs-var">tableB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679148954"><span class="annot"><span class="annottext">FStatSpec
</span><a href="#local-6989586621679148954"><span class="hs-identifier hs-var">fstat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679148953"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679148953"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
-&gt; [(Double, Double)] -&gt; [(FStatSpec, (Double, Double))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148987"><span class="hs-identifier hs-var">statSpecs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679148961"><span class="hs-identifier hs-var">jackknifeEstimates</span></a></span><span>
</span><span id="line-260"></span><span>                </span><span class="annot"><span class="annottext">[FilePath] -&gt; [[FilePath]]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FStatSpec -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FStatSpec
</span><a href="#local-6989586621679148954"><span class="hs-identifier hs-var">fstat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double) -&gt; Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679148953"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double) -&gt; Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679148953"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double) -&gt; Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679148953"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679148953"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-keyword">if</span><span>   </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679148991"><span class="hs-identifier hs-var">rawOutput</span></a></span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; FilePath
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\t&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148956"><span class="hs-identifier hs-var">tableH</span></a></span><span>
</span><span id="line-264"></span><span>            </span><span class="annot"><span class="annottext">[[FilePath]] -&gt; ([FilePath] -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[[FilePath]]
</span><a href="#local-6989586621679148955"><span class="hs-identifier hs-var">tableB</span></a></span><span> </span><span class="annot"><span class="annottext">(([FilePath] -&gt; IO ()) -&gt; IO ()) -&gt; ([FilePath] -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679148951"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148951"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; FilePath
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\t&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148951"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ColSpec]
-&gt; TableStyle -&gt; HeaderSpec -&gt; [RowGroup FilePath] -&gt; FilePath
forall a.
Cell a =&gt;
[ColSpec] -&gt; TableStyle -&gt; HeaderSpec -&gt; [RowGroup a] -&gt; FilePath
</span><span class="hs-identifier hs-var">tableString</span></span><span> </span><span class="annot"><span class="annottext">[ColSpec]
</span><a href="#local-6989586621679148958"><span class="hs-identifier hs-var">colSpecs</span></a></span><span> </span><span class="annot"><span class="annottext">TableStyle
</span><span class="hs-identifier hs-var">asciiRoundS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; HeaderSpec
</span><span class="hs-identifier hs-var">titlesH</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148956"><span class="hs-identifier hs-var">tableH</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[[FilePath]] -&gt; RowGroup FilePath
forall a. [Row a] -&gt; RowGroup a
</span><span class="hs-identifier hs-var">rowsG</span></span><span> </span><span class="annot"><span class="annottext">[[FilePath]]
</span><a href="#local-6989586621679148955"><span class="hs-identifier hs-var">tableB</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679148975"><span class="annot"><span class="annottext">chromFilter :: (EigenstratSnpEntry, b) -&gt; Bool
</span><a href="#local-6989586621679148975"><span class="hs-identifier hs-var hs-var">chromFilter</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EigenstratSnpEntry</span></span><span> </span><span id="local-6989586621679148950"><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679148950"><span class="hs-identifier hs-var">chrom</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679148950"><span class="hs-identifier hs-var">chrom</span></a></span><span> </span><span class="annot"><span class="annottext">Chrom -&gt; [Chrom] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[Chrom]
</span><a href="#local-6989586621679148994"><span class="hs-identifier hs-var">exclusionList</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679148973"><span class="annot"><span class="annottext">chunkEigenstratByChromosome :: Producer (EigenstratSnpEntry, b) (SafeT IO) x
-&gt; FreeT (Producer (EigenstratSnpEntry, b) (SafeT IO)) (SafeT IO) x
</span><a href="#local-6989586621679148973"><span class="hs-identifier hs-var hs-var">chunkEigenstratByChromosome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FoldLike
  (FreeT (Producer (EigenstratSnpEntry, b) (SafeT IO)) (SafeT IO) x)
  (Producer (EigenstratSnpEntry, b) (SafeT IO) x)
  (Producer Any (SafeT IO) x)
  (FreeT (Producer (EigenstratSnpEntry, b) (SafeT IO)) (SafeT IO) x)
  (FreeT (Producer Any (SafeT IO)) (SafeT IO) x)
-&gt; Producer (EigenstratSnpEntry, b) (SafeT IO) x
-&gt; FreeT (Producer (EigenstratSnpEntry, b) (SafeT IO)) (SafeT IO) x
forall a s t b. FoldLike a s t a b -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((EigenstratSnpEntry, b) -&gt; (EigenstratSnpEntry, b) -&gt; Bool)
-&gt; Lens
     (Producer (EigenstratSnpEntry, b) (SafeT IO) x)
     (Producer Any (SafeT IO) x)
     (FreeT (Producer (EigenstratSnpEntry, b) (SafeT IO)) (SafeT IO) x)
     (FreeT (Producer Any (SafeT IO)) (SafeT IO) x)
forall (m :: * -&gt; *) a' x a.
Monad m =&gt;
(a' -&gt; a' -&gt; Bool)
-&gt; Lens
     (Producer a' m x)
     (Producer a m x)
     (FreeT (Producer a' m) m x)
     (FreeT (Producer a m) m x)
</span><span class="hs-identifier hs-var">groupsBy</span></span><span> </span><span class="annot"><span class="annottext">(EigenstratSnpEntry, b) -&gt; (EigenstratSnpEntry, b) -&gt; Bool
forall b b.
(EigenstratSnpEntry, b) -&gt; (EigenstratSnpEntry, b) -&gt; Bool
</span><a href="#local-6989586621679148948"><span class="hs-identifier hs-var">sameChrom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679148948"><span class="annot"><span class="annottext">sameChrom :: (EigenstratSnpEntry, b) -&gt; (EigenstratSnpEntry, b) -&gt; Bool
</span><a href="#local-6989586621679148948"><span class="hs-identifier hs-var hs-var">sameChrom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EigenstratSnpEntry</span></span><span> </span><span id="local-6989586621679148947"><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679148947"><span class="hs-identifier hs-var">chrom1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EigenstratSnpEntry</span></span><span> </span><span id="local-6989586621679148946"><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679148946"><span class="hs-identifier hs-var">chrom2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679148947"><span class="hs-identifier hs-var">chrom1</span></a></span><span> </span><span class="annot"><span class="annottext">Chrom -&gt; Chrom -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Chrom
</span><a href="#local-6989586621679148946"><span class="hs-identifier hs-var">chrom2</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679148971"><span class="annot"><span class="annottext">chunkEigenstratByNrSnps :: Int -&gt; Producer a' m x -&gt; FreeT (Producer a' m) m x
</span><a href="#local-6989586621679148971"><span class="hs-identifier hs-var hs-var">chunkEigenstratByNrSnps</span></a></span></span><span> </span><span id="local-6989586621679148945"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679148945"><span class="hs-identifier hs-var">chunkSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FoldLike
  (FreeT (Producer a' m) m x)
  (Producer a' m x)
  (Producer Any m x)
  (FreeT (Producer a' m) m x)
  (FreeT (Producer Any m) m x)
-&gt; Producer a' m x -&gt; FreeT (Producer a' m) m x
forall a s t b. FoldLike a s t a b -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Lens
     (Producer a' m x)
     (Producer Any m x)
     (FreeT (Producer a' m) m x)
     (FreeT (Producer Any m) m x)
forall (m :: * -&gt; *) a' x a.
Monad m =&gt;
Int
-&gt; Lens
     (Producer a' m x)
     (Producer a m x)
     (FreeT (Producer a' m) m x)
     (FreeT (Producer a m) m x)
</span><span class="hs-identifier hs-var">chunksOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679148945"><span class="hs-identifier hs-var">chunkSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679148963"><span class="annot"><span class="annottext">showBlockLogOutput :: [BlockData] -&gt; FilePath
</span><a href="#local-6989586621679148963"><span class="hs-identifier hs-var hs-var">showBlockLogOutput</span></a></span></span><span> </span><span id="local-6989586621679148944"><span class="annot"><span class="annottext">[BlockData]
</span><a href="#local-6989586621679148944"><span class="hs-identifier hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;computing chunk range &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">GenomPos -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockData -&gt; GenomPos
</span><a href="Poseidon.CLI.FStats.html#blockStartPos"><span class="hs-identifier hs-var hs-var">blockStartPos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[BlockData] -&gt; BlockData
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[BlockData]
</span><a href="#local-6989586621679148944"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; - &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="annottext">GenomPos -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockData -&gt; GenomPos
</span><a href="Poseidon.CLI.FStats.html#blockEndPos"><span class="hs-identifier hs-var hs-var">blockEndPos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[BlockData] -&gt; BlockData
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[BlockData]
</span><a href="#local-6989586621679148944"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;, size &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FilePath)
-&gt; ([BlockData] -&gt; Int) -&gt; [BlockData] -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockData -&gt; Int
</span><a href="Poseidon.CLI.FStats.html#blockSiteCount"><span class="hs-identifier hs-var hs-var">blockSiteCount</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockData -&gt; Int)
-&gt; ([BlockData] -&gt; BlockData) -&gt; [BlockData] -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[BlockData] -&gt; BlockData
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockData]
</span><a href="#local-6989586621679148944"><span class="hs-identifier hs-var">blocks</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;, values &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; FilePath)
-&gt; ([BlockData] -&gt; [Double]) -&gt; [BlockData] -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(BlockData -&gt; Double) -&gt; [BlockData] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">BlockData -&gt; Double
</span><a href="Poseidon.CLI.FStats.html#blockVal"><span class="hs-identifier hs-var hs-var">blockVal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockData]
</span><a href="#local-6989586621679148944"><span class="hs-identifier hs-var">blocks</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#readStatSpecsFromFile"><span class="hs-identifier hs-type">readStatSpecsFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span id="readStatSpecsFromFile"><span class="annot"><span class="annottext">readStatSpecsFromFile :: FilePath -&gt; IO [FStatSpec]
</span><a href="Poseidon.CLI.FStats.html#readStatSpecsFromFile"><span class="hs-identifier hs-var hs-var">readStatSpecsFromFile</span></a></span></span><span> </span><span id="local-6989586621679148942"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148942"><span class="hs-identifier hs-var">statSpecsFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148941"><span class="annot"><span class="annottext">multiFstatSpecParser :: ParsecT FilePath () Identity [FStatSpec]
</span><a href="#local-6989586621679148941"><span class="hs-identifier hs-var hs-var">multiFstatSpecParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec
</span><a href="Poseidon.CLI.FStats.html#fStatSpecParser"><span class="hs-identifier hs-var">fStatSpecParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser FStatSpec
-&gt; ParsecT FilePath () Identity ()
-&gt; ParsecT FilePath () Identity [FStatSpec]
forall s (m :: * -&gt; *) t u a sep.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m sep -&gt; ParsecT s u m [a]
</span><span class="hs-operator hs-var">`P.sepBy1`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT FilePath () Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">P.newline</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity Char
-&gt; ParsecT FilePath () Identity ()
-&gt; ParsecT FilePath () Identity ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity ()
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">P.spaces</span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679148938"><span class="annot"><span class="annottext">Either ParseError [FStatSpec]
</span><a href="#local-6989586621679148938"><span class="hs-identifier hs-var">eitherParseResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity [FStatSpec]
-&gt; FilePath -&gt; IO (Either ParseError [FStatSpec])
forall a. Parser a -&gt; FilePath -&gt; IO (Either ParseError a)
</span><span class="hs-identifier hs-var">P.parseFromFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT FilePath () Identity ()
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">P.spaces</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity ()
-&gt; ParsecT FilePath () Identity [FStatSpec]
-&gt; ParsecT FilePath () Identity [FStatSpec]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity [FStatSpec]
</span><a href="#local-6989586621679148941"><span class="hs-identifier hs-var">multiFstatSpecParser</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity [FStatSpec]
-&gt; ParsecT FilePath () Identity ()
-&gt; ParsecT FilePath () Identity [FStatSpec]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FilePath () Identity ()
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">P.spaces</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148942"><span class="hs-identifier hs-var">statSpecsFile</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ParseError [FStatSpec]
</span><a href="#local-6989586621679148938"><span class="hs-identifier hs-var">eitherParseResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679148936"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679148936"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; IO [FStatSpec]
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFStatsFormatException"><span class="hs-identifier hs-var">PoseidonFStatsFormatException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseError -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679148936"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679148934"><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148934"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FStatSpec] -&gt; IO [FStatSpec]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148934"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#computeJackknife"><span class="hs-identifier hs-type">computeJackknife</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span id="computeJackknife"><span class="annot"><span class="annottext">computeJackknife :: [Int] -&gt; [Double] -&gt; (Double, Double)
</span><a href="Poseidon.CLI.FStats.html#computeJackknife"><span class="hs-identifier hs-var hs-var">computeJackknife</span></a></span></span><span> </span><span id="local-6989586621679148933"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679148933"><span class="hs-identifier hs-var">weights</span></a></span></span><span> </span><span id="local-6989586621679148932"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679148932"><span class="hs-identifier hs-var">values</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148931"><span class="annot"><span class="annottext">weights' :: [Double]
</span><a href="#local-6989586621679148931"><span class="hs-identifier hs-var hs-var">weights'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; [Int] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679148933"><span class="hs-identifier hs-var">weights</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span id="local-6989586621679148930"><span class="annot"><span class="annottext">sumWeights :: Double
</span><a href="#local-6989586621679148930"><span class="hs-identifier hs-var hs-var">sumWeights</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679148931"><span class="hs-identifier hs-var">weights'</span></a></span><span>
</span><span id="line-288"></span><span>        </span><span id="local-6989586621679148929"><span class="annot"><span class="annottext">g :: Double
</span><a href="#local-6989586621679148929"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679148933"><span class="hs-identifier hs-var">weights</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>        </span><span id="local-6989586621679148928"><span class="annot"><span class="annottext">theta :: Double
</span><a href="#local-6989586621679148928"><span class="hs-identifier hs-var hs-var">theta</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148927"><span class="hs-identifier hs-var">mj</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148926"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679148927"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148927"><span class="hs-identifier hs-var">mj</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679148926"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148926"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; [(Double, Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679148931"><span class="hs-identifier hs-var">weights'</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679148932"><span class="hs-identifier hs-var">values</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148930"><span class="hs-identifier hs-var">sumWeights</span></a></span><span>
</span><span id="line-290"></span><span>        </span><span id="local-6989586621679148925"><span class="annot"><span class="annottext">sigmaSquare :: Double
</span><a href="#local-6989586621679148925"><span class="hs-identifier hs-var hs-var">sigmaSquare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148924"><span class="hs-identifier hs-var">mj</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148923"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148928"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148930"><span class="hs-identifier hs-var">sumWeights</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148924"><span class="hs-identifier hs-var">mj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679148924"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148924"><span class="hs-identifier hs-var">mj</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679148923"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148923"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; [(Double, Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679148931"><span class="hs-identifier hs-var">weights'</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679148932"><span class="hs-identifier hs-var">values</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148929"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148928"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679148925"><span class="hs-identifier hs-var">sigmaSquare</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#collectStatSpecGroups"><span class="hs-identifier hs-type">collectStatSpecGroups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.CLI.FStats.html#FStatSpec"><span class="hs-identifier hs-type">FStatSpec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span id="collectStatSpecGroups"><span class="annot"><span class="annottext">collectStatSpecGroups :: [FStatSpec] -&gt; [PopSpec]
</span><a href="Poseidon.CLI.FStats.html#collectStatSpecGroups"><span class="hs-identifier hs-var hs-var">collectStatSpecGroups</span></a></span></span><span> </span><span id="local-6989586621679148920"><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148920"><span class="hs-identifier hs-var">statSpecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PopSpec] -&gt; [PopSpec]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">([PopSpec] -&gt; [PopSpec])
-&gt; ([[PopSpec]] -&gt; [PopSpec]) -&gt; [[PopSpec]] -&gt; [PopSpec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[PopSpec]] -&gt; [PopSpec]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[PopSpec]] -&gt; [PopSpec]) -&gt; [[PopSpec]] -&gt; [PopSpec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679148918"><span class="annot"><span class="annottext">FStatSpec
</span><a href="#local-6989586621679148918"><span class="hs-identifier hs-var">stat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FStatSpec]
</span><a href="#local-6989586621679148920"><span class="hs-identifier hs-var">statSpecs</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FStatSpec
</span><a href="#local-6989586621679148918"><span class="hs-identifier hs-var">stat</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><a href="Poseidon.CLI.FStats.html#F4Spec"><span class="hs-identifier hs-type">F4Spec</span></a></span><span>  </span><span id="local-6989586621679148917"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148917"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679148916"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148916"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679148915"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148915"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679148914"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148914"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[PopSpec] -&gt; [[PopSpec]]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148917"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148916"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148915"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148914"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><a href="Poseidon.CLI.FStats.html#F3Spec"><span class="hs-identifier hs-type">F3Spec</span></a></span><span>  </span><span id="local-6989586621679148913"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148913"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679148912"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148912"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679148911"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148911"><span class="hs-identifier hs-var">c</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[PopSpec] -&gt; [[PopSpec]]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148913"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148912"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148911"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><a href="Poseidon.CLI.FStats.html#F2Spec"><span class="hs-identifier hs-type">F2Spec</span></a></span><span>  </span><span id="local-6989586621679148910"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148910"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679148909"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148909"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[PopSpec] -&gt; [[PopSpec]]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148910"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148909"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PWMspec"><span class="hs-identifier hs-type">PWMspec</span></a></span><span> </span><span id="local-6989586621679148908"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148908"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679148907"><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148907"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[PopSpec] -&gt; [[PopSpec]]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148908"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PopSpec
</span><a href="#local-6989586621679148907"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><a href="Poseidon.CLI.FStats.html#findRelevantPackages"><span class="hs-identifier hs-type">findRelevantPackages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpec"><span class="hs-identifier hs-type">PopSpec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.Package.html#PoseidonPackage"><span class="hs-identifier hs-type">PoseidonPackage</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.Package.html#PoseidonPackage"><span class="hs-identifier hs-type">PoseidonPackage</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span id="findRelevantPackages"><span class="annot"><span class="annottext">findRelevantPackages :: [PopSpec] -&gt; [PoseidonPackage] -&gt; IO [PoseidonPackage]
</span><a href="Poseidon.CLI.FStats.html#findRelevantPackages"><span class="hs-identifier hs-var hs-var">findRelevantPackages</span></a></span></span><span> </span><span id="local-6989586621679148906"><span class="annot"><span class="annottext">[PopSpec]
</span><a href="#local-6989586621679148906"><span class="hs-identifier hs-var">popSpecs</span></a></span></span><span> </span><span id="local-6989586621679148905"><span class="annot"><span class="annottext">[PoseidonPackage]
</span><a href="#local-6989586621679148905"><span class="hs-identifier hs-var">packages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148904"><span class="annot"><span class="annottext">indNamesStats :: [FilePath]
</span><a href="#local-6989586621679148904"><span class="hs-identifier hs-var hs-var">indNamesStats</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148903"><span class="hs-identifier hs-var">ind</span></a></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecInd"><span class="hs-identifier hs-type">PopSpecInd</span></a></span><span>   </span><span id="local-6989586621679148903"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148903"><span class="hs-identifier hs-var">ind</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PopSpec]
</span><a href="#local-6989586621679148906"><span class="hs-identifier hs-var">popSpecs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>        </span><span id="local-6989586621679148902"><span class="annot"><span class="annottext">groupNamesStats :: [FilePath]
</span><a href="#local-6989586621679148902"><span class="hs-identifier hs-var hs-var">groupNamesStats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148901"><span class="hs-identifier hs-var">group</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Poseidon.CLI.FStats.html#PopSpecGroup"><span class="hs-identifier hs-type">PopSpecGroup</span></a></span><span> </span><span id="local-6989586621679148901"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148901"><span class="hs-identifier hs-var">group</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PopSpec]
</span><a href="#local-6989586621679148906"><span class="hs-identifier hs-var">popSpecs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">([Maybe PoseidonPackage] -&gt; [PoseidonPackage])
-&gt; IO [Maybe PoseidonPackage] -&gt; IO [PoseidonPackage]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Maybe PoseidonPackage] -&gt; [PoseidonPackage]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">(IO [Maybe PoseidonPackage] -&gt; IO [PoseidonPackage])
-&gt; ((PoseidonPackage -&gt; IO (Maybe PoseidonPackage))
    -&gt; IO [Maybe PoseidonPackage])
-&gt; (PoseidonPackage -&gt; IO (Maybe PoseidonPackage))
-&gt; IO [PoseidonPackage]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[PoseidonPackage]
-&gt; (PoseidonPackage -&gt; IO (Maybe PoseidonPackage))
-&gt; IO [Maybe PoseidonPackage]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[PoseidonPackage]
</span><a href="#local-6989586621679148905"><span class="hs-identifier hs-var">packages</span></a></span><span> </span><span class="annot"><span class="annottext">((PoseidonPackage -&gt; IO (Maybe PoseidonPackage))
 -&gt; IO [PoseidonPackage])
-&gt; (PoseidonPackage -&gt; IO (Maybe PoseidonPackage))
-&gt; IO [PoseidonPackage]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679148900"><span class="annot"><span class="annottext">PoseidonPackage
</span><a href="#local-6989586621679148900"><span class="hs-identifier hs-var">pac</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>        </span><span id="local-6989586621679148899"><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679148899"><span class="hs-identifier hs-var">inds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PoseidonPackage -&gt; IO [EigenstratIndEntry]
</span><a href="Poseidon.Package.html#getIndividuals"><span class="hs-identifier hs-var">getIndividuals</span></a></span><span> </span><span class="annot"><span class="annottext">PoseidonPackage
</span><a href="#local-6989586621679148900"><span class="hs-identifier hs-var">pac</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679148898"><span class="annot"><span class="annottext">indNamesPac :: [FilePath]
</span><a href="#local-6989586621679148898"><span class="hs-identifier hs-var hs-var">indNamesPac</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148897"><span class="hs-identifier hs-var">ind</span></a></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EigenstratIndEntry</span></span><span> </span><span id="local-6989586621679148897"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148897"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="annot"><span class="annottext">Sex
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679148899"><span class="hs-identifier hs-var">inds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span>            </span><span id="local-6989586621679148896"><span class="annot"><span class="annottext">groupNamesPac :: [FilePath]
</span><a href="#local-6989586621679148896"><span class="hs-identifier hs-var hs-var">groupNamesPac</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148895"><span class="hs-identifier hs-var">group</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EigenstratIndEntry</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Sex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679148895"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679148895"><span class="hs-identifier hs-var">group</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[EigenstratIndEntry]
</span><a href="#local-6989586621679148899"><span class="hs-identifier hs-var">inds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-keyword">if</span><span>   </span><span class="annot"><span class="annottext">[FilePath] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersect</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148898"><span class="hs-identifier hs-var">indNamesPac</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148904"><span class="hs-identifier hs-var">indNamesStats</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersect</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148896"><span class="hs-identifier hs-var">groupNamesPac</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679148902"><span class="hs-identifier hs-var">groupNamesStats</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe PoseidonPackage -&gt; IO (Maybe PoseidonPackage)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PoseidonPackage -&gt; Maybe PoseidonPackage
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PoseidonPackage
</span><a href="#local-6989586621679148900"><span class="hs-identifier hs-var">pac</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe PoseidonPackage -&gt; IO (Maybe PoseidonPackage)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe PoseidonPackage
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span></pre></body></html>