<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Poseidon.Utils</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier">PoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier">renderPoseidonException</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier">usePoseidonLogger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier">PoseidonLogIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#LogMode"><span class="hs-identifier">LogMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#checkFile"><span class="hs-identifier">checkFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#getChecksum"><span class="hs-identifier">getChecksum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier">logWarning</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logInfo"><span class="hs-identifier">logInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier">logDebug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logError"><span class="hs-identifier">logError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier">LogEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#noLog"><span class="hs-identifier">noLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Poseidon.Utils.html#logWithEnv"><span class="hs-identifier">logWithEnv</span></a></span><span>
</span><span id="line-18"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Colog</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasLog</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LogAction</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Message</span></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>                                         </span><span class="annot"><span class="hs-identifier">Msg</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Severity</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cfilter</span></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>                                         </span><span class="annot"><span class="hs-identifier">cmapM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logTextStderr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">msgSeverity</span></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                                         </span><span class="annot"><span class="hs-identifier">msgText</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showSeverity</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Exception</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IOException</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">try</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception.Base</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SomeException</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwM</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LB</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Digest.Pure.MD5</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">md5</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultTimeLocale</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">formatTime</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                                         </span><span class="annot"><span class="hs-identifier">getCurrentTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">utcToLocalZonedTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Yaml</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ParseException</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">callStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withFrozenCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Console.ANSI</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getCursorPosition</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">doesFileExist</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hPutStrLn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stderr</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">type</span><span> </span><span id="LogEnv"><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-var">LogEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogAction</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">type</span><span> </span><span id="PoseidonLogIO"><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier hs-var">PoseidonLogIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">data</span><span> </span><span id="LogMode"><span class="annot"><a href="Poseidon.Utils.html#LogMode"><span class="hs-identifier hs-var">LogMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NoLog"><span class="annot"><a href="Poseidon.Utils.html#NoLog"><span class="hs-identifier hs-var">NoLog</span></a></span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SimpleLog"><span class="annot"><a href="Poseidon.Utils.html#SimpleLog"><span class="hs-identifier hs-var">SimpleLog</span></a></span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DefaultLog"><span class="annot"><a href="Poseidon.Utils.html#DefaultLog"><span class="hs-identifier hs-var">DefaultLog</span></a></span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ServerLog"><span class="annot"><a href="Poseidon.Utils.html#ServerLog"><span class="hs-identifier hs-var">ServerLog</span></a></span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="VerboseLog"><span class="annot"><a href="Poseidon.Utils.html#VerboseLog"><span class="hs-identifier hs-var">VerboseLog</span></a></span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679150612"><span id="local-6989586621679150614"><span id="local-6989586621679150616"><span class="annot"><span class="annottext">Int -&gt; LogMode -&gt; ShowS
[LogMode] -&gt; ShowS
LogMode -&gt; String
(Int -&gt; LogMode -&gt; ShowS)
-&gt; (LogMode -&gt; String) -&gt; ([LogMode] -&gt; ShowS) -&gt; Show LogMode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LogMode] -&gt; ShowS
$cshowList :: [LogMode] -&gt; ShowS
show :: LogMode -&gt; String
$cshow :: LogMode -&gt; String
showsPrec :: Int -&gt; LogMode -&gt; ShowS
$cshowsPrec :: Int -&gt; LogMode -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span id="local-6989586621679150610"><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-type">usePoseidonLogger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogMode"><span class="hs-identifier hs-type">LogMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier hs-type">PoseidonLogIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679150610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679150610"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-53"></span><span id="usePoseidonLogger"><span class="annot"><span class="annottext">usePoseidonLogger :: LogMode -&gt; PoseidonLogIO a -&gt; IO a
</span><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var hs-var">usePoseidonLogger</span></a></span></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#NoLog"><span class="hs-identifier hs-var">NoLog</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonLogIO a -&gt; LogEnv -&gt; IO a)
-&gt; LogEnv -&gt; PoseidonLogIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonLogIO a -&gt; LogEnv -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">LogEnv
</span><a href="Poseidon.Utils.html#noLog"><span class="hs-identifier hs-var">noLog</span></a></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#SimpleLog"><span class="hs-identifier hs-var">SimpleLog</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonLogIO a -&gt; LogEnv -&gt; IO a)
-&gt; LogEnv -&gt; PoseidonLogIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonLogIO a -&gt; LogEnv -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">LogEnv
</span><a href="Poseidon.Utils.html#simpleLog"><span class="hs-identifier hs-var">simpleLog</span></a></span><span>
</span><span id="line-55"></span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#DefaultLog"><span class="hs-identifier hs-var">DefaultLog</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonLogIO a -&gt; LogEnv -&gt; IO a)
-&gt; LogEnv -&gt; PoseidonLogIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonLogIO a -&gt; LogEnv -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">LogEnv
</span><a href="Poseidon.Utils.html#defaultLog"><span class="hs-identifier hs-var">defaultLog</span></a></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#ServerLog"><span class="hs-identifier hs-var">ServerLog</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonLogIO a -&gt; LogEnv -&gt; IO a)
-&gt; LogEnv -&gt; PoseidonLogIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonLogIO a -&gt; LogEnv -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">LogEnv
</span><a href="Poseidon.Utils.html#serverLog"><span class="hs-identifier hs-var">serverLog</span></a></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Poseidon.Utils.html#usePoseidonLogger"><span class="hs-identifier hs-var">usePoseidonLogger</span></a></span><span> </span><span class="annot"><span class="annottext">LogMode
</span><a href="Poseidon.Utils.html#VerboseLog"><span class="hs-identifier hs-var">VerboseLog</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PoseidonLogIO a -&gt; LogEnv -&gt; IO a)
-&gt; LogEnv -&gt; PoseidonLogIO a -&gt; IO a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonLogIO a -&gt; LogEnv -&gt; IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">LogEnv
</span><a href="Poseidon.Utils.html#verboseLog"><span class="hs-identifier hs-var">verboseLog</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Poseidon.Utils.html#noLog"><span class="hs-identifier hs-type">noLog</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span>
</span><span id="line-60"></span><span id="noLog"><span class="annot"><span class="annottext">noLog :: LogEnv
</span><a href="Poseidon.Utils.html#noLog"><span class="hs-identifier hs-var hs-var">noLog</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; Bool) -&gt; LogEnv -&gt; LogEnv
forall (m :: * -&gt; *) msg.
Applicative m =&gt;
(msg -&gt; Bool) -&gt; LogAction m msg -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">cfilter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Message -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LogEnv
</span><a href="Poseidon.Utils.html#simpleLog"><span class="hs-identifier hs-var">simpleLog</span></a></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Poseidon.Utils.html#simpleLog"><span class="hs-identifier hs-type">simpleLog</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span>
</span><span id="line-62"></span><span id="simpleLog"><span class="annot"><span class="annottext">simpleLog :: LogEnv
</span><a href="Poseidon.Utils.html#simpleLog"><span class="hs-identifier hs-var hs-var">simpleLog</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; Bool) -&gt; LogEnv -&gt; LogEnv
forall (m :: * -&gt; *) msg.
Applicative m =&gt;
(msg -&gt; Bool) -&gt; LogAction m msg -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">cfilter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679150603"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150603"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Severity
forall sev. Msg sev -&gt; sev
</span><span class="hs-identifier hs-var hs-var">msgSeverity</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150603"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity -&gt; Severity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LogEnv -&gt; LogEnv) -&gt; LogEnv -&gt; LogEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool -&gt; LogEnv
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var">compileLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-63"></span><span class="annot"><a href="Poseidon.Utils.html#defaultLog"><span class="hs-identifier hs-type">defaultLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span>
</span><span id="line-64"></span><span id="defaultLog"><span class="annot"><span class="annottext">defaultLog :: LogEnv
</span><a href="Poseidon.Utils.html#defaultLog"><span class="hs-identifier hs-var hs-var">defaultLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; Bool) -&gt; LogEnv -&gt; LogEnv
forall (m :: * -&gt; *) msg.
Applicative m =&gt;
(msg -&gt; Bool) -&gt; LogAction m msg -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">cfilter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679150599"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150599"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Severity
forall sev. Msg sev -&gt; sev
</span><span class="hs-identifier hs-var hs-var">msgSeverity</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150599"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity -&gt; Severity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LogEnv -&gt; LogEnv) -&gt; LogEnv -&gt; LogEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool -&gt; LogEnv
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var">compileLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Poseidon.Utils.html#serverLog"><span class="hs-identifier hs-type">serverLog</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span>
</span><span id="line-66"></span><span id="serverLog"><span class="annot"><span class="annottext">serverLog :: LogEnv
</span><a href="Poseidon.Utils.html#serverLog"><span class="hs-identifier hs-var hs-var">serverLog</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; Bool) -&gt; LogEnv -&gt; LogEnv
forall (m :: * -&gt; *) msg.
Applicative m =&gt;
(msg -&gt; Bool) -&gt; LogAction m msg -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">cfilter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679150598"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150598"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Severity
forall sev. Msg sev -&gt; sev
</span><span class="hs-identifier hs-var hs-var">msgSeverity</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150598"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity -&gt; Severity -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LogEnv -&gt; LogEnv) -&gt; LogEnv -&gt; LogEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool -&gt; LogEnv
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var">compileLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Poseidon.Utils.html#verboseLog"><span class="hs-identifier hs-type">verboseLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span>
</span><span id="line-68"></span><span id="verboseLog"><span class="annot"><span class="annottext">verboseLog :: LogEnv
</span><a href="Poseidon.Utils.html#verboseLog"><span class="hs-identifier hs-var hs-var">verboseLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool -&gt; LogEnv
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var">compileLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-type">compileLogMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span>
</span><span id="line-71"></span><span id="compileLogMsg"><span class="annot"><span class="annottext">compileLogMsg :: Bool -&gt; Bool -&gt; Bool -&gt; LogEnv
</span><a href="Poseidon.Utils.html#compileLogMsg"><span class="hs-identifier hs-var hs-var">compileLogMsg</span></a></span></span><span> </span><span id="local-6989586621679150597"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150597"><span class="hs-identifier hs-var">severity</span></a></span></span><span> </span><span id="local-6989586621679150596"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150596"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span id="local-6989586621679150595"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150595"><span class="hs-identifier hs-var">cursorCheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; IO Text) -&gt; LogAction IO Text -&gt; LogEnv
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LogAction m b -&gt; LogAction m a
</span><span class="hs-identifier hs-var">cmapM</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; IO Text
</span><a href="#local-6989586621679150594"><span class="hs-identifier hs-var">prepareMessage</span></a></span><span> </span><span class="annot"><span class="annottext">LogAction IO Text
forall (m :: * -&gt; *). MonadIO m =&gt; LogAction m Text
</span><span class="hs-identifier hs-var">logTextStderr</span></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><a href="#local-6989586621679150594"><span class="hs-identifier hs-type">prepareMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-74"></span><span>        </span><span id="local-6989586621679150594"><span class="annot"><span class="annottext">prepareMessage :: Message -&gt; IO Text
</span><a href="#local-6989586621679150594"><span class="hs-identifier hs-var hs-var">prepareMessage</span></a></span></span><span> </span><span id="local-6989586621679150593"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150593"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-75"></span><span>            </span><span class="hs-comment">-- add a newline, if the current line is not empty (to handle e.g. the SNP or Pac progress counter)</span><span>
</span><span id="line-76"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150595"><span class="hs-identifier hs-var">cursorCheck</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-77"></span><span>                </span><span id="local-6989586621679150592"><span class="annot"><span class="annottext">Either IOException (Maybe (Int, Int))
</span><a href="#local-6989586621679150592"><span class="hs-identifier hs-var">eitherCurserPos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe (Int, Int)) -&gt; IO (Either IOException (Maybe (Int, Int)))
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe (Int, Int))
</span><span class="hs-identifier hs-var">getCursorPosition</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOException (Maybe (Int, Int))
</span><a href="#local-6989586621679150592"><span class="hs-identifier hs-var">eitherCurserPos</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-79"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679150591"><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679150591"><span class="hs-identifier hs-var">cursorPos</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-81"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679150590"><span class="annot"><span class="annottext">col :: Int
</span><a href="#local-6989586621679150590"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ((Int, Int) -&gt; Int) -&gt; Maybe (Int, Int) -&gt; Int
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679150591"><span class="hs-identifier hs-var">cursorPos</span></a></span><span>
</span><span id="line-82"></span><span>                            </span><span id="local-6989586621679150588"><span class="annot"><span class="annottext">isNotAtStartOfLine :: Bool
</span><a href="#local-6989586621679150588"><span class="hs-identifier hs-var hs-var">isNotAtStartOfLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679150590"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-83"></span><span>                        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150588"><span class="hs-identifier hs-var">isNotAtStartOfLine</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-84"></span><span>            </span><span class="hs-comment">-- prepare message</span><span>
</span><span id="line-85"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679150587"><span class="annot"><span class="annottext">textMessage :: Text
</span><a href="#local-6989586621679150587"><span class="hs-identifier hs-var hs-var">textMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Text
forall sev. Msg sev -&gt; Text
</span><span class="hs-identifier hs-var hs-var">msgText</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150593"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-86"></span><span>                </span><span id="local-6989586621679150586"><span class="annot"><span class="annottext">textSeverity :: Text
</span><a href="#local-6989586621679150586"><span class="hs-identifier hs-var hs-var">textSeverity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150597"><span class="hs-identifier hs-var">severity</span></a></span><span>
</span><span id="line-87"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; Text
</span><span class="hs-identifier hs-var">showSeverity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; Severity
forall sev. Msg sev -&gt; sev
</span><span class="hs-identifier hs-var hs-var">msgSeverity</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679150593"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-89"></span><span>            </span><span id="local-6989586621679150585"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679150585"><span class="hs-identifier hs-var">textTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150596"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-90"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>                        </span><span id="local-6989586621679150584"><span class="annot"><span class="annottext">ZonedTime
</span><a href="#local-6989586621679150584"><span class="hs-identifier hs-var">zonedTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; (UTCTime -&gt; IO ZonedTime) -&gt; IO ZonedTime
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; IO ZonedTime
</span><span class="hs-identifier hs-var">utcToLocalZonedTime</span></span><span>
</span><span id="line-92"></span><span>                        </span><span class="annot"><span class="annottext">Text -&gt; IO Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO Text) -&gt; Text -&gt; IO Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; ZonedTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><span class="hs-identifier hs-var">formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%T&quot;</span></span><span> </span><span class="annot"><span class="annottext">ZonedTime
</span><a href="#local-6989586621679150584"><span class="hs-identifier hs-var">zonedTime</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;] &quot;</span></span><span>
</span><span id="line-93"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IO Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-94"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; IO Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO Text) -&gt; Text -&gt; IO Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679150586"><span class="hs-identifier hs-var">textSeverity</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679150585"><span class="hs-identifier hs-var">textTime</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679150587"><span class="hs-identifier hs-var">textMessage</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-type">logMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Severity</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier hs-type">PoseidonLogIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span id="logMsg"><span class="annot"><span class="annottext">logMsg :: Severity -&gt; String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var hs-var">logMsg</span></a></span></span><span> </span><span id="local-6989586621679150582"><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621679150582"><span class="hs-identifier hs-var">sev</span></a></span></span><span> </span><span id="local-6989586621679150581"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150581"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">{-
    Using asks getLogAction here gives us a bit of flexibility. If in the future we'd like to expand the
    ReaderT environment by adding more options or parameters to LogEnv, perhaps even the command line options,
    we can do so, we just need to adapt the HasLog instance, which tells us how to get the logAction out of the
    environment.
    -}</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">LogAction</span></span><span> </span><span id="local-6989586621679150579"><span class="annot"><span class="annottext">Message -&gt; IO ()
</span><a href="#local-6989586621679150579"><span class="hs-identifier hs-var">logF</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(LogEnv -&gt; LogEnv) -&gt; ReaderT LogEnv IO LogEnv
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">LogEnv -&gt; LogEnv
forall env msg (m :: * -&gt; *).
HasLog env msg m =&gt;
env -&gt; LogAction m msg
</span><span class="hs-identifier hs-var">getLogAction</span></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; PoseidonLogIO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; PoseidonLogIO ())
-&gt; (Message -&gt; IO ()) -&gt; Message -&gt; PoseidonLogIO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall a. HasCallStack =&gt; (HasCallStack =&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">withFrozenCallStack</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; (Message -&gt; IO ()) -&gt; Message -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; IO ()
</span><a href="#local-6989586621679150579"><span class="hs-identifier hs-var">logF</span></a></span><span> </span><span class="annot"><span class="annottext">(Message -&gt; PoseidonLogIO ()) -&gt; Message -&gt; PoseidonLogIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Severity -&gt; CallStack -&gt; Text -&gt; Message
forall sev. sev -&gt; CallStack -&gt; Text -&gt; Msg sev
</span><span class="hs-identifier hs-var">Msg</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621679150582"><span class="hs-identifier hs-var">sev</span></a></span><span> </span><span class="annot"><span class="annottext">CallStack
HasCallStack =&gt; CallStack
</span><span class="hs-identifier hs-var">callStack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150581"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier hs-type">logWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier hs-type">PoseidonLogIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span id="logWarning"><span class="annot"><span class="annottext">logWarning :: String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier hs-var hs-var">logWarning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Warning</span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Poseidon.Utils.html#logInfo"><span class="hs-identifier hs-type">logInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier hs-type">PoseidonLogIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span id="logInfo"><span class="annot"><span class="annottext">logInfo :: String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logInfo"><span class="hs-identifier hs-var hs-var">logInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Info</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier hs-type">logDebug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier hs-type">PoseidonLogIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span id="logDebug"><span class="annot"><span class="annottext">logDebug :: String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier hs-var hs-var">logDebug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Poseidon.Utils.html#logError"><span class="hs-identifier hs-type">logError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier hs-type">PoseidonLogIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span id="logError"><span class="annot"><span class="annottext">logError :: String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logError"><span class="hs-identifier hs-var hs-var">logError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; String -&gt; PoseidonLogIO ()
</span><a href="Poseidon.Utils.html#logMsg"><span class="hs-identifier hs-var">logMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Error</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679150572"><span class="annot"><a href="Poseidon.Utils.html#logWithEnv"><span class="hs-identifier hs-type">logWithEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679150572"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonLogIO"><span class="hs-identifier hs-type">PoseidonLogIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679150572"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-120"></span><span id="logWithEnv"><span class="annot"><span class="annottext">logWithEnv :: LogEnv -&gt; PoseidonLogIO () -&gt; m ()
</span><a href="Poseidon.Utils.html#logWithEnv"><span class="hs-identifier hs-var hs-var">logWithEnv</span></a></span></span><span> </span><span id="local-6989586621679150571"><span class="annot"><span class="annottext">LogEnv
</span><a href="#local-6989586621679150571"><span class="hs-identifier hs-var">logEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ())
-&gt; (PoseidonLogIO () -&gt; IO ()) -&gt; PoseidonLogIO () -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PoseidonLogIO () -&gt; LogEnv -&gt; IO ())
-&gt; LogEnv -&gt; PoseidonLogIO () -&gt; IO ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">PoseidonLogIO () -&gt; LogEnv -&gt; IO ()
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">LogEnv
</span><a href="#local-6989586621679150571"><span class="hs-identifier hs-var">logEnv</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | A Poseidon Exception data type with several concrete constructors</span><span>
</span><span id="line-123"></span><span class="hs-keyword">data</span><span> </span><span id="PoseidonException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-var">PoseidonException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>    </span><span id="PoseidonYamlParseException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonYamlParseException"><span class="hs-identifier hs-var">PoseidonYamlParseException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseException</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent YAML parsing errors</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonPackageException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageException"><span class="hs-identifier hs-var">PoseidonPackageException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent a logical error in a package</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonPackageVersionException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageVersionException"><span class="hs-identifier hs-var">PoseidonPackageVersionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent an issue with a package version</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonPackageMissingVersionException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageMissingVersionException"><span class="hs-identifier hs-var">PoseidonPackageMissingVersionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-comment">-- ^ An exception to indicate a missing poseidonVersion field</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonIndSearchException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonIndSearchException"><span class="hs-identifier hs-var">PoseidonIndSearchException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent an error when searching for individuals or populations</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonGenotypeException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenotypeException"><span class="hs-identifier hs-var">PoseidonGenotypeException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent errors in the genotype data</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonGenotypeExceptionForward"><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenotypeExceptionForward"><span class="hs-identifier hs-var">PoseidonGenotypeExceptionForward</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent errors in the genotype data forwarded from the sequence-formats library</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonJannoRowException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonJannoRowException"><span class="hs-identifier hs-var">PoseidonJannoRowException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent errors when trying to parse the .janno file</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonJannoConsistencyException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonJannoConsistencyException"><span class="hs-identifier hs-var">PoseidonJannoConsistencyException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent within-janno consistency errors</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonCrossFileConsistencyException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonCrossFileConsistencyException"><span class="hs-identifier hs-var">PoseidonCrossFileConsistencyException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent inconsistencies across multiple files in a package</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonCollectionException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonCollectionException"><span class="hs-identifier hs-var">PoseidonCollectionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent logical issues in a poseidon package Collection</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonFileExistenceException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileExistenceException"><span class="hs-identifier hs-var">PoseidonFileExistenceException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent missing files</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonFileChecksumException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileChecksumException"><span class="hs-identifier hs-var">PoseidonFileChecksumException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent failed checksum tests</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonFStatsFormatException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonFStatsFormatException"><span class="hs-identifier hs-var">PoseidonFStatsFormatException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception type to represent FStat specification errors</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonBibTeXException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonBibTeXException"><span class="hs-identifier hs-var">PoseidonBibTeXException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to represent errors when trying to parse the .bib file</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonPoseidonEntityParsingException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonPoseidonEntityParsingException"><span class="hs-identifier hs-var">PoseidonPoseidonEntityParsingException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to indicate failed entity parsing</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonForgeEntitiesException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonForgeEntitiesException"><span class="hs-identifier hs-var">PoseidonForgeEntitiesException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to indicate issues in the forge selection</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonEmptyForgeException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonEmptyForgeException"><span class="hs-identifier hs-var">PoseidonEmptyForgeException</span></a></span></span><span> </span><span class="hs-comment">-- ^ An exception to throw if there is nothing to be forged</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonNewPackageConstructionException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonNewPackageConstructionException"><span class="hs-identifier hs-var">PoseidonNewPackageConstructionException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to indicate an issue in newPackageTemplate</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonRemoteJSONParsingException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonRemoteJSONParsingException"><span class="hs-identifier hs-var">PoseidonRemoteJSONParsingException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ An exception to indicate failed remote info JSON parsing</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonGenericException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenericException"><span class="hs-identifier hs-var">PoseidonGenericException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ A catch-all for any other type of exception</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonEmptyOutPacNameException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonEmptyOutPacNameException"><span class="hs-identifier hs-var">PoseidonEmptyOutPacNameException</span></a></span></span><span> </span><span class="hs-comment">-- ^ An exception to throw if the output package lacks a name</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PoseidonUnequalBaseDirException"><span class="annot"><a href="Poseidon.Utils.html#PoseidonUnequalBaseDirException"><span class="hs-identifier hs-var">PoseidonUnequalBaseDirException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-comment">-- ^ An exception to throw if genotype data files don't share a common base directory</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679150541"><span id="local-6989586621679150543"><span id="local-6989586621679150545"><span class="annot"><span class="annottext">Int -&gt; PoseidonException -&gt; ShowS
[PoseidonException] -&gt; ShowS
PoseidonException -&gt; String
(Int -&gt; PoseidonException -&gt; ShowS)
-&gt; (PoseidonException -&gt; String)
-&gt; ([PoseidonException] -&gt; ShowS)
-&gt; Show PoseidonException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PoseidonException] -&gt; ShowS
$cshowList :: [PoseidonException] -&gt; ShowS
show :: PoseidonException -&gt; String
$cshow :: PoseidonException -&gt; String
showsPrec :: Int -&gt; PoseidonException -&gt; ShowS
$cshowsPrec :: Int -&gt; PoseidonException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679150533"><span id="local-6989586621679150535"><span id="local-6989586621679150537"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span></span></span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-type">renderPoseidonException</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-152"></span><span id="renderPoseidonException"><span class="annot"><span class="annottext">renderPoseidonException :: PoseidonException -&gt; String
</span><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var hs-var">renderPoseidonException</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonYamlParseException"><span class="hs-identifier hs-type">PoseidonYamlParseException</span></a></span><span> </span><span id="local-6989586621679150531"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150531"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679150530"><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679150530"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not parse YAML file &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150531"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ParseException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParseException
</span><a href="#local-6989586621679150530"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageException"><span class="hs-identifier hs-type">PoseidonPackageException</span></a></span><span> </span><span id="local-6989586621679150528"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150528"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Encountered a logical error with a poseidon package: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150528"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageVersionException"><span class="hs-identifier hs-type">PoseidonPackageVersionException</span></a></span><span> </span><span id="local-6989586621679150527"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150527"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679150526"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150526"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Poseidon version mismatch in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150527"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. It has version \&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150526"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;, which is not supported by this trident version.&quot;</span></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonPackageMissingVersionException"><span class="hs-identifier hs-type">PoseidonPackageMissingVersionException</span></a></span><span> </span><span id="local-6989586621679150525"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150525"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The POSEIDON.yml file &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150525"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has no poseidonVersion field. &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This is mandatory.&quot;</span></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIndSearchException"><span class="hs-identifier hs-type">PoseidonIndSearchException</span></a></span><span> </span><span id="local-6989586621679150524"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150524"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150524"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenotypeException"><span class="hs-identifier hs-type">PoseidonGenotypeException</span></a></span><span> </span><span id="local-6989586621679150523"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150523"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Genotype data structurally inconsistent: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150523"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenotypeExceptionForward"><span class="hs-identifier hs-type">PoseidonGenotypeExceptionForward</span></a></span><span> </span><span id="local-6989586621679150522"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679150522"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Issues in genotype data parsing: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679150522"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonJannoRowException"><span class="hs-identifier hs-type">PoseidonJannoRowException</span></a></span><span> </span><span id="local-6989586621679150521"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150521"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679150520"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679150520"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679150519"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150519"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't read sample in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150521"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in line &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679150520"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150519"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonJannoConsistencyException"><span class="hs-identifier hs-type">PoseidonJannoConsistencyException</span></a></span><span> </span><span id="local-6989586621679150518"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150518"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679150517"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150517"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Consistency issues in .janno file &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150518"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150517"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonCrossFileConsistencyException"><span class="hs-identifier hs-type">PoseidonCrossFileConsistencyException</span></a></span><span> </span><span id="local-6989586621679150516"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150516"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679150515"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150515"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cross-file consistency issue in package &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150516"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150515"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonCollectionException"><span class="hs-identifier hs-type">PoseidonCollectionException</span></a></span><span> </span><span id="local-6989586621679150514"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150514"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The package collection is broken: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150514"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileExistenceException"><span class="hs-identifier hs-type">PoseidonFileExistenceException</span></a></span><span> </span><span id="local-6989586621679150513"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150513"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;File &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150513"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; does not exist&quot;</span></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonFileChecksumException"><span class="hs-identifier hs-type">PoseidonFileChecksumException</span></a></span><span> </span><span id="local-6989586621679150512"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150512"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;File checksum test failed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150512"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonFStatsFormatException"><span class="hs-identifier hs-type">PoseidonFStatsFormatException</span></a></span><span> </span><span id="local-6989586621679150511"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150511"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fstat specification error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150511"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonBibTeXException"><span class="hs-identifier hs-type">PoseidonBibTeXException</span></a></span><span> </span><span id="local-6989586621679150510"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150510"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679150509"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150509"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BibTex problem in file &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150510"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150509"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonPoseidonEntityParsingException"><span class="hs-identifier hs-type">PoseidonPoseidonEntityParsingException</span></a></span><span> </span><span id="local-6989586621679150508"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150508"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error when parsing the forge selection: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150508"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonForgeEntitiesException"><span class="hs-identifier hs-type">PoseidonForgeEntitiesException</span></a></span><span> </span><span id="local-6989586621679150507"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150507"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error in the forge selection: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150507"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="annot"><span class="annottext">PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonEmptyForgeException"><span class="hs-identifier hs-var">PoseidonEmptyForgeException</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Nothing to be forged&quot;</span></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonNewPackageConstructionException"><span class="hs-identifier hs-type">PoseidonNewPackageConstructionException</span></a></span><span> </span><span id="local-6989586621679150506"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150506"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150506"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonRemoteJSONParsingException"><span class="hs-identifier hs-type">PoseidonRemoteJSONParsingException</span></a></span><span> </span><span id="local-6989586621679150505"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150505"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error in parsing JSON: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150505"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonGenericException"><span class="hs-identifier hs-type">PoseidonGenericException</span></a></span><span> </span><span id="local-6989586621679150504"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150504"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150504"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="annot"><span class="annottext">PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonEmptyOutPacNameException"><span class="hs-identifier hs-var">PoseidonEmptyOutPacNameException</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error when preparing the new package: The output package does not have a name. Add one with: -n YourPackageName&quot;</span></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonUnequalBaseDirException"><span class="hs-identifier hs-type">PoseidonUnequalBaseDirException</span></a></span><span> </span><span id="local-6989586621679150503"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150503"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679150502"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150502"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679150501"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150501"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The base directories of these genotype files are not equal.&quot;</span></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --genoFile: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150503"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --snpFile: &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150502"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; --indFile: &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150501"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- helper function to check if a file exists</span><span>
</span><span id="line-204"></span><span class="annot"><a href="Poseidon.Utils.html#checkFile"><span class="hs-identifier hs-type">checkFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span id="checkFile"><span class="annot"><span class="annottext">checkFile :: String -&gt; Maybe String -&gt; IO ()
</span><a href="Poseidon.Utils.html#checkFile"><span class="hs-identifier hs-var hs-var">checkFile</span></a></span></span><span> </span><span id="local-6989586621679150500"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150500"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679150499"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679150499"><span class="hs-identifier hs-var">maybeChkSum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679150498"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150498"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150500"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679150498"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; IO ()
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileExistenceException"><span class="hs-identifier hs-var">PoseidonFileExistenceException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150500"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679150499"><span class="hs-identifier hs-var">maybeChkSum</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679150496"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150496"><span class="hs-identifier hs-var">chkSum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>                </span><span id="local-6989586621679150495"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150495"><span class="hs-identifier hs-var">fnChkSum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="Poseidon.Utils.html#getChecksum"><span class="hs-identifier hs-var">getChecksum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150500"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-214"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150495"><span class="hs-identifier hs-var">fnChkSum</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150496"><span class="hs-identifier hs-var">chkSum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; IO ()
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileChecksumException"><span class="hs-identifier hs-var">PoseidonFileChecksumException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150500"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- helper functions to get the checksum of a file</span><span>
</span><span id="line-217"></span><span class="annot"><a href="Poseidon.Utils.html#getChecksum"><span class="hs-identifier hs-type">getChecksum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-218"></span><span id="getChecksum"><span class="annot"><span class="annottext">getChecksum :: String -&gt; IO String
</span><a href="Poseidon.Utils.html#getChecksum"><span class="hs-identifier hs-var hs-var">getChecksum</span></a></span></span><span> </span><span id="local-6989586621679150494"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150494"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679150493"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679150493"><span class="hs-identifier hs-var">fileContent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><span class="hs-identifier hs-var">LB.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679150494"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679150491"><span class="annot"><span class="annottext">md5Digest :: MD5Digest
</span><a href="#local-6989586621679150491"><span class="hs-identifier hs-var hs-var">md5Digest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; MD5Digest
</span><span class="hs-identifier hs-var">md5</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679150493"><span class="hs-identifier hs-var">fileContent</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MD5Digest -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">MD5Digest
</span><a href="#local-6989586621679150491"><span class="hs-identifier hs-var">md5Digest</span></a></span><span>
</span><span id="line-222"></span></pre></body></html>