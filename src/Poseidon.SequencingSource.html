<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679491648"><span id="local-6989586621679491649"><span id="local-6989586621679491650"><span id="local-6989586621679491651"></span></span></span></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Poseidon.SequencingSource</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Poseidon.Janno.html"><span class="hs-identifier">Poseidon.Janno</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#AccessionID"><span class="hs-identifier">AccessionID</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>                                             </span><span class="annot"><a href="Poseidon.Janno.html#CsvNamedRecord"><span class="hs-identifier">CsvNamedRecord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#JURI"><span class="hs-identifier">JURI</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>                                             </span><span class="annot"><a href="Poseidon.Janno.html#JannoList"><span class="hs-identifier">JannoList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#JannoStringList"><span class="hs-identifier">JannoStringList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>                                             </span><span class="annot"><a href="Poseidon.Janno.html#decodingOptions"><span class="hs-identifier">decodingOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#encodingOptions"><span class="hs-identifier">encodingOptions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>                                             </span><span class="annot"><a href="Poseidon.Janno.html#explicitNA"><span class="hs-identifier">explicitNA</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#filterLookup"><span class="hs-identifier">filterLookup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>                                             </span><span class="annot"><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier">filterLookupOptional</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#getCsvNR"><span class="hs-identifier">getCsvNR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>                                             </span><span class="annot"><a href="Poseidon.Janno.html#makeAccessionID"><span class="hs-identifier">makeAccessionID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>                                             </span><span class="annot"><a href="Poseidon.Janno.html#removeUselessSuffix"><span class="hs-identifier">removeUselessSuffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Poseidon.Utils.html"><span class="hs-identifier">Poseidon.Utils</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier">PoseidonException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier">PoseidonIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>                                             </span><span class="annot"><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier">logDebug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#logError"><span class="hs-identifier">logError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier">logWarning</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>                                             </span><span class="annot"><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier">renderPoseidonException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                                             </span><span class="annot"><span class="hs-identifier">defaultOptions</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">genericToEncoding</span></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>                                             </span><span class="annot"><span class="hs-identifier">toEncoding</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withText</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson.Encoding</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">text</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bchs</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bch</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isHexDigit</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Csv</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Csv</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lefts</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rights</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Day</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time.Format</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultTimeLocale</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">formatTime</span></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>                                             </span><span class="annot"><span class="hs-identifier">parseTimeM</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Yaml.Aeson</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- |A datatype to represent UDG in a ssf file</span><span>
</span><span id="line-44"></span><span id="local-6989586621679491510"><span id="local-6989586621679491511"></span></span><span class="hs-keyword">data</span><span> </span><span id="SSFUDG"><span class="annot"><a href="Poseidon.SequencingSource.html#SSFUDG"><span class="hs-identifier hs-var">SSFUDG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-45"></span><span>      </span><span id="SSFMinus"><span class="annot"><a href="Poseidon.SequencingSource.html#SSFMinus"><span class="hs-identifier hs-var">SSFMinus</span></a></span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SSFHalf"><span class="annot"><a href="Poseidon.SequencingSource.html#SSFHalf"><span class="hs-identifier hs-var">SSFHalf</span></a></span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SSFPlus"><span class="annot"><a href="Poseidon.SequencingSource.html#SSFPlus"><span class="hs-identifier hs-var">SSFPlus</span></a></span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679491503"><span id="local-6989586621679491505"><span class="annot"><span class="annottext">SSFUDG -&gt; SSFUDG -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SSFUDG -&gt; SSFUDG -&gt; Bool
$c/= :: SSFUDG -&gt; SSFUDG -&gt; Bool
== :: SSFUDG -&gt; SSFUDG -&gt; Bool
$c== :: SSFUDG -&gt; SSFUDG -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679491483"><span id="local-6989586621679491485"><span id="local-6989586621679491488"><span id="local-6989586621679491491"><span id="local-6989586621679491494"><span id="local-6989586621679491496"><span id="local-6989586621679491498"><span class="annot"><span class="annottext">Eq SSFUDG
SSFUDG -&gt; SSFUDG -&gt; Bool
SSFUDG -&gt; SSFUDG -&gt; Ordering
SSFUDG -&gt; SSFUDG -&gt; SSFUDG
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: SSFUDG -&gt; SSFUDG -&gt; SSFUDG
$cmin :: SSFUDG -&gt; SSFUDG -&gt; SSFUDG
max :: SSFUDG -&gt; SSFUDG -&gt; SSFUDG
$cmax :: SSFUDG -&gt; SSFUDG -&gt; SSFUDG
&gt;= :: SSFUDG -&gt; SSFUDG -&gt; Bool
$c&gt;= :: SSFUDG -&gt; SSFUDG -&gt; Bool
&gt; :: SSFUDG -&gt; SSFUDG -&gt; Bool
$c&gt; :: SSFUDG -&gt; SSFUDG -&gt; Bool
&lt;= :: SSFUDG -&gt; SSFUDG -&gt; Bool
$c&lt;= :: SSFUDG -&gt; SSFUDG -&gt; Bool
&lt; :: SSFUDG -&gt; SSFUDG -&gt; Bool
$c&lt; :: SSFUDG -&gt; SSFUDG -&gt; Bool
compare :: SSFUDG -&gt; SSFUDG -&gt; Ordering
$ccompare :: SSFUDG -&gt; SSFUDG -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep SSFUDG x -&gt; SSFUDG
forall x. SSFUDG -&gt; Rep SSFUDG x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SSFUDG x -&gt; SSFUDG
$cfrom :: forall x. SSFUDG -&gt; Rep SSFUDG x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679491443"><span id="local-6989586621679491445"><span id="local-6989586621679491449"><span id="local-6989586621679491453"><span id="local-6989586621679491455"><span id="local-6989586621679491465"><span id="local-6989586621679491471"><span id="local-6989586621679491477"><span class="annot"><span class="annottext">Int -&gt; SSFUDG
SSFUDG -&gt; Int
SSFUDG -&gt; [SSFUDG]
SSFUDG -&gt; SSFUDG
SSFUDG -&gt; SSFUDG -&gt; [SSFUDG]
SSFUDG -&gt; SSFUDG -&gt; SSFUDG -&gt; [SSFUDG]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: SSFUDG -&gt; SSFUDG -&gt; SSFUDG -&gt; [SSFUDG]
$cenumFromThenTo :: SSFUDG -&gt; SSFUDG -&gt; SSFUDG -&gt; [SSFUDG]
enumFromTo :: SSFUDG -&gt; SSFUDG -&gt; [SSFUDG]
$cenumFromTo :: SSFUDG -&gt; SSFUDG -&gt; [SSFUDG]
enumFromThen :: SSFUDG -&gt; SSFUDG -&gt; [SSFUDG]
$cenumFromThen :: SSFUDG -&gt; SSFUDG -&gt; [SSFUDG]
enumFrom :: SSFUDG -&gt; [SSFUDG]
$cenumFrom :: SSFUDG -&gt; [SSFUDG]
fromEnum :: SSFUDG -&gt; Int
$cfromEnum :: SSFUDG -&gt; Int
toEnum :: Int -&gt; SSFUDG
$ctoEnum :: Int -&gt; SSFUDG
pred :: SSFUDG -&gt; SSFUDG
$cpred :: SSFUDG -&gt; SSFUDG
succ :: SSFUDG -&gt; SSFUDG
$csucc :: SSFUDG -&gt; SSFUDG
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679491438"><span id="local-6989586621679491440"><span class="annot"><span class="annottext">SSFUDG
forall a. a -&gt; a -&gt; Bounded a
maxBound :: SSFUDG
$cmaxBound :: SSFUDG
minBound :: SSFUDG
$cminBound :: SSFUDG
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491431"><span id="local-6989586621679491434"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFUDG"><span class="hs-identifier hs-type">SSFUDG</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621679491429"><span class="annot"><span class="annottext">show :: SSFUDG -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="annot"><span class="annottext">SSFUDG
</span><a href="Poseidon.SequencingSource.html#SSFMinus"><span class="hs-identifier hs-var">SSFMinus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;minus&quot;</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SSFUDG
</span><a href="Poseidon.SequencingSource.html#SSFHalf"><span class="hs-identifier hs-var">SSFHalf</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;half&quot;</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SSFUDG
</span><a href="Poseidon.SequencingSource.html#SSFPlus"><span class="hs-identifier hs-var">SSFPlus</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;plus&quot;</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621679493135"><span class="annot"><a href="Poseidon.SequencingSource.html#makeSSFUDG"><span class="hs-identifier hs-type">makeSSFUDG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679493135"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679493135"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFUDG"><span class="hs-identifier hs-type">SSFUDG</span></a></span></span><span>
</span><span id="line-56"></span><span id="makeSSFUDG"><span class="annot"><span class="annottext">makeSSFUDG :: forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SSFUDG
</span><a href="Poseidon.SequencingSource.html#makeSSFUDG"><span class="hs-identifier hs-var hs-var">makeSSFUDG</span></a></span></span><span> </span><span id="local-6989586621679491403"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491403"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491403"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;minus&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">SSFUDG
</span><a href="Poseidon.SequencingSource.html#SSFMinus"><span class="hs-identifier hs-var">SSFMinus</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491403"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;half&quot;</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">SSFUDG
</span><a href="Poseidon.SequencingSource.html#SSFHalf"><span class="hs-identifier hs-var">SSFHalf</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491403"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;plus&quot;</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">SSFUDG
</span><a href="Poseidon.SequencingSource.html#SSFPlus"><span class="hs-identifier hs-var">SSFPlus</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UDG &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491403"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not in [minus, half, plus]&quot;</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFUDG"><span class="hs-identifier hs-type">SSFUDG</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679491396"><span class="annot"><span class="annottext">toField :: SSFUDG -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></span></span><span> </span><span id="local-6989586621679491394"><span class="annot"><span class="annottext">SSFUDG
</span><a href="#local-6989586621679491394"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.toField</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SSFUDG
</span><a href="#local-6989586621679491394"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFUDG"><span class="hs-identifier hs-type">SSFUDG</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679491384"><span class="annot"><span class="annottext">parseField :: ByteString -&gt; Parser SSFUDG
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseField</span></span></span><span> </span><span id="local-6989586621679491382"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679491382"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromField a =&gt; ByteString -&gt; Parser a
</span><span class="hs-identifier hs-var">Csv.parseField</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679491382"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SSFUDG
</span><a href="Poseidon.SequencingSource.html#makeSSFUDG"><span class="hs-identifier hs-var">makeSSFUDG</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491375"><span id="local-6989586621679491377"><span id="local-6989586621679491380"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFUDG"><span class="hs-identifier hs-type">SSFUDG</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679491372"><span class="annot"><span class="annottext">toEncoding :: SSFUDG -&gt; Encoding
</span><a href="#local-6989586621679491372"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span id="local-6989586621679491371"><span class="annot"><span class="annottext">SSFUDG
</span><a href="#local-6989586621679491371"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Text -&gt; Encoding' a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SSFUDG
</span><a href="#local-6989586621679491371"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491367"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFUDG"><span class="hs-identifier hs-type">SSFUDG</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679491363"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser SSFUDG
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SSFUDG&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SSFUDG
</span><a href="Poseidon.SequencingSource.html#makeSSFUDG"><span class="hs-identifier hs-var">makeSSFUDG</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- |A datatype to represent Library_Built in a janno file</span><span>
</span><span id="line-72"></span><span id="local-6989586621679491358"><span id="local-6989586621679491359"></span></span><span class="hs-keyword">data</span><span> </span><span id="SSFLibraryBuilt"><span class="annot"><a href="Poseidon.SequencingSource.html#SSFLibraryBuilt"><span class="hs-identifier hs-var">SSFLibraryBuilt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-73"></span><span>      </span><span id="SSFDS"><span class="annot"><a href="Poseidon.SequencingSource.html#SSFDS"><span class="hs-identifier hs-var">SSFDS</span></a></span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SSFSS"><span class="annot"><a href="Poseidon.SequencingSource.html#SSFSS"><span class="hs-identifier hs-var">SSFSS</span></a></span></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679491352"><span id="local-6989586621679491354"><span class="annot"><span class="annottext">SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
$c/= :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
== :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
$c== :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679491333"><span id="local-6989586621679491335"><span id="local-6989586621679491338"><span id="local-6989586621679491341"><span id="local-6989586621679491344"><span id="local-6989586621679491346"><span id="local-6989586621679491348"><span class="annot"><span class="annottext">Eq SSFLibraryBuilt
SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Ordering
SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; SSFLibraryBuilt
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; SSFLibraryBuilt
$cmin :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; SSFLibraryBuilt
max :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; SSFLibraryBuilt
$cmax :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; SSFLibraryBuilt
&gt;= :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
$c&gt;= :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
&gt; :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
$c&gt; :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
&lt;= :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
$c&lt;= :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
&lt; :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
$c&lt; :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Bool
compare :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Ordering
$ccompare :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep SSFLibraryBuilt x -&gt; SSFLibraryBuilt
forall x. SSFLibraryBuilt -&gt; Rep SSFLibraryBuilt x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SSFLibraryBuilt x -&gt; SSFLibraryBuilt
$cfrom :: forall x. SSFLibraryBuilt -&gt; Rep SSFLibraryBuilt x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679491296"><span id="local-6989586621679491298"><span id="local-6989586621679491302"><span id="local-6989586621679491305"><span id="local-6989586621679491307"><span id="local-6989586621679491317"><span id="local-6989586621679491323"><span id="local-6989586621679491329"><span class="annot"><span class="annottext">Int -&gt; SSFLibraryBuilt
SSFLibraryBuilt -&gt; Int
SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
SSFLibraryBuilt -&gt; SSFLibraryBuilt
SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
SSFLibraryBuilt
-&gt; SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: SSFLibraryBuilt
-&gt; SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
$cenumFromThenTo :: SSFLibraryBuilt
-&gt; SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
enumFromTo :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
$cenumFromTo :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
enumFromThen :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
$cenumFromThen :: SSFLibraryBuilt -&gt; SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
enumFrom :: SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
$cenumFrom :: SSFLibraryBuilt -&gt; [SSFLibraryBuilt]
fromEnum :: SSFLibraryBuilt -&gt; Int
$cfromEnum :: SSFLibraryBuilt -&gt; Int
toEnum :: Int -&gt; SSFLibraryBuilt
$ctoEnum :: Int -&gt; SSFLibraryBuilt
pred :: SSFLibraryBuilt -&gt; SSFLibraryBuilt
$cpred :: SSFLibraryBuilt -&gt; SSFLibraryBuilt
succ :: SSFLibraryBuilt -&gt; SSFLibraryBuilt
$csucc :: SSFLibraryBuilt -&gt; SSFLibraryBuilt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679491292"><span id="local-6989586621679491294"><span class="annot"><span class="annottext">SSFLibraryBuilt
forall a. a -&gt; a -&gt; Bounded a
maxBound :: SSFLibraryBuilt
$cmaxBound :: SSFLibraryBuilt
minBound :: SSFLibraryBuilt
$cminBound :: SSFLibraryBuilt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491286"><span id="local-6989586621679491289"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFLibraryBuilt"><span class="hs-identifier hs-type">SSFLibraryBuilt</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679491285"><span class="annot"><span class="annottext">show :: SSFLibraryBuilt -&gt; String
</span><a href="#local-6989586621679491285"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#SSFDS"><span class="hs-identifier hs-var">SSFDS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ds&quot;</span></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#SSFSS"><span class="hs-identifier hs-var">SSFSS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ss&quot;</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span id="local-6989586621679493105"><span class="annot"><a href="Poseidon.SequencingSource.html#makeSSFLibraryBuilt"><span class="hs-identifier hs-type">makeSSFLibraryBuilt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679493105"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679493105"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFLibraryBuilt"><span class="hs-identifier hs-type">SSFLibraryBuilt</span></a></span></span><span>
</span><span id="line-82"></span><span id="makeSSFLibraryBuilt"><span class="annot"><span class="annottext">makeSSFLibraryBuilt :: forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#makeSSFLibraryBuilt"><span class="hs-identifier hs-var hs-var">makeSSFLibraryBuilt</span></a></span></span><span> </span><span id="local-6989586621679491268"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491268"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491268"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ds&quot;</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#SSFDS"><span class="hs-identifier hs-var">SSFDS</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491268"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ss&quot;</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#SSFSS"><span class="hs-identifier hs-var">SSFSS</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Library_Built &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491268"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not in [ds, ss]&quot;</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFLibraryBuilt"><span class="hs-identifier hs-type">SSFLibraryBuilt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679491263"><span class="annot"><span class="annottext">toField :: SSFLibraryBuilt -&gt; ByteString
</span><a href="#local-6989586621679491263"><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></a></span></span><span> </span><span id="local-6989586621679491262"><span class="annot"><span class="annottext">SSFLibraryBuilt
</span><a href="#local-6989586621679491262"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.toField</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SSFLibraryBuilt
</span><a href="#local-6989586621679491262"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFLibraryBuilt"><span class="hs-identifier hs-type">SSFLibraryBuilt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621679491256"><span class="annot"><span class="annottext">parseField :: ByteString -&gt; Parser SSFLibraryBuilt
</span><a href="#local-6989586621679491256"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseField</span></a></span></span><span> </span><span id="local-6989586621679491255"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679491255"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromField a =&gt; ByteString -&gt; Parser a
</span><span class="hs-identifier hs-var">Csv.parseField</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679491255"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#makeSSFLibraryBuilt"><span class="hs-identifier hs-var">makeSSFLibraryBuilt</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491248"><span id="local-6989586621679491250"><span id="local-6989586621679491253"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFLibraryBuilt"><span class="hs-identifier hs-type">SSFLibraryBuilt</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621679491246"><span class="annot"><span class="annottext">toEncoding :: SSFLibraryBuilt -&gt; Encoding
</span><a href="#local-6989586621679491246"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span id="local-6989586621679491245"><span class="annot"><span class="annottext">SSFLibraryBuilt
</span><a href="#local-6989586621679491245"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Text -&gt; Encoding' a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SSFLibraryBuilt
</span><a href="#local-6989586621679491245"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491242"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFLibraryBuilt"><span class="hs-identifier hs-type">SSFLibraryBuilt</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679491240"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser SSFLibraryBuilt
</span><a href="#local-6989586621679491240"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SSFLibraryBuilt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#makeSSFLibraryBuilt"><span class="hs-identifier hs-var">makeSSFLibraryBuilt</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | A data type to represent a seqSourceFile</span><span>
</span><span id="line-97"></span><span id="local-6989586621679491238"><span id="local-6989586621679491239"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="SeqSourceRows"><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SeqSourceRows"><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getSeqSourceRowList"><span class="annot"><span class="annottext">SeqSourceRows -&gt; [SeqSourceRow]
</span><a href="Poseidon.SequencingSource.html#getSeqSourceRowList"><span class="hs-identifier hs-var hs-var">getSeqSourceRowList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679491227"><span id="local-6989586621679491229"><span id="local-6989586621679491234"><span class="annot"><span class="annottext">Int -&gt; SeqSourceRows -&gt; ShowS
[SeqSourceRows] -&gt; ShowS
SeqSourceRows -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SeqSourceRows] -&gt; ShowS
$cshowList :: [SeqSourceRows] -&gt; ShowS
show :: SeqSourceRows -&gt; String
$cshow :: SeqSourceRows -&gt; String
showsPrec :: Int -&gt; SeqSourceRows -&gt; ShowS
$cshowsPrec :: Int -&gt; SeqSourceRows -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679491220"><span id="local-6989586621679491225"><span class="annot"><span class="annottext">SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
$c/= :: SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
== :: SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
$c== :: SeqSourceRows -&gt; SeqSourceRows -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep SeqSourceRows x -&gt; SeqSourceRows
forall x. SeqSourceRows -&gt; Rep SeqSourceRows x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SeqSourceRows x -&gt; SeqSourceRows
$cfrom :: forall x. SeqSourceRows -&gt; Rep SeqSourceRows x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491209"><span id="local-6989586621679491211"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679491203"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491203"><span class="hs-identifier hs-var">j1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679491202"><span class="annot"><span class="annottext">&lt;&gt; :: SeqSourceRows -&gt; SeqSourceRows -&gt; SeqSourceRows
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679491201"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491201"><span class="hs-identifier hs-var">j2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491203"><span class="hs-identifier hs-var">j1</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; [SeqSourceRow] -&gt; [SeqSourceRow]
</span><a href="#local-6989586621679491200"><span class="hs-operator hs-var">`combineTwoSeqSources`</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491201"><span class="hs-identifier hs-var">j2</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="#local-6989586621679491200"><span class="hs-identifier hs-type">combineTwoSeqSources</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>        </span><span id="local-6989586621679491200"><span class="annot"><span class="annottext">combineTwoSeqSources :: [SeqSourceRow] -&gt; [SeqSourceRow] -&gt; [SeqSourceRow]
</span><a href="#local-6989586621679491200"><span class="hs-identifier hs-var hs-var">combineTwoSeqSources</span></a></span></span><span> </span><span id="local-6989586621679491199"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491199"><span class="hs-identifier hs-var">seqSource1</span></a></span></span><span> </span><span id="local-6989586621679491198"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491198"><span class="hs-identifier hs-var">seqSource2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679491197"><span class="annot"><span class="annottext">simpleSeqSourceSum :: [SeqSourceRow]
</span><a href="#local-6989586621679491197"><span class="hs-identifier hs-var hs-var">simpleSeqSourceSum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491199"><span class="hs-identifier hs-var">seqSource1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491198"><span class="hs-identifier hs-var">seqSource2</span></a></span><span>
</span><span id="line-106"></span><span>                </span><span id="local-6989586621679491194"><span class="annot"><span class="annottext">toAddColNames :: [ByteString]
</span><a href="#local-6989586621679491194"><span class="hs-identifier hs-var hs-var">toAddColNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. HashMap k v -&gt; [k]
</span><span class="hs-identifier hs-var">HM.keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; [HashMap k v] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.unions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CsvNamedRecord -&gt; HashMap ByteString ByteString
</span><a href="Poseidon.Janno.html#getCsvNR"><span class="hs-identifier hs-var">getCsvNR</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491197"><span class="hs-identifier hs-var">simpleSeqSourceSum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>                </span><span id="local-6989586621679491187"><span class="annot"><span class="annottext">toAddEmptyCols :: HashMap ByteString ByteString
</span><a href="#local-6989586621679491187"><span class="hs-identifier hs-var hs-var">toAddEmptyCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679491185"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679491185"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679491185"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;n/a&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679491194"><span class="hs-identifier hs-var">toAddColNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString -&gt; SeqSourceRow -&gt; SeqSourceRow
</span><a href="#local-6989586621679491184"><span class="hs-identifier hs-var">addEmptyAddColsToSeqSourceRow</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679491187"><span class="hs-identifier hs-var">toAddEmptyCols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679491197"><span class="hs-identifier hs-var">simpleSeqSourceSum</span></a></span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><a href="#local-6989586621679491184"><span class="hs-identifier hs-type">addEmptyAddColsToSeqSourceRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.NamedRecord</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span id="local-6989586621679491184"><span class="annot"><span class="annottext">addEmptyAddColsToSeqSourceRow :: HashMap ByteString ByteString -&gt; SeqSourceRow -&gt; SeqSourceRow
</span><a href="#local-6989586621679491184"><span class="hs-identifier hs-var hs-var">addEmptyAddColsToSeqSourceRow</span></a></span></span><span> </span><span id="local-6989586621679491182"><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679491182"><span class="hs-identifier hs-var">toAdd</span></a></span></span><span> </span><span id="local-6989586621679491181"><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679491181"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>            </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679491181"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sAdditionalColumns :: CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString -&gt; CsvNamedRecord
</span><a href="Poseidon.Janno.html#CsvNamedRecord"><span class="hs-identifier hs-var">CsvNamedRecord</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
-&gt; HashMap ByteString ByteString -&gt; HashMap ByteString ByteString
</span><a href="#local-6989586621679491179"><span class="hs-identifier hs-var">fillAddCols</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679491182"><span class="hs-identifier hs-var">toAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CsvNamedRecord -&gt; HashMap ByteString ByteString
</span><a href="Poseidon.Janno.html#getCsvNR"><span class="hs-identifier hs-var">getCsvNR</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679491181"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><a href="#local-6989586621679491179"><span class="hs-identifier hs-type">fillAddCols</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.NamedRecord</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.NamedRecord</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.NamedRecord</span></span><span>
</span><span id="line-113"></span><span>        </span><span id="local-6989586621679491179"><span class="annot"><span class="annottext">fillAddCols :: HashMap ByteString ByteString
-&gt; HashMap ByteString ByteString -&gt; HashMap ByteString ByteString
</span><a href="#local-6989586621679491179"><span class="hs-identifier hs-var hs-var">fillAddCols</span></a></span></span><span> </span><span id="local-6989586621679491178"><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679491178"><span class="hs-identifier hs-var">toAdd</span></a></span></span><span> </span><span id="local-6989586621679491177"><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679491177"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v.
(Eq k, Hashable k) =&gt;
HashMap k v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.union</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679491177"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679491178"><span class="hs-identifier hs-var">toAdd</span></a></span><span> </span><span class="annot"><span class="annottext">forall k v w.
(Eq k, Hashable k) =&gt;
HashMap k v -&gt; HashMap k w -&gt; HashMap k v
</span><span class="hs-operator hs-var">`HM.difference`</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679491177"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491170"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679491167"><span class="annot"><span class="annottext">mempty :: SeqSourceRows
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679491163"><span class="annot"><span class="annottext">mconcat :: [SeqSourceRows] -&gt; SeqSourceRows
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mconcat</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491156"><span id="local-6989586621679491158"><span id="local-6989586621679491161"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679491104"><span class="annot"><span class="annottext">toEncoding :: SeqSourceRows -&gt; Encoding
</span><a href="#local-6989586621679491104"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(Generic a, GToJSON' Encoding Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">genericToEncoding</span></span><span> </span><span class="annot"><span class="annottext">Options
</span><span class="hs-identifier hs-var">defaultOptions</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491100"><span id="local-6989586621679491102"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span></span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- A data type to represent a run accession ID</span><span>
</span><span id="line-124"></span><span id="local-6989586621679491098"><span id="local-6989586621679491099"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="AccessionIDRun"><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-var">AccessionIDRun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AccessionIDRun"><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-var">AccessionIDRun</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getRunAccession"><span class="annot"><span class="annottext">AccessionIDRun -&gt; AccessionID
</span><a href="Poseidon.SequencingSource.html#getRunAccession"><span class="hs-identifier hs-var hs-var">getRunAccession</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#AccessionID"><span class="hs-identifier hs-type">AccessionID</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679491089"><span id="local-6989586621679491094"><span class="annot"><span class="annottext">AccessionIDRun -&gt; AccessionIDRun -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AccessionIDRun -&gt; AccessionIDRun -&gt; Bool
$c/= :: AccessionIDRun -&gt; AccessionIDRun -&gt; Bool
== :: AccessionIDRun -&gt; AccessionIDRun -&gt; Bool
$c== :: AccessionIDRun -&gt; AccessionIDRun -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep AccessionIDRun x -&gt; AccessionIDRun
forall x. AccessionIDRun -&gt; Rep AccessionIDRun x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep AccessionIDRun x -&gt; AccessionIDRun
$cfrom :: forall x. AccessionIDRun -&gt; Rep AccessionIDRun x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621679493002"><span class="annot"><a href="Poseidon.SequencingSource.html#makeAccessionIDRun"><span class="hs-identifier hs-type">makeAccessionIDRun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679493002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679493002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-type">AccessionIDRun</span></a></span></span><span>
</span><span id="line-128"></span><span id="makeAccessionIDRun"><span class="annot"><span class="annottext">makeAccessionIDRun :: forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDRun
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDRun"><span class="hs-identifier hs-var hs-var">makeAccessionIDRun</span></a></span></span><span> </span><span id="local-6989586621679491072"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491072"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679491071"><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679491071"><span class="hs-identifier hs-var">accsID</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionID
</span><a href="Poseidon.Janno.html#makeAccessionID"><span class="hs-identifier hs-var">makeAccessionID</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491072"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679491071"><span class="hs-identifier hs-var">accsID</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#INSDCRun"><span class="hs-identifier hs-type">INSDCRun</span></a></span><span> </span><span id="local-6989586621679491069"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491069"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AccessionID -&gt; AccessionIDRun
</span><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-var">AccessionIDRun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; AccessionID
</span><a href="Poseidon.Janno.html#INSDCRun"><span class="hs-identifier hs-var">INSDCRun</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491069"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">AccessionID
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Accession &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491072"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not a correct run accession&quot;</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491064"><span id="local-6989586621679491067"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-type">AccessionIDRun</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679491061"><span class="annot"><span class="annottext">show :: AccessionIDRun -&gt; String
</span><a href="#local-6989586621679491061"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-type">AccessionIDRun</span></a></span><span> </span><span id="local-6989586621679491060"><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679491060"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679491060"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-type">AccessionIDRun</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679491055"><span class="annot"><span class="annottext">toField :: AccessionIDRun -&gt; ByteString
</span><a href="#local-6989586621679491055"><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></a></span></span><span> </span><span id="local-6989586621679491054"><span class="annot"><span class="annottext">AccessionIDRun
</span><a href="#local-6989586621679491054"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.toField</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionIDRun
</span><a href="#local-6989586621679491054"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-139"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-type">AccessionIDRun</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679491048"><span class="annot"><span class="annottext">parseField :: ByteString -&gt; Parser AccessionIDRun
</span><a href="#local-6989586621679491048"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseField</span></a></span></span><span> </span><span id="local-6989586621679491047"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679491047"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromField a =&gt; ByteString -&gt; Parser a
</span><span class="hs-identifier hs-var">Csv.parseField</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679491047"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDRun
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDRun"><span class="hs-identifier hs-var">makeAccessionIDRun</span></a></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491040"><span id="local-6989586621679491042"><span id="local-6989586621679491045"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-type">AccessionIDRun</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679491038"><span class="annot"><span class="annottext">toEncoding :: AccessionIDRun -&gt; Encoding
</span><a href="#local-6989586621679491038"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span id="local-6989586621679491037"><span class="annot"><span class="annottext">AccessionIDRun
</span><a href="#local-6989586621679491037"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Text -&gt; Encoding' a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionIDRun
</span><a href="#local-6989586621679491037"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-143"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679491034"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-type">AccessionIDRun</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621679491032"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser AccessionIDRun
</span><a href="#local-6989586621679491032"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AccessionIDRun&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDRun
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDRun"><span class="hs-identifier hs-var">makeAccessionIDRun</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- A data type to represent a sample accession ID</span><span>
</span><span id="line-147"></span><span id="local-6989586621679491030"><span id="local-6989586621679491031"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="AccessionIDSample"><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-var">AccessionIDSample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AccessionIDSample"><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-var">AccessionIDSample</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getSampleAccession"><span class="annot"><span class="annottext">AccessionIDSample -&gt; AccessionID
</span><a href="Poseidon.SequencingSource.html#getSampleAccession"><span class="hs-identifier hs-var hs-var">getSampleAccession</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#AccessionID"><span class="hs-identifier hs-type">AccessionID</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679491022"><span id="local-6989586621679491026"><span class="annot"><span class="annottext">AccessionIDSample -&gt; AccessionIDSample -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AccessionIDSample -&gt; AccessionIDSample -&gt; Bool
$c/= :: AccessionIDSample -&gt; AccessionIDSample -&gt; Bool
== :: AccessionIDSample -&gt; AccessionIDSample -&gt; Bool
$c== :: AccessionIDSample -&gt; AccessionIDSample -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep AccessionIDSample x -&gt; AccessionIDSample
forall x. AccessionIDSample -&gt; Rep AccessionIDSample x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep AccessionIDSample x -&gt; AccessionIDSample
$cfrom :: forall x. AccessionIDSample -&gt; Rep AccessionIDSample x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="local-6989586621679492999"><span class="annot"><a href="Poseidon.SequencingSource.html#makeAccessionIDSample"><span class="hs-identifier hs-type">makeAccessionIDSample</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679492999"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679492999"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-type">AccessionIDSample</span></a></span></span><span>
</span><span id="line-151"></span><span id="makeAccessionIDSample"><span class="annot"><span class="annottext">makeAccessionIDSample :: forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDSample
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDSample"><span class="hs-identifier hs-var hs-var">makeAccessionIDSample</span></a></span></span><span> </span><span id="local-6989586621679491003"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491003"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679491002"><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679491002"><span class="hs-identifier hs-var">accsID</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionID
</span><a href="Poseidon.Janno.html#makeAccessionID"><span class="hs-identifier hs-var">makeAccessionID</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491003"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679491002"><span class="hs-identifier hs-var">accsID</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#INSDCBioSample"><span class="hs-identifier hs-type">INSDCBioSample</span></a></span><span> </span><span id="local-6989586621679491000"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491000"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AccessionID -&gt; AccessionIDSample
</span><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-var">AccessionIDSample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; AccessionID
</span><a href="Poseidon.Janno.html#INSDCBioSample"><span class="hs-identifier hs-var">INSDCBioSample</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491000"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#INSDCSample"><span class="hs-identifier hs-type">INSDCSample</span></a></span><span> </span><span id="local-6989586621679490998"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490998"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AccessionID -&gt; AccessionIDSample
</span><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-var">AccessionIDSample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; AccessionID
</span><a href="Poseidon.Janno.html#INSDCSample"><span class="hs-identifier hs-var">INSDCSample</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490998"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">AccessionID
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Accession &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679491003"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not a correct biosample/sample accession&quot;</span></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490993"><span id="local-6989586621679490996"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-type">AccessionIDSample</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679490991"><span class="annot"><span class="annottext">show :: AccessionIDSample -&gt; String
</span><a href="#local-6989586621679490991"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-type">AccessionIDSample</span></a></span><span> </span><span id="local-6989586621679490990"><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679490990"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679490990"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-type">AccessionIDSample</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679490985"><span class="annot"><span class="annottext">toField :: AccessionIDSample -&gt; ByteString
</span><a href="#local-6989586621679490985"><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></a></span></span><span> </span><span id="local-6989586621679490984"><span class="annot"><span class="annottext">AccessionIDSample
</span><a href="#local-6989586621679490984"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.toField</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionIDSample
</span><a href="#local-6989586621679490984"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-type">AccessionIDSample</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679490978"><span class="annot"><span class="annottext">parseField :: ByteString -&gt; Parser AccessionIDSample
</span><a href="#local-6989586621679490978"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseField</span></a></span></span><span> </span><span id="local-6989586621679490977"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490977"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromField a =&gt; ByteString -&gt; Parser a
</span><span class="hs-identifier hs-var">Csv.parseField</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490977"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDSample
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDSample"><span class="hs-identifier hs-var">makeAccessionIDSample</span></a></span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490970"><span id="local-6989586621679490972"><span id="local-6989586621679490975"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-type">AccessionIDSample</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679490968"><span class="annot"><span class="annottext">toEncoding :: AccessionIDSample -&gt; Encoding
</span><a href="#local-6989586621679490968"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span id="local-6989586621679490967"><span class="annot"><span class="annottext">AccessionIDSample
</span><a href="#local-6989586621679490967"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Text -&gt; Encoding' a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionIDSample
</span><a href="#local-6989586621679490967"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490964"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-type">AccessionIDSample</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679490962"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser AccessionIDSample
</span><a href="#local-6989586621679490962"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AccessionIDSample&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDSample
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDSample"><span class="hs-identifier hs-var">makeAccessionIDSample</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- A data type to represent a study accession ID</span><span>
</span><span id="line-171"></span><span id="local-6989586621679490960"><span id="local-6989586621679490961"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="AccessionIDStudy"><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-var">AccessionIDStudy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AccessionIDStudy"><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-var">AccessionIDStudy</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getStudyAccession"><span class="annot"><span class="annottext">AccessionIDStudy -&gt; AccessionID
</span><a href="Poseidon.SequencingSource.html#getStudyAccession"><span class="hs-identifier hs-var hs-var">getStudyAccession</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#AccessionID"><span class="hs-identifier hs-type">AccessionID</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679490952"><span id="local-6989586621679490956"><span class="annot"><span class="annottext">AccessionIDStudy -&gt; AccessionIDStudy -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AccessionIDStudy -&gt; AccessionIDStudy -&gt; Bool
$c/= :: AccessionIDStudy -&gt; AccessionIDStudy -&gt; Bool
== :: AccessionIDStudy -&gt; AccessionIDStudy -&gt; Bool
$c== :: AccessionIDStudy -&gt; AccessionIDStudy -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep AccessionIDStudy x -&gt; AccessionIDStudy
forall x. AccessionIDStudy -&gt; Rep AccessionIDStudy x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep AccessionIDStudy x -&gt; AccessionIDStudy
$cfrom :: forall x. AccessionIDStudy -&gt; Rep AccessionIDStudy x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490942"><span id="local-6989586621679490945"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-type">AccessionIDStudy</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679490940"><span class="annot"><span class="annottext">show :: AccessionIDStudy -&gt; String
</span><a href="#local-6989586621679490940"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-type">AccessionIDStudy</span></a></span><span> </span><span id="local-6989586621679490939"><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679490939"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679490939"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679492997"><span class="annot"><a href="Poseidon.SequencingSource.html#makeAccessionIDStudy"><span class="hs-identifier hs-type">makeAccessionIDStudy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679492997"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679492997"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-type">AccessionIDStudy</span></a></span></span><span>
</span><span id="line-178"></span><span id="makeAccessionIDStudy"><span class="annot"><span class="annottext">makeAccessionIDStudy :: forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDStudy"><span class="hs-identifier hs-var hs-var">makeAccessionIDStudy</span></a></span></span><span> </span><span id="local-6989586621679490925"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490925"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679490924"><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679490924"><span class="hs-identifier hs-var">accsID</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionID
</span><a href="Poseidon.Janno.html#makeAccessionID"><span class="hs-identifier hs-var">makeAccessionID</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490925"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AccessionID
</span><a href="#local-6989586621679490924"><span class="hs-identifier hs-var">accsID</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#INSDCProject"><span class="hs-identifier hs-type">INSDCProject</span></a></span><span> </span><span id="local-6989586621679490922"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490922"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AccessionID -&gt; AccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-var">AccessionIDStudy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; AccessionID
</span><a href="Poseidon.Janno.html#INSDCProject"><span class="hs-identifier hs-var">INSDCProject</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490922"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#INSDCStudy"><span class="hs-identifier hs-type">INSDCStudy</span></a></span><span> </span><span id="local-6989586621679490920"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490920"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AccessionID -&gt; AccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-var">AccessionIDStudy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; AccessionID
</span><a href="Poseidon.Janno.html#INSDCStudy"><span class="hs-identifier hs-var">INSDCStudy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490920"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">AccessionID
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Accession &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490925"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not a correct project/study accession&quot;</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-type">AccessionIDStudy</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679490915"><span class="annot"><span class="annottext">toField :: AccessionIDStudy -&gt; ByteString
</span><a href="#local-6989586621679490915"><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></a></span></span><span> </span><span id="local-6989586621679490914"><span class="annot"><span class="annottext">AccessionIDStudy
</span><a href="#local-6989586621679490914"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.toField</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionIDStudy
</span><a href="#local-6989586621679490914"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-type">AccessionIDStudy</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679490908"><span class="annot"><span class="annottext">parseField :: ByteString -&gt; Parser AccessionIDStudy
</span><a href="#local-6989586621679490908"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseField</span></a></span></span><span> </span><span id="local-6989586621679490907"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490907"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromField a =&gt; ByteString -&gt; Parser a
</span><span class="hs-identifier hs-var">Csv.parseField</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490907"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDStudy"><span class="hs-identifier hs-var">makeAccessionIDStudy</span></a></span><span>
</span><span id="line-189"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490900"><span id="local-6989586621679490902"><span id="local-6989586621679490905"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-type">AccessionIDStudy</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679490898"><span class="annot"><span class="annottext">toEncoding :: AccessionIDStudy -&gt; Encoding
</span><a href="#local-6989586621679490898"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span id="local-6989586621679490897"><span class="annot"><span class="annottext">AccessionIDStudy
</span><a href="#local-6989586621679490897"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Text -&gt; Encoding' a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AccessionIDStudy
</span><a href="#local-6989586621679490897"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-191"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490894"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-type">AccessionIDStudy</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679490892"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser AccessionIDStudy
</span><a href="#local-6989586621679490892"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AccessionIDStudy&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m AccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#makeAccessionIDStudy"><span class="hs-identifier hs-var">makeAccessionIDStudy</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | A datatype for calendar dates</span><span>
</span><span id="line-195"></span><span id="local-6989586621679490890"><span id="local-6989586621679490891"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="SimpleDate"><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-var">SimpleDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SimpleDate"><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-var">SimpleDate</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679490882"><span id="local-6989586621679490887"><span class="annot"><span class="annottext">SimpleDate -&gt; SimpleDate -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SimpleDate -&gt; SimpleDate -&gt; Bool
$c/= :: SimpleDate -&gt; SimpleDate -&gt; Bool
== :: SimpleDate -&gt; SimpleDate -&gt; Bool
$c== :: SimpleDate -&gt; SimpleDate -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679490850"><span id="local-6989586621679490854"><span id="local-6989586621679490858"><span id="local-6989586621679490862"><span id="local-6989586621679490866"><span id="local-6989586621679490870"><span id="local-6989586621679490875"><span class="annot"><span class="annottext">Eq SimpleDate
SimpleDate -&gt; SimpleDate -&gt; Bool
SimpleDate -&gt; SimpleDate -&gt; Ordering
SimpleDate -&gt; SimpleDate -&gt; SimpleDate
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: SimpleDate -&gt; SimpleDate -&gt; SimpleDate
$cmin :: SimpleDate -&gt; SimpleDate -&gt; SimpleDate
max :: SimpleDate -&gt; SimpleDate -&gt; SimpleDate
$cmax :: SimpleDate -&gt; SimpleDate -&gt; SimpleDate
&gt;= :: SimpleDate -&gt; SimpleDate -&gt; Bool
$c&gt;= :: SimpleDate -&gt; SimpleDate -&gt; Bool
&gt; :: SimpleDate -&gt; SimpleDate -&gt; Bool
$c&gt; :: SimpleDate -&gt; SimpleDate -&gt; Bool
&lt;= :: SimpleDate -&gt; SimpleDate -&gt; Bool
$c&lt;= :: SimpleDate -&gt; SimpleDate -&gt; Bool
&lt; :: SimpleDate -&gt; SimpleDate -&gt; Bool
$c&lt; :: SimpleDate -&gt; SimpleDate -&gt; Bool
compare :: SimpleDate -&gt; SimpleDate -&gt; Ordering
$ccompare :: SimpleDate -&gt; SimpleDate -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep SimpleDate x -&gt; SimpleDate
forall x. SimpleDate -&gt; Rep SimpleDate x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SimpleDate x -&gt; SimpleDate
$cfrom :: forall x. SimpleDate -&gt; Rep SimpleDate x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490840"><span id="local-6989586621679490843"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679490837"><span class="annot"><span class="annottext">show :: SimpleDate -&gt; String
</span><a href="#local-6989586621679490837"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span><span> </span><span id="local-6989586621679490836"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679490836"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><span class="hs-identifier hs-var">formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y-%-m-%-d&quot;</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679490836"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span id="local-6989586621679492992"><span class="annot"><a href="Poseidon.SequencingSource.html#makeSimpleDate"><span class="hs-identifier hs-type">makeSimpleDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679492992"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679492992"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span></span><span>
</span><span id="line-202"></span><span id="makeSimpleDate"><span class="annot"><span class="annottext">makeSimpleDate :: forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SimpleDate
</span><a href="Poseidon.SequencingSource.html#makeSimpleDate"><span class="hs-identifier hs-var hs-var">makeSimpleDate</span></a></span></span><span> </span><span id="local-6989586621679490826"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490826"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679490825"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679490825"><span class="hs-identifier hs-var">mday</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) t.
(MonadFail m, ParseTime t) =&gt;
Bool -&gt; TimeLocale -&gt; String -&gt; String -&gt; m t
</span><span class="hs-identifier hs-var">parseTimeM</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y-%-m-%-d&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490826"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; SimpleDate
</span><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-var">SimpleDate</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679490825"><span class="hs-identifier hs-var">mday</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679490819"><span class="annot"><span class="annottext">toField :: SimpleDate -&gt; ByteString
</span><a href="#local-6989586621679490819"><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span><span> </span><span id="local-6989586621679490818"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679490818"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.toField</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679490818"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-208"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621679490812"><span class="annot"><span class="annottext">parseField :: ByteString -&gt; Parser SimpleDate
</span><a href="#local-6989586621679490812"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseField</span></a></span></span><span> </span><span id="local-6989586621679490811"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490811"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromField a =&gt; ByteString -&gt; Parser a
</span><span class="hs-identifier hs-var">Csv.parseField</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490811"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SimpleDate
</span><a href="Poseidon.SequencingSource.html#makeSimpleDate"><span class="hs-identifier hs-var">makeSimpleDate</span></a></span><span>
</span><span id="line-210"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490804"><span id="local-6989586621679490806"><span id="local-6989586621679490809"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679490802"><span class="annot"><span class="annottext">toEncoding :: SimpleDate -&gt; Encoding
</span><a href="#local-6989586621679490802"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span id="local-6989586621679490801"><span class="annot"><span class="annottext">SimpleDate
</span><a href="#local-6989586621679490801"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Text -&gt; Encoding' a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SimpleDate
</span><a href="#local-6989586621679490801"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490798"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679490796"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser SimpleDate
</span><a href="#local-6989586621679490796"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SimpleDate&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m SimpleDate
</span><a href="Poseidon.SequencingSource.html#makeSimpleDate"><span class="hs-identifier hs-var">makeSimpleDate</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | A datatype to represent MD5 hashes</span><span>
</span><span id="line-216"></span><span id="local-6989586621679490794"><span id="local-6989586621679490795"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="MD5"><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-var">MD5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MD5"><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-var">MD5</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679490786"><span id="local-6989586621679490791"><span class="annot"><span class="annottext">MD5 -&gt; MD5 -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MD5 -&gt; MD5 -&gt; Bool
$c/= :: MD5 -&gt; MD5 -&gt; Bool
== :: MD5 -&gt; MD5 -&gt; Bool
$c== :: MD5 -&gt; MD5 -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679490747"><span id="local-6989586621679490752"><span id="local-6989586621679490757"><span id="local-6989586621679490762"><span id="local-6989586621679490767"><span id="local-6989586621679490772"><span id="local-6989586621679490778"><span class="annot"><span class="annottext">Eq MD5
MD5 -&gt; MD5 -&gt; Bool
MD5 -&gt; MD5 -&gt; Ordering
MD5 -&gt; MD5 -&gt; MD5
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: MD5 -&gt; MD5 -&gt; MD5
$cmin :: MD5 -&gt; MD5 -&gt; MD5
max :: MD5 -&gt; MD5 -&gt; MD5
$cmax :: MD5 -&gt; MD5 -&gt; MD5
&gt;= :: MD5 -&gt; MD5 -&gt; Bool
$c&gt;= :: MD5 -&gt; MD5 -&gt; Bool
&gt; :: MD5 -&gt; MD5 -&gt; Bool
$c&gt; :: MD5 -&gt; MD5 -&gt; Bool
&lt;= :: MD5 -&gt; MD5 -&gt; Bool
$c&lt;= :: MD5 -&gt; MD5 -&gt; Bool
&lt; :: MD5 -&gt; MD5 -&gt; Bool
$c&lt; :: MD5 -&gt; MD5 -&gt; Bool
compare :: MD5 -&gt; MD5 -&gt; Ordering
$ccompare :: MD5 -&gt; MD5 -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep MD5 x -&gt; MD5
forall x. MD5 -&gt; Rep MD5 x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep MD5 x -&gt; MD5
$cfrom :: forall x. MD5 -&gt; Rep MD5 x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490735"><span id="local-6989586621679490738"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679490734"><span class="annot"><span class="annottext">show :: MD5 -&gt; String
</span><a href="#local-6989586621679490734"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span> </span><span id="local-6989586621679490733"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490733"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490733"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span id="local-6989586621679492986"><span class="annot"><a href="Poseidon.SequencingSource.html#makeMD5"><span class="hs-identifier hs-type">makeMD5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679492986"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679492986"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span></span><span>
</span><span id="line-223"></span><span id="makeMD5"><span class="annot"><span class="annottext">makeMD5 :: forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m MD5
</span><a href="Poseidon.SequencingSource.html#makeMD5"><span class="hs-identifier hs-var hs-var">makeMD5</span></a></span></span><span> </span><span id="local-6989586621679490722"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490722"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#isMD5Hash"><span class="hs-identifier hs-var">isMD5Hash</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490722"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; MD5
</span><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-var">MD5</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490722"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MD5 hash &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490722"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not well structured&quot;</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Poseidon.SequencingSource.html#isMD5Hash"><span class="hs-identifier hs-type">isMD5Hash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-228"></span><span id="isMD5Hash"><span class="annot"><span class="annottext">isMD5Hash :: String -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#isMD5Hash"><span class="hs-identifier hs-var hs-var">isMD5Hash</span></a></span></span><span> </span><span id="local-6989586621679490720"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490720"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490720"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isHexDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490720"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679490712"><span class="annot"><span class="annottext">toField :: MD5 -&gt; ByteString
</span><a href="#local-6989586621679490712"><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></a></span></span><span> </span><span id="local-6989586621679490711"><span class="annot"><span class="annottext">MD5
</span><a href="#local-6989586621679490711"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.toField</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">MD5
</span><a href="#local-6989586621679490711"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-232"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromField</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621679490705"><span class="annot"><span class="annottext">parseField :: ByteString -&gt; Parser MD5
</span><a href="#local-6989586621679490705"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseField</span></a></span></span><span> </span><span id="local-6989586621679490704"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490704"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromField a =&gt; ByteString -&gt; Parser a
</span><span class="hs-identifier hs-var">Csv.parseField</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490704"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m MD5
</span><a href="Poseidon.SequencingSource.html#makeMD5"><span class="hs-identifier hs-var">makeMD5</span></a></span><span>
</span><span id="line-234"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490697"><span id="local-6989586621679490699"><span id="local-6989586621679490702"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679490695"><span class="annot"><span class="annottext">toEncoding :: MD5 -&gt; Encoding
</span><a href="#local-6989586621679490695"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span id="local-6989586621679490694"><span class="annot"><span class="annottext">MD5
</span><a href="#local-6989586621679490694"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Text -&gt; Encoding' a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">MD5
</span><a href="#local-6989586621679490694"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-236"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490691"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679490689"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser MD5
</span><a href="#local-6989586621679490689"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MD5&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFail m =&gt; String -&gt; m MD5
</span><a href="Poseidon.SequencingSource.html#makeMD5"><span class="hs-identifier hs-var">makeMD5</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | A data type to represent a row in the seqSourceFile</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- See https://github.com/poseidon-framework/poseidon2-schema/blob/master/seqSourceFile_columns.tsv</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- for more details</span><span>
</span><span id="line-242"></span><span id="local-6989586621679490687"><span id="local-6989586621679490688"></span></span><span class="hs-keyword">data</span><span> </span><span id="SeqSourceRow"><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-var">SeqSourceRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SeqSourceRow"><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-var">SeqSourceRow</span></a></span></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sPoseidonID"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe JannoStringList
</span><a href="Poseidon.SequencingSource.html#sPoseidonID"><span class="hs-identifier hs-var hs-var">sPoseidonID</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.Janno.html#JannoStringList"><span class="hs-identifier hs-type">JannoStringList</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sUDG"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFUDG
</span><a href="Poseidon.SequencingSource.html#sUDG"><span class="hs-identifier hs-var hs-var">sUDG</span></a></span></span><span>                      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFUDG"><span class="hs-identifier hs-type">SSFUDG</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibraryBuilt"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#sLibraryBuilt"><span class="hs-identifier hs-var hs-var">sLibraryBuilt</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SSFLibraryBuilt"><span class="hs-identifier hs-type">SSFLibraryBuilt</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSampleAccession"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe AccessionIDSample
</span><a href="Poseidon.SequencingSource.html#sSampleAccession"><span class="hs-identifier hs-var hs-var">sSampleAccession</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDSample"><span class="hs-identifier hs-type">AccessionIDSample</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sStudyAccession"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe AccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#sStudyAccession"><span class="hs-identifier hs-var hs-var">sStudyAccession</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDStudy"><span class="hs-identifier hs-type">AccessionIDStudy</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sRunAccession"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe AccessionIDRun
</span><a href="Poseidon.SequencingSource.html#sRunAccession"><span class="hs-identifier hs-var hs-var">sRunAccession</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#AccessionIDRun"><span class="hs-identifier hs-type">AccessionIDRun</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSampleAlias"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sSampleAlias"><span class="hs-identifier hs-var hs-var">sSampleAlias</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSecondarySampleAccession"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sSecondarySampleAccession"><span class="hs-identifier hs-var hs-var">sSecondarySampleAccession</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFirstPublic"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SimpleDate
</span><a href="Poseidon.SequencingSource.html#sFirstPublic"><span class="hs-identifier hs-var hs-var">sFirstPublic</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLastUpdated"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SimpleDate
</span><a href="Poseidon.SequencingSource.html#sLastUpdated"><span class="hs-identifier hs-var hs-var">sLastUpdated</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SimpleDate"><span class="hs-identifier hs-type">SimpleDate</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sInstrumentModel"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sInstrumentModel"><span class="hs-identifier hs-var hs-var">sInstrumentModel</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibraryLayout"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sLibraryLayout"><span class="hs-identifier hs-var hs-var">sLibraryLayout</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibrarySource"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sLibrarySource"><span class="hs-identifier hs-var hs-var">sLibrarySource</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sInstrumentPlatform"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sInstrumentPlatform"><span class="hs-identifier hs-var hs-var">sInstrumentPlatform</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibraryName"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sLibraryName"><span class="hs-identifier hs-var hs-var">sLibraryName</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sLibraryStrategy"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sLibraryStrategy"><span class="hs-identifier hs-var hs-var">sLibraryStrategy</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFastqFTP"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList JURI)
</span><a href="Poseidon.SequencingSource.html#sFastqFTP"><span class="hs-identifier hs-var hs-var">sFastqFTP</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#JannoList"><span class="hs-identifier hs-type">JannoList</span></a></span><span> </span><span class="annot"><a href="Poseidon.Janno.html#JURI"><span class="hs-identifier hs-type">JURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFastqASPERA"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList JURI)
</span><a href="Poseidon.SequencingSource.html#sFastqASPERA"><span class="hs-identifier hs-var hs-var">sFastqASPERA</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#JannoList"><span class="hs-identifier hs-type">JannoList</span></a></span><span> </span><span class="annot"><a href="Poseidon.Janno.html#JURI"><span class="hs-identifier hs-type">JURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFastqBytes"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList Integer)
</span><a href="Poseidon.SequencingSource.html#sFastqBytes"><span class="hs-identifier hs-var hs-var">sFastqBytes</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#JannoList"><span class="hs-identifier hs-type">JannoList</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- integer, not int, because it can be a very large number</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sFastqMD5"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList MD5)
</span><a href="Poseidon.SequencingSource.html#sFastqMD5"><span class="hs-identifier hs-var hs-var">sFastqMD5</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#JannoList"><span class="hs-identifier hs-type">JannoList</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sReadCount"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe Integer
</span><a href="Poseidon.SequencingSource.html#sReadCount"><span class="hs-identifier hs-var hs-var">sReadCount</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>             </span><span class="hs-comment">-- integer, not int, because it can be a very large number</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sSubmittedFTP"><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList JURI)
</span><a href="Poseidon.SequencingSource.html#sSubmittedFTP"><span class="hs-identifier hs-var hs-var">sSubmittedFTP</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.Janno.html#JannoList"><span class="hs-identifier hs-type">JannoList</span></a></span><span> </span><span class="annot"><a href="Poseidon.Janno.html#JURI"><span class="hs-identifier hs-type">JURI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="sAdditionalColumns"><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var hs-var">sAdditionalColumns</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Janno.html#CsvNamedRecord"><span class="hs-identifier hs-type">CsvNamedRecord</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679490620"><span id="local-6989586621679490622"><span id="local-6989586621679490662"><span class="annot"><span class="annottext">Int -&gt; SeqSourceRow -&gt; ShowS
[SeqSourceRow] -&gt; ShowS
SeqSourceRow -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SeqSourceRow] -&gt; ShowS
$cshowList :: [SeqSourceRow] -&gt; ShowS
show :: SeqSourceRow -&gt; String
$cshow :: SeqSourceRow -&gt; String
showsPrec :: Int -&gt; SeqSourceRow -&gt; ShowS
$cshowsPrec :: Int -&gt; SeqSourceRow -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679490574"><span id="local-6989586621679490612"><span class="annot"><span class="annottext">SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
$c/= :: SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
== :: SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
$c== :: SeqSourceRow -&gt; SeqSourceRow -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep SeqSourceRow x -&gt; SeqSourceRow
forall x. SeqSourceRow -&gt; Rep SeqSourceRow x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SeqSourceRow x -&gt; SeqSourceRow
$cfrom :: forall x. SeqSourceRow -&gt; Rep SeqSourceRow x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- This header also defines the output column order when writing to csv!</span><span>
</span><span id="line-270"></span><span class="annot"><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-type">seqSourceHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bchs.ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-271"></span><span id="seqSourceHeader"><span class="annot"><span class="annottext">seqSourceHeader :: [ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var hs-var">seqSourceHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;poseidon_IDs&quot;</span></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;udg&quot;</span></span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_built&quot;</span></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_accession&quot;</span></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;study_accession&quot;</span></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;run_accession&quot;</span></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_alias&quot;</span></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;secondary_sample_accession&quot;</span></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;first_public&quot;</span></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;last_updated&quot;</span></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_model&quot;</span></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_layout&quot;</span></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_source&quot;</span></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_platform&quot;</span></span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_name&quot;</span></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_strategy&quot;</span></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_ftp&quot;</span></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_aspera&quot;</span></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_bytes&quot;</span></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_md5&quot;</span></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;read_count&quot;</span></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;submitted_ftp&quot;</span></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.DefaultOrdered</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679490561"><span class="annot"><span class="annottext">headerOrder :: SeqSourceRow -&gt; Header
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">headerOrder</span></span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Header
</span><span class="hs-identifier hs-var">Csv.header</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var">seqSourceHeader</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="annot"><a href="Poseidon.SequencingSource.html#seqSourceHeaderString"><span class="hs-identifier hs-type">seqSourceHeaderString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span id="seqSourceHeaderString"><span class="annot"><span class="annottext">seqSourceHeaderString :: [String]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeaderString"><span class="hs-identifier hs-var hs-var">seqSourceHeaderString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">Bchs.unpack</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var">seqSourceHeader</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- This hashmap represents an empty seqSourceFile with all normal, specified columns</span><span>
</span><span id="line-303"></span><span class="annot"><a href="Poseidon.SequencingSource.html#seqSourceRefHashMap"><span class="hs-identifier hs-type">seqSourceRefHashMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HM.HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bchs.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span id="seqSourceRefHashMap"><span class="annot"><span class="annottext">seqSourceRefHashMap :: HashMap ByteString ()
</span><a href="Poseidon.SequencingSource.html#seqSourceRefHashMap"><span class="hs-identifier hs-var hs-var">seqSourceRefHashMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679490555"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490555"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490555"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var">seqSourceHeader</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490548"><span id="local-6989586621679490550"><span id="local-6989586621679490553"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679490208"><span class="annot"><span class="annottext">toEncoding :: SeqSourceRow -&gt; Encoding
</span><a href="#local-6989586621679490208"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(Generic a, GToJSON' Encoding Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">genericToEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options
</span><span class="hs-identifier hs-var">defaultOptions</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">omitNothingFields :: Bool
</span><a href="#local-6989586621679490207"><span class="hs-identifier hs-var">omitNothingFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679490203"><span id="local-6989586621679490205"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span></span></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.FromNamedRecord</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679490119"><span class="annot"><span class="annottext">parseNamedRecord :: HashMap ByteString ByteString -&gt; Parser SeqSourceRow
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseNamedRecord</span></span></span><span> </span><span id="local-6989586621679490117"><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe JannoStringList
-&gt; Maybe SSFUDG
-&gt; Maybe SSFLibraryBuilt
-&gt; Maybe AccessionIDSample
-&gt; Maybe AccessionIDStudy
-&gt; Maybe AccessionIDRun
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe SimpleDate
-&gt; Maybe SimpleDate
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe (JannoList JURI)
-&gt; Maybe (JannoList JURI)
-&gt; Maybe (JannoList Integer)
-&gt; Maybe (JannoList MD5)
-&gt; Maybe Integer
-&gt; Maybe (JannoList JURI)
-&gt; CsvNamedRecord
-&gt; SeqSourceRow
</span><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-var">SeqSourceRow</span></a></span><span>
</span><span id="line-313"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;poseidon_IDs&quot;</span></span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;udg&quot;</span></span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_built&quot;</span></span><span>
</span><span id="line-316"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_accession&quot;</span></span><span>
</span><span id="line-317"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;study_accession&quot;</span></span><span>
</span><span id="line-318"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser a
</span><a href="Poseidon.Janno.html#filterLookup"><span class="hs-identifier hs-var">filterLookup</span></a></span><span>         </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;run_accession&quot;</span></span><span>
</span><span id="line-319"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_alias&quot;</span></span><span>
</span><span id="line-320"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;secondary_sample_accession&quot;</span></span><span>
</span><span id="line-321"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;first_public&quot;</span></span><span>
</span><span id="line-322"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;last_updated&quot;</span></span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_model&quot;</span></span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_layout&quot;</span></span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_source&quot;</span></span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_platform&quot;</span></span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_name&quot;</span></span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_strategy&quot;</span></span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_ftp&quot;</span></span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_aspera&quot;</span></span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_bytes&quot;</span></span><span>
</span><span id="line-332"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_md5&quot;</span></span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;read_count&quot;</span></span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
FromField a =&gt;
HashMap ByteString ByteString -&gt; ByteString -&gt; Parser (Maybe a)
</span><a href="Poseidon.Janno.html#filterLookupOptional"><span class="hs-identifier hs-var">filterLookupOptional</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;submitted_ftp&quot;</span></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-comment">-- beyond that read everything that is not in the set of defined variables</span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-comment">-- as a separate hashmap</span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString -&gt; CsvNamedRecord
</span><a href="Poseidon.Janno.html#CsvNamedRecord"><span class="hs-identifier hs-var">CsvNamedRecord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ByteString ByteString
</span><a href="#local-6989586621679490117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall k v w.
(Eq k, Hashable k) =&gt;
HashMap k v -&gt; HashMap k w -&gt; HashMap k v
</span><span class="hs-operator hs-var">`HM.difference`</span></span><span> </span><span class="annot"><span class="annottext">HashMap ByteString ()
</span><a href="Poseidon.SequencingSource.html#seqSourceRefHashMap"><span class="hs-identifier hs-var">seqSourceRefHashMap</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.ToNamedRecord</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679490043"><span class="annot"><span class="annottext">toNamedRecord :: SeqSourceRow -&gt; HashMap ByteString ByteString
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toNamedRecord</span></span></span><span> </span><span id="local-6989586621679490041"><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; HashMap ByteString ByteString
</span><span class="hs-identifier hs-var">Csv.namedRecord</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-341"></span><span>          </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;poseidon_IDs&quot;</span></span><span>               </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe JannoStringList
</span><a href="Poseidon.SequencingSource.html#sPoseidonID"><span class="hs-identifier hs-var">sPoseidonID</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;udg&quot;</span></span><span>                        </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFUDG
</span><a href="Poseidon.SequencingSource.html#sUDG"><span class="hs-identifier hs-var">sUDG</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_built&quot;</span></span><span>              </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SSFLibraryBuilt
</span><a href="Poseidon.SequencingSource.html#sLibraryBuilt"><span class="hs-identifier hs-var">sLibraryBuilt</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_accession&quot;</span></span><span>           </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe AccessionIDSample
</span><a href="Poseidon.SequencingSource.html#sSampleAccession"><span class="hs-identifier hs-var">sSampleAccession</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;study_accession&quot;</span></span><span>            </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe AccessionIDStudy
</span><a href="Poseidon.SequencingSource.html#sStudyAccession"><span class="hs-identifier hs-var">sStudyAccession</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;run_accession&quot;</span></span><span>              </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe AccessionIDRun
</span><a href="Poseidon.SequencingSource.html#sRunAccession"><span class="hs-identifier hs-var">sRunAccession</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;sample_alias&quot;</span></span><span>               </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sSampleAlias"><span class="hs-identifier hs-var">sSampleAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;secondary_sample_accession&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sSecondarySampleAccession"><span class="hs-identifier hs-var">sSecondarySampleAccession</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;first_public&quot;</span></span><span>               </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SimpleDate
</span><a href="Poseidon.SequencingSource.html#sFirstPublic"><span class="hs-identifier hs-var">sFirstPublic</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;last_updated&quot;</span></span><span>               </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe SimpleDate
</span><a href="Poseidon.SequencingSource.html#sLastUpdated"><span class="hs-identifier hs-var">sLastUpdated</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_model&quot;</span></span><span>           </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sInstrumentModel"><span class="hs-identifier hs-var">sInstrumentModel</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_layout&quot;</span></span><span>             </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sLibraryLayout"><span class="hs-identifier hs-var">sLibraryLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-353"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_source&quot;</span></span><span>             </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sLibrarySource"><span class="hs-identifier hs-var">sLibrarySource</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;instrument_platform&quot;</span></span><span>        </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sInstrumentPlatform"><span class="hs-identifier hs-var">sInstrumentPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-355"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_name&quot;</span></span><span>               </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sLibraryName"><span class="hs-identifier hs-var">sLibraryName</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;library_strategy&quot;</span></span><span>           </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe String
</span><a href="Poseidon.SequencingSource.html#sLibraryStrategy"><span class="hs-identifier hs-var">sLibraryStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_ftp&quot;</span></span><span>                  </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList JURI)
</span><a href="Poseidon.SequencingSource.html#sFastqFTP"><span class="hs-identifier hs-var">sFastqFTP</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_aspera&quot;</span></span><span>               </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList JURI)
</span><a href="Poseidon.SequencingSource.html#sFastqASPERA"><span class="hs-identifier hs-var">sFastqASPERA</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_bytes&quot;</span></span><span>                </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList Integer)
</span><a href="Poseidon.SequencingSource.html#sFastqBytes"><span class="hs-identifier hs-var">sFastqBytes</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fastq_md5&quot;</span></span><span>                  </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList MD5)
</span><a href="Poseidon.SequencingSource.html#sFastqMD5"><span class="hs-identifier hs-var">sFastqMD5</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;read_count&quot;</span></span><span>                 </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe Integer
</span><a href="Poseidon.SequencingSource.html#sReadCount"><span class="hs-identifier hs-var">sReadCount</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-362"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;submitted_ftp&quot;</span></span><span>              </span><span class="annot"><span class="annottext">forall a. ToField a =&gt; ByteString -&gt; a -&gt; (ByteString, ByteString)
</span><span class="hs-operator hs-var">Csv..=</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe (JannoList JURI)
</span><a href="Poseidon.SequencingSource.html#sSubmittedFTP"><span class="hs-identifier hs-var">sSubmittedFTP</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-comment">-- beyond that add what is in the hashmap of additional columns</span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall k v.
(Eq k, Hashable k) =&gt;
HashMap k v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-operator hs-var">`HM.union`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CsvNamedRecord -&gt; HashMap ByteString ByteString
</span><a href="Poseidon.Janno.html#getCsvNR"><span class="hs-identifier hs-var">getCsvNR</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679490041"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | A function to write one seqSourceFile</span><span>
</span><span id="line-367"></span><span class="annot"><a href="Poseidon.SequencingSource.html#writeSeqSourceFile"><span class="hs-identifier hs-type">writeSeqSourceFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span id="writeSeqSourceFile"><span class="annot"><span class="annottext">writeSeqSourceFile :: String -&gt; SeqSourceRows -&gt; IO ()
</span><a href="Poseidon.SequencingSource.html#writeSeqSourceFile"><span class="hs-identifier hs-var hs-var">writeSeqSourceFile</span></a></span></span><span> </span><span id="local-6989586621679490036"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490036"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679490035"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679490035"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679490033"><span class="annot"><span class="annottext">seqSourceAsBytestring :: ByteString
</span><a href="#local-6989586621679490033"><span class="hs-identifier hs-var hs-var">seqSourceAsBytestring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
ToNamedRecord a =&gt;
EncodeOptions -&gt; Header -&gt; [a] -&gt; ByteString
</span><span class="hs-identifier hs-var">Csv.encodeByNameWith</span></span><span> </span><span class="annot"><span class="annottext">EncodeOptions
</span><a href="Poseidon.Janno.html#encodingOptions"><span class="hs-identifier hs-var">encodingOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Header
</span><a href="#local-6989586621679490031"><span class="hs-identifier hs-var">makeHeaderWithAdditionalColumns</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679490035"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679490030"><span class="annot"><span class="annottext">seqSourceAsBytestringwithNA :: ByteString
</span><a href="#local-6989586621679490030"><span class="hs-identifier hs-var hs-var">seqSourceAsBytestringwithNA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Poseidon.Janno.html#explicitNA"><span class="hs-identifier hs-var">explicitNA</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490033"><span class="hs-identifier hs-var">seqSourceAsBytestring</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">Bch.writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490036"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490030"><span class="hs-identifier hs-var">seqSourceAsBytestringwithNA</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><a href="#local-6989586621679490031"><span class="hs-identifier hs-type">makeHeaderWithAdditionalColumns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Csv.Header</span></span><span>
</span><span id="line-374"></span><span>        </span><span id="local-6989586621679490031"><span class="annot"><span class="annottext">makeHeaderWithAdditionalColumns :: Header
</span><a href="#local-6989586621679490031"><span class="hs-identifier hs-var hs-var">makeHeaderWithAdditionalColumns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>            </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="Poseidon.SequencingSource.html#seqSourceHeader"><span class="hs-identifier hs-var">seqSourceHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v. HashMap k v -&gt; [k]
</span><span class="hs-identifier hs-var">HM.keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; [HashMap k v] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.unions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CsvNamedRecord -&gt; HashMap ByteString ByteString
</span><a href="Poseidon.Janno.html#getCsvNR"><span class="hs-identifier hs-var">getCsvNR</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; CsvNamedRecord
</span><a href="Poseidon.SequencingSource.html#sAdditionalColumns"><span class="hs-identifier hs-var">sAdditionalColumns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679490035"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- | A function to read one seqSourceFile</span><span>
</span><span id="line-378"></span><span class="annot"><a href="Poseidon.SequencingSource.html#readSeqSourceFile"><span class="hs-identifier hs-type">readSeqSourceFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span>
</span><span id="line-379"></span><span id="readSeqSourceFile"><span class="annot"><span class="annottext">readSeqSourceFile :: String -&gt; PoseidonIO SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#readSeqSourceFile"><span class="hs-identifier hs-var hs-var">readSeqSourceFile</span></a></span></span><span> </span><span id="local-6989586621679490026"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490026"><span class="hs-identifier hs-var">seqSourcePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Reading: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490026"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679490025"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490025"><span class="hs-identifier hs-var">seqSourceFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><span class="hs-identifier hs-var">Bch.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490026"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679490023"><span class="annot"><span class="annottext">seqSourceFileRows :: [ByteString]
</span><a href="#local-6989586621679490023"><span class="hs-identifier hs-var hs-var">seqSourceFileRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">Bch.lines</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490025"><span class="hs-identifier hs-var">seqSourceFile</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679490023"><span class="hs-identifier hs-var">seqSourceFileRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileConsistencyException"><span class="hs-identifier hs-var">PoseidonFileConsistencyException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490026"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;File has less than two lines&quot;</span></span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679490023"><span class="hs-identifier hs-var">seqSourceFileRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; sequencing entities in this file&quot;</span></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-comment">-- tupel with row number and row bytestring</span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679490016"><span class="annot"><span class="annottext">seqSourceFileRowsWithNumber :: [(Int, ByteString)]
</span><a href="#local-6989586621679490016"><span class="hs-identifier hs-var hs-var">seqSourceFileRowsWithNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679490023"><span class="hs-identifier hs-var">seqSourceFileRows</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679490023"><span class="hs-identifier hs-var">seqSourceFileRows</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-comment">-- filter out empty lines</span><span>
</span><span id="line-388"></span><span>        </span><span id="local-6989586621679490013"><span class="annot"><span class="annottext">seqSourceFileRowsWithNumberFiltered :: [(Int, ByteString)]
</span><a href="#local-6989586621679490013"><span class="hs-identifier hs-var hs-var">seqSourceFileRowsWithNumberFiltered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679490012"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490012"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490012"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">Bch.empty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679490016"><span class="hs-identifier hs-var">seqSourceFileRowsWithNumber</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-comment">-- create header + individual line combination</span><span>
</span><span id="line-390"></span><span>        </span><span id="local-6989586621679490009"><span class="annot"><span class="annottext">headerOnlyPotentiallyWithQuotes :: ByteString
</span><a href="#local-6989586621679490009"><span class="hs-identifier hs-var hs-var">headerOnlyPotentiallyWithQuotes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679490013"><span class="hs-identifier hs-var">seqSourceFileRowsWithNumberFiltered</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="hs-comment">-- removing the quotes like this might cause issues in edge cases</span><span>
</span><span id="line-392"></span><span>        </span><span id="local-6989586621679490006"><span class="annot"><span class="annottext">headerOnly :: ByteString
</span><a href="#local-6989586621679490006"><span class="hs-identifier hs-var hs-var">headerOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Bch.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490009"><span class="hs-identifier hs-var">headerOnlyPotentiallyWithQuotes</span></a></span><span>
</span><span id="line-393"></span><span>        </span><span id="local-6989586621679490004"><span class="annot"><span class="annottext">rowsOnly :: [(Int, ByteString)]
</span><a href="#local-6989586621679490004"><span class="hs-identifier hs-var hs-var">rowsOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679490013"><span class="hs-identifier hs-var">seqSourceFileRowsWithNumberFiltered</span></a></span><span>
</span><span id="line-394"></span><span>        </span><span id="local-6989586621679489995"><span class="annot"><span class="annottext">seqSourceFileRowsWithHeader :: [(Int, ByteString)]
</span><a href="#local-6989586621679489995"><span class="hs-identifier hs-var hs-var">seqSourceFileRowsWithHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679489994"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679489994"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679490006"><span class="hs-identifier hs-var">headerOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679489994"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679490004"><span class="hs-identifier hs-var">rowsOnly</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-comment">-- read seqSourceFile by rows</span><span>
</span><span id="line-396"></span><span>    </span><span id="local-6989586621679489993"><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow]
</span><a href="#local-6989586621679489993"><span class="hs-identifier hs-var">seqSourceRepresentation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; (Int, ByteString)
-&gt; PoseidonIO (Either PoseidonException SeqSourceRow)
</span><a href="Poseidon.SequencingSource.html#readSeqSourceFileRow"><span class="hs-identifier hs-var">readSeqSourceFileRow</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490026"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, ByteString)]
</span><a href="#local-6989586621679489995"><span class="hs-identifier hs-var">seqSourceFileRowsWithHeader</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-comment">-- error case management</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow]
</span><a href="#local-6989586621679489993"><span class="hs-identifier hs-var">seqSourceRepresentation</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logError"><span class="hs-identifier hs-var">logError</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException -&gt; String
</span><a href="Poseidon.Utils.html#renderPoseidonException"><span class="hs-identifier hs-var">renderPoseidonException</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow]
</span><a href="#local-6989586621679489993"><span class="hs-identifier hs-var">seqSourceRepresentation</span></a></span><span>
</span><span id="line-401"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileConsistencyException"><span class="hs-identifier hs-var">PoseidonFileConsistencyException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490026"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Broken lines.&quot;</span></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-403"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679489986"><span class="annot"><span class="annottext">consistentSeqSource :: Either PoseidonException SeqSourceRows
</span><a href="#local-6989586621679489986"><span class="hs-identifier hs-var hs-var">consistentSeqSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SeqSourceRows -&gt; Either PoseidonException SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#checkSeqSourceConsistency"><span class="hs-identifier hs-var">checkSeqSourceConsistency</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490026"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow] -&gt; SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-var">SeqSourceRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [b]
</span><span class="hs-identifier hs-var">rights</span></span><span> </span><span class="annot"><span class="annottext">[Either PoseidonException SeqSourceRow]
</span><a href="#local-6989586621679489993"><span class="hs-identifier hs-var">seqSourceRepresentation</span></a></span><span>
</span><span id="line-404"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either PoseidonException SeqSourceRows
</span><a href="#local-6989586621679489986"><span class="hs-identifier hs-var">consistentSeqSource</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-405"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679489984"><span class="annot"><span class="annottext">PoseidonException
</span><a href="#local-6989586621679489984"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PoseidonException
</span><a href="#local-6989586621679489984"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679489983"><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679489983"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>                </span><span class="hs-comment">-- warnings</span><span>
</span><span id="line-408"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; SeqSourceRows -&gt; PoseidonIO ()
</span><a href="Poseidon.SequencingSource.html#warnSeqSourceConsistency"><span class="hs-identifier hs-var">warnSeqSourceConsistency</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679490026"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679489983"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-409"></span><span>                </span><span class="hs-comment">-- finally return the good ones</span><span>
</span><span id="line-410"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679489983"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- | A function to read one row of a seqSourceFile</span><span>
</span><span id="line-413"></span><span class="annot"><a href="Poseidon.SequencingSource.html#readSeqSourceFileRow"><span class="hs-identifier hs-type">readSeqSourceFileRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bch.ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span id="readSeqSourceFileRow"><span class="annot"><span class="annottext">readSeqSourceFileRow :: String
-&gt; (Int, ByteString)
-&gt; PoseidonIO (Either PoseidonException SeqSourceRow)
</span><a href="Poseidon.SequencingSource.html#readSeqSourceFileRow"><span class="hs-identifier hs-var hs-var">readSeqSourceFileRow</span></a></span></span><span> </span><span id="local-6989586621679489981"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679489981"><span class="hs-identifier hs-var">seqSourcePath</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679489980"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679489980"><span class="hs-identifier hs-var">lineNumber</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679489979"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679489979"><span class="hs-identifier hs-var">row</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a.
FromNamedRecord a =&gt;
DecodeOptions -&gt; ByteString -&gt; Either String (Header, Vector a)
</span><span class="hs-identifier hs-var">Csv.decodeByNameWith</span></span><span> </span><span class="annot"><span class="annottext">DecodeOptions
</span><a href="Poseidon.Janno.html#decodingOptions"><span class="hs-identifier hs-var">decodingOptions</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679489979"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-416"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679489977"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679489977"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String -&gt; PoseidonException
</span><a href="Poseidon.Utils.html#PoseidonFileRowException"><span class="hs-identifier hs-var">PoseidonFileRowException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679489981"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679489980"><span class="hs-identifier hs-var">lineNumber</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Poseidon.Janno.html#removeUselessSuffix"><span class="hs-identifier hs-var">removeUselessSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679489977"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Header
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679489975"><span class="annot"><span class="annottext">Vector SeqSourceRow
</span><a href="#local-6989586621679489975"><span class="hs-identifier hs-var">seqSourceRow</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Int -&gt; SeqSourceRow -&gt; Either PoseidonException SeqSourceRow
</span><a href="Poseidon.SequencingSource.html#checkSeqSourceRowConsistency"><span class="hs-identifier hs-var">checkSeqSourceRowConsistency</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679489981"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679489980"><span class="hs-identifier hs-var">lineNumber</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span> </span><span class="annot"><span class="annottext">Vector SeqSourceRow
</span><a href="#local-6989586621679489975"><span class="hs-identifier hs-var">seqSourceRow</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-420"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679489972"><span class="annot"><span class="annottext">PoseidonException
</span><a href="#local-6989586621679489972"><span class="hs-identifier hs-var">e</span></a></span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">PoseidonException
</span><a href="#local-6989586621679489972"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-421"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679489971"><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679489971"><span class="hs-identifier hs-var">pS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679489971"><span class="hs-identifier hs-var">pS</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- SeqSource consistency checks</span><span>
</span><span id="line-424"></span><span class="annot"><a href="Poseidon.SequencingSource.html#checkSeqSourceConsistency"><span class="hs-identifier hs-type">checkSeqSourceConsistency</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span>
</span><span id="line-425"></span><span id="checkSeqSourceConsistency"><span class="annot"><span class="annottext">checkSeqSourceConsistency :: String -&gt; SeqSourceRows -&gt; Either PoseidonException SeqSourceRows
</span><a href="Poseidon.SequencingSource.html#checkSeqSourceConsistency"><span class="hs-identifier hs-var hs-var">checkSeqSourceConsistency</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679489970"><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679489970"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-comment">-- | ... no tests implemented</span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679489970"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="annot"><a href="Poseidon.SequencingSource.html#checkSeqSourceRowConsistency"><span class="hs-identifier hs-type">checkSeqSourceRowConsistency</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonException"><span class="hs-identifier hs-type">PoseidonException</span></a></span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRow"><span class="hs-identifier hs-type">SeqSourceRow</span></a></span><span>
</span><span id="line-430"></span><span id="checkSeqSourceRowConsistency"><span class="annot"><span class="annottext">checkSeqSourceRowConsistency :: String
-&gt; Int -&gt; SeqSourceRow -&gt; Either PoseidonException SeqSourceRow
</span><a href="Poseidon.SequencingSource.html#checkSeqSourceRowConsistency"><span class="hs-identifier hs-var hs-var">checkSeqSourceRowConsistency</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679489969"><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679489969"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-comment">-- | ... no tests implemented</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow
</span><a href="#local-6989586621679489969"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="annot"><a href="Poseidon.SequencingSource.html#warnSeqSourceConsistency"><span class="hs-identifier hs-type">warnSeqSourceConsistency</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Poseidon.Utils.html#PoseidonIO"><span class="hs-identifier hs-type">PoseidonIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span id="warnSeqSourceConsistency"><span class="annot"><span class="annottext">warnSeqSourceConsistency :: String -&gt; SeqSourceRows -&gt; PoseidonIO ()
</span><a href="Poseidon.SequencingSource.html#warnSeqSourceConsistency"><span class="hs-identifier hs-var hs-var">warnSeqSourceConsistency</span></a></span></span><span> </span><span id="local-6989586621679489968"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679489968"><span class="hs-identifier hs-var">seqSourcePath</span></a></span></span><span> </span><span id="local-6989586621679489967"><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679489967"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-436"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SeqSourceRows -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#checkRunsUnique"><span class="hs-identifier hs-var">checkRunsUnique</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679489967"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-437"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier hs-var">logWarning</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Potential consistency issues in file &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679489968"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-438"></span><span>                     </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The values in the run_accession column are not unique&quot;</span></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SeqSourceRows -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#checkAtLeastOnePoseidonID"><span class="hs-identifier hs-var">checkAtLeastOnePoseidonID</span></a></span><span> </span><span class="annot"><span class="annottext">SeqSourceRows
</span><a href="#local-6989586621679489967"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-440"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; PoseidonIO ()
</span><a href="Poseidon.Utils.html#logWarning"><span class="hs-identifier hs-var">logWarning</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Potential consistency issues in file &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679489968"><span class="hs-identifier hs-var">seqSourcePath</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-441"></span><span>                     </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The poseidon_IDs column is completely empty. Package and .ssf file are not linked&quot;</span></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Poseidon.SequencingSource.html#checkRunsUnique"><span class="hs-identifier hs-type">checkRunsUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-444"></span><span id="checkRunsUnique"><span class="annot"><span class="annottext">checkRunsUnique :: SeqSourceRows -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#checkRunsUnique"><span class="hs-identifier hs-var hs-var">checkRunsUnique</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679489964"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679489964"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679489963"><span class="annot"><span class="annottext">justRunAccessions :: [AccessionIDRun]
</span><a href="#local-6989586621679489963"><span class="hs-identifier hs-var hs-var">justRunAccessions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe AccessionIDRun
</span><a href="Poseidon.SequencingSource.html#sRunAccession"><span class="hs-identifier hs-var">sRunAccession</span></a></span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679489964"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[AccessionIDRun]
</span><a href="#local-6989586621679489963"><span class="hs-identifier hs-var">justRunAccessions</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">[AccessionIDRun]
</span><a href="#local-6989586621679489963"><span class="hs-identifier hs-var">justRunAccessions</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="annot"><a href="Poseidon.SequencingSource.html#checkAtLeastOnePoseidonID"><span class="hs-identifier hs-type">checkAtLeastOnePoseidonID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-449"></span><span id="checkAtLeastOnePoseidonID"><span class="annot"><span class="annottext">checkAtLeastOnePoseidonID :: SeqSourceRows -&gt; Bool
</span><a href="Poseidon.SequencingSource.html#checkAtLeastOnePoseidonID"><span class="hs-identifier hs-var hs-var">checkAtLeastOnePoseidonID</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Poseidon.SequencingSource.html#SeqSourceRows"><span class="hs-identifier hs-type">SeqSourceRows</span></a></span><span> </span><span id="local-6989586621679489962"><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679489962"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SeqSourceRow -&gt; Maybe JannoStringList
</span><a href="Poseidon.SequencingSource.html#sPoseidonID"><span class="hs-identifier hs-var">sPoseidonID</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SeqSourceRow]
</span><a href="#local-6989586621679489962"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-451"></span></pre></body></html>